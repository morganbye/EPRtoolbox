<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of BrukerWrite</title>
  <meta name="keywords" content="BrukerWrite">
  <meta name="description" content="BRUKERWRITE save x and y MATLAB variables out to Bruker BES3T files (.DTA">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">doc</a> &gt; <a href="index.html">misc</a> &gt; BrukerWrite.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for doc/misc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>BrukerWrite
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>BRUKERWRITE save x and y MATLAB variables out to Bruker BES3T files (.DTA</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function BrukerWrite(x,y,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> BRUKERWRITE save x and y MATLAB variables out to Bruker BES3T files (.DTA
 and .DSC)

   This scipt is still quite basic and currently will only work with 2
   dimensional cw experiments.

 BRUKERWRITE (x,y)
 BRUKERWRITE (x,y,'path/to/file.DTA')

 NOT YET IMPLEMENTED - FOR IMAGINARY CHANNELS
 BRUKERWRITE (x,y,y2,title)
 NOT YET IMPLEMENTED - FOR 2 DIMENSIONAL DATA WITH .YGF FILE
 BRUKERWRITE (x,y,z,title)


 Inputs:
    input1     - x axis
                   Magnetic field
    input2     - y axis
                   Intensity
    input3     - 'path/to/file.DTA'
                   The path to save the files


 Outputs:
    output1    - file.DTA
                   Data file
    output2    - file.DSC
                   Parameters file
 Example: 
    BRUKERWRITE(x,y)
               GUI to select file location of x and y
    BRUKERWRITE(x,y,'/home/spectra/MTSL.DTA')
               Saves x and y to the the files MTSL.DTA and MTSL.DSC at
               /home/spectra


 Other m-files required:   none

 Subfunctions:             none

 MAT-files required:       none


 See also: EPRTOOLBOX CWPLOTTER</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function BrukerWrite(x,y,varargin)</a>
0002 
0003 <span class="comment">% BRUKERWRITE save x and y MATLAB variables out to Bruker BES3T files (.DTA</span>
0004 <span class="comment">% and .DSC)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%   This scipt is still quite basic and currently will only work with 2</span>
0007 <span class="comment">%   dimensional cw experiments.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% BRUKERWRITE (x,y)</span>
0010 <span class="comment">% BRUKERWRITE (x,y,'path/to/file.DTA')</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% NOT YET IMPLEMENTED - FOR IMAGINARY CHANNELS</span>
0013 <span class="comment">% BRUKERWRITE (x,y,y2,title)</span>
0014 <span class="comment">% NOT YET IMPLEMENTED - FOR 2 DIMENSIONAL DATA WITH .YGF FILE</span>
0015 <span class="comment">% BRUKERWRITE (x,y,z,title)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% Inputs:</span>
0019 <span class="comment">%    input1     - x axis</span>
0020 <span class="comment">%                   Magnetic field</span>
0021 <span class="comment">%    input2     - y axis</span>
0022 <span class="comment">%                   Intensity</span>
0023 <span class="comment">%    input3     - 'path/to/file.DTA'</span>
0024 <span class="comment">%                   The path to save the files</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% Outputs:</span>
0028 <span class="comment">%    output1    - file.DTA</span>
0029 <span class="comment">%                   Data file</span>
0030 <span class="comment">%    output2    - file.DSC</span>
0031 <span class="comment">%                   Parameters file</span>
0032 <span class="comment">% Example:</span>
0033 <span class="comment">%    BRUKERWRITE(x,y)</span>
0034 <span class="comment">%               GUI to select file location of x and y</span>
0035 <span class="comment">%    BRUKERWRITE(x,y,'/home/spectra/MTSL.DTA')</span>
0036 <span class="comment">%               Saves x and y to the the files MTSL.DTA and MTSL.DSC at</span>
0037 <span class="comment">%               /home/spectra</span>
0038 <span class="comment">%</span>
0039 <span class="comment">%</span>
0040 <span class="comment">% Other m-files required:   none</span>
0041 <span class="comment">%</span>
0042 <span class="comment">% Subfunctions:             none</span>
0043 <span class="comment">%</span>
0044 <span class="comment">% MAT-files required:       none</span>
0045 <span class="comment">%</span>
0046 <span class="comment">%</span>
0047 <span class="comment">% See also: EPRTOOLBOX CWPLOTTER</span>
0048 
0049 
0050 <span class="comment">%                                        _                             _</span>
0051 <span class="comment">%                                       | |                           | |</span>
0052 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0053 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0054 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0055 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0056 <span class="comment">%                       __/ |                   __/ |</span>
0057 <span class="comment">%                      |___/                   |___/</span>
0058 <span class="comment">%</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% M. Bye v12.05</span>
0061 <span class="comment">%</span>
0062 <span class="comment">% Author:       Morgan Bye</span>
0063 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0064 <span class="comment">%               University of East Anglia</span>
0065 <span class="comment">%               NORWICH, UK</span>
0066 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0067 <span class="comment">% Website:      http://www.morganbye.net/eprtoolbox/</span>
0068 <span class="comment">% May 2012;     Last revision: 08-May-2012</span>
0069 <span class="comment">%</span>
0070 <span class="comment">% Approximate coding time of file:</span>
0071 <span class="comment">%               4 hours</span>
0072 <span class="comment">%</span>
0073 <span class="comment">%</span>
0074 <span class="comment">% Version history:</span>
0075 <span class="comment">% May 12        Changed 3rd input argument so that if a file path is</span>
0076 <span class="comment">%               specified then the script writes out to that address. Only</span>
0077 <span class="comment">%               useful really for when this script is called from other</span>
0078 <span class="comment">%               scripts; ie. in a for loop for writing many files</span>
0079 <span class="comment">%</span>
0080 <span class="comment">% Dec 11        Initial release</span>
0081 <span class="comment">%</span>
0082 
0083 <span class="comment">%                       Input arguments</span>
0084 <span class="comment">% ========================================================================</span>
0085 
0086 <span class="keyword">switch</span> nargin
0087     <span class="keyword">case</span> 0
0088         error(<span class="string">'BrukerWrite needs to be called with input arguments'</span>);
0089     <span class="keyword">case</span> 1
0090         error(<span class="string">'Insufficient number of input arguments for BrukerWrite'</span>);
0091     <span class="keyword">case</span> 3
0092         title = varargin{1};
0093 
0094 <span class="keyword">end</span>
0095 
0096 
0097 <span class="comment">%                         Create files</span>
0098 <span class="comment">% ========================================================================</span>
0099 
0100 [file, pathname] = uiputfile({ <span class="string">'*.DTA'</span>,<span class="string">'Bruker BES3T File (*.DTA)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0101         <span class="string">'Save file as'</span>,<span class="string">'default'</span>);
0102     
0103 filename = strtok(file,<span class="string">'.'</span>);
0104 
0105 DTA = fopen([pathname filename <span class="string">'.DTA'</span>],<span class="string">'w'</span>);
0106 DSC = fopen([pathname filename <span class="string">'.DSC'</span>],<span class="string">'w'</span>);
0107 
0108 
0109 <span class="comment">%                           Data file</span>
0110 <span class="comment">% ========================================================================</span>
0111 
0112 fwrite(DTA,y,<span class="string">'double'</span>,0,<span class="string">'ieee-be.l64'</span>);
0113 
0114 <span class="comment">%                       Descriptor file</span>
0115 <span class="comment">% ========================================================================</span>
0116 
0117 L01 = <span class="string">'#DESC    1.2 * DESCRIPTOR INFORMATION ***********************'</span>;
0118 L02 = <span class="string">'*'</span>;
0119 L03 = <span class="string">'*    Dataset Type and Format:'</span>;
0120 L04 = <span class="string">'*'</span>;
0121 DSRC = [<span class="string">'DSRC    '</span> <span class="string">'EXP'</span>];
0122 BSEQ = [<span class="string">'BSEQ    '</span> <span class="string">'BIG'</span>];
0123 IKKF = [<span class="string">'IKKF    '</span> <span class="string">'REAL'</span>];
0124 XTYP = [<span class="string">'XTYP    '</span> <span class="string">'IDX'</span>];
0125 YTYP = [<span class="string">'YTYP    '</span> <span class="string">'NODATA'</span>];
0126 ZTYP = [<span class="string">'ZTYP    '</span> <span class="string">'NODATA'</span>];
0127 L05 = <span class="string">'*'</span>;
0128 L06 = <span class="string">'*    Item Formats:'</span>;
0129 L07 = <span class="string">'*'</span>;
0130 L08 = <span class="string">'IRFMT    D'</span>;
0131 L09 = <span class="string">'*'</span>;
0132 L10 = <span class="string">'*    Data Ranges and Resolutions:'</span>;
0133 L11 = <span class="string">'*'</span>;
0134 XPTS = [<span class="string">'XPTS    '</span> num2str(size(x,1))];
0135 XMIN = [<span class="string">'XMIN    '</span> num2str(min(x))];
0136 XWID = [<span class="string">'XWID    '</span> num2str(max(x) - min(x))];
0137 L12 = <span class="string">'*'</span>;
0138 L13 = <span class="string">'*    Documentational Text:'</span>;
0139 L14 = <span class="string">'*'</span>;
0140 TITL = filename;
0141 IRNAM = [<span class="string">'IRNAM    '</span> <span class="string">'''Intensity'''</span>];
0142 XNAM  = [<span class="string">'XNAM    '</span> <span class="string">'''Field'''</span>];
0143 IRUNI = [<span class="string">'IRUNI    '</span> <span class="string">''''''</span>];
0144 XUNI  = [<span class="string">'XUNI    '</span> <span class="string">'''G'''</span>];
0145 L15 = <span class="string">'*'</span>;
0146 L16 = <span class="string">'************************************************************'</span>;
0147 
0148 DESC = char(L01,L02,L03,L04,DSRC,BSEQ,IKKF,XTYP,YTYP,ZTYP,<span class="keyword">...</span>
0149     L05,L06,L07,L08,L09,L10,L11,XPTS,XMIN,XWID,L12,L13,L14,TITL,IRNAM<span class="keyword">...</span>
0150     ,XNAM,IRUNI,XUNI,L15,L16);
0151 
0152 L17 = <span class="string">'*'</span>;
0153 L18 = <span class="string">'#SPL    1.2 * STANDARD PARAMETER LAYER'</span>;
0154 L19 = <span class="string">'*'</span>;
0155 OPER = [<span class="string">'OPER    '</span> <span class="string">'EPRtoolbox'</span>];
0156 DATE  = [<span class="string">'DATE    '</span> datestr(now , <span class="string">'dd/mm/yy'</span>)];
0157 TIME = [<span class="string">'TIME    '</span> datestr(now , <span class="string">'HH:MM:SS'</span>)];
0158 CMNT = <span class="string">'CMNT'</span>;
0159 SAMP = [<span class="string">'SAMP    '</span> <span class="string">''</span>];
0160 SFOR = [<span class="string">'SFOR    '</span> <span class="string">'CW'</span>];
0161 STAG = [<span class="string">'STAG    '</span> <span class="string">'C'</span>];
0162 EXPT = [<span class="string">'EXPT    '</span> <span class="string">'CW'</span>];
0163 OXS1 = [<span class="string">'OXS1    '</span> <span class="string">'IADC'</span>];
0164 AXS1 = [<span class="string">'AXS1    '</span> <span class="string">'BOVL'</span>];
0165 AXS2 = [<span class="string">'AXS2    '</span> <span class="string">'NONE'</span>];
0166 AXS3 = [<span class="string">'AXS3    '</span> <span class="string">''</span>];
0167 A1CT = [<span class="string">'A1CT    '</span> <span class="string">''</span>];
0168 A1SW = [<span class="string">'A1SW    '</span> <span class="string">''</span>];
0169 MWFQ = [<span class="string">'MWFQ    '</span> <span class="string">''</span>];
0170 AVGS = [<span class="string">'AVGS    '</span> <span class="string">''</span>];
0171 RESO = [<span class="string">'RESO    '</span> <span class="string">''</span>];
0172 RCAG = [<span class="string">'RCAG    '</span> <span class="string">''</span>];
0173 RCHM = [<span class="string">'RCHM    '</span> <span class="string">''</span>];
0174 B0MA = [<span class="string">'B0MA    '</span> <span class="string">''</span>];
0175 B0MF = [<span class="string">'B0MF    '</span> <span class="string">''</span>];
0176 RCPH = [<span class="string">'RCPH    '</span> <span class="string">''</span>];
0177 RCOF = [<span class="string">'RCOF    '</span> <span class="string">''</span>];
0178 A1RS = [<span class="string">'A1RS    '</span> <span class="string">''</span>];
0179 RCTC = [<span class="string">'RCTC    '</span> <span class="string">''</span>];
0180 L20 = <span class="string">'*'</span>;
0181 L21 = <span class="string">'************************************************************'</span>;
0182 
0183 SPL = char(L17,L18,L19,OPER,DATE,TIME,CMNT,SAMP,SFOR,STAG,EXPT,OXS1,<span class="keyword">...</span>
0184     AXS1,AXS2,AXS3,A1CT,A1SW,MWFQ,AVGS,RESO,RCAG,RCAG,RCHM,B0MA,B0MF,<span class="keyword">...</span>
0185     RCPH,RCOF,A1RS,RCTC,L20,L21);
0186 
0187 dsc_output = char(DESC,SPL);
0188 
0189 <span class="keyword">for</span> k = 1:size(dsc_output,1)
0190     fprintf(DSC,<span class="string">'%s\n'</span>,dsc_output(k,:));
0191 <span class="keyword">end</span>
0192 
0193 fclose(DSC);</pre></div>
<hr><address>Generated on Sun 07-Jul-2013 12:41:22 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>