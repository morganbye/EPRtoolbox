<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of BrukerRead</title>
  <meta name="keywords" content="BrukerRead">
  <meta name="description" content="BRUKERREAD Open Bruker BE3ST files (.DTA / .DSC , .spc / .par) into the">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">toolbox</a> &gt; <a href="index.html">misc</a> &gt; BrukerRead.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for toolbox/misc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>BrukerRead
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>BRUKERREAD Open Bruker BE3ST files (.DTA / .DSC , .spc / .par) into the</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function varargout = BrukerRead(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> BRUKERREAD Open Bruker BE3ST files (.DTA / .DSC , .spc / .par) into the
 MATLAB workspace.

 BRUKERREAD ()
 BRUKERREAD ('/path/to/file')
 BRUKERREAD ('plot')
 BRUKERREAD ('/path/to/file','plot')
 [x, y] = BRUKERREAD (...)
 [x, y, info] = BRUKERREAD (...)

 BRUKERREAD when run without any inputs, opens a GUI so that the user can
 open the file themselves. BRUKERREAD can also accept a path to a file as
 an input if the path is put in 'quotes' and the extension (.DTA) is left
 off.

 BRUKERREAD now also works with Bruker .spc/.par from EMX machines -
 thanks to Muege Aksoyoglu (Uni. Freiburg, DE) who kindly donated some
 .spc/.par files for testing

 BRUKERREAD can be run with the optional 'plot' input, to plot the file
 being loaded

 BRUKERREAD outputs a x matrix (magnetic field / time), a y matrix
 (intensity) and an optional info field.

 If no outputs are selected then the x and y values are plotted
 With the graph option (graph is assigned value 1) the data is also
 plotted

 BRUKERREAD is fully functional with cw experiments and 3 dimensional cw
 experiments where there is an additional .YGF file. BRUKERREAD provides
 basic functionality for pulsed experiments, it has been tested with field
 swept echoes and fourier induced decays. More complex experiments such as
 ENDOR/ESEEM are untested and may have varying results but the
 information array should be complete.

 Inputs:
    input1     - a string input to the path of a file
    input2     - 'plot' draws a plot of the imported file

 Outputs:
    output0    - plot
                   A new figure showing the data
    output1    - x axis
                   Magnetic field
    output2    - y axis
                   Intensity
    output3    - information
                   Array of information about the loaded file

 Example: 
    [x,y] = BrukerRead
               GUI load a file

    [x,y,info] = BrukerRead('/path/to/file.DTA','plot')
               load x,y and info of file.DTA with to the workspace and 
               plot x,y as a new figure

 Other m-files required:   none

 Subfunctions:             none

 MAT-files required:       none


 See also: EPRTOOLBOX CWPLOTTER</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = BrukerRead(varargin)</a>
0002 
0003 <span class="comment">% BRUKERREAD Open Bruker BE3ST files (.DTA / .DSC , .spc / .par) into the</span>
0004 <span class="comment">% MATLAB workspace.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% BRUKERREAD ()</span>
0007 <span class="comment">% BRUKERREAD ('/path/to/file')</span>
0008 <span class="comment">% BRUKERREAD ('plot')</span>
0009 <span class="comment">% BRUKERREAD ('/path/to/file','plot')</span>
0010 <span class="comment">% [x, y] = BRUKERREAD (...)</span>
0011 <span class="comment">% [x, y, info] = BRUKERREAD (...)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% BRUKERREAD when run without any inputs, opens a GUI so that the user can</span>
0014 <span class="comment">% open the file themselves. BRUKERREAD can also accept a path to a file as</span>
0015 <span class="comment">% an input if the path is put in 'quotes' and the extension (.DTA) is left</span>
0016 <span class="comment">% off.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% BRUKERREAD now also works with Bruker .spc/.par from EMX machines -</span>
0019 <span class="comment">% thanks to Muege Aksoyoglu (Uni. Freiburg, DE) who kindly donated some</span>
0020 <span class="comment">% .spc/.par files for testing</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% BRUKERREAD can be run with the optional 'plot' input, to plot the file</span>
0023 <span class="comment">% being loaded</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% BRUKERREAD outputs a x matrix (magnetic field / time), a y matrix</span>
0026 <span class="comment">% (intensity) and an optional info field.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% If no outputs are selected then the x and y values are plotted</span>
0029 <span class="comment">% With the graph option (graph is assigned value 1) the data is also</span>
0030 <span class="comment">% plotted</span>
0031 <span class="comment">%</span>
0032 <span class="comment">% BRUKERREAD is fully functional with cw experiments and 3 dimensional cw</span>
0033 <span class="comment">% experiments where there is an additional .YGF file. BRUKERREAD provides</span>
0034 <span class="comment">% basic functionality for pulsed experiments, it has been tested with field</span>
0035 <span class="comment">% swept echoes and fourier induced decays. More complex experiments such as</span>
0036 <span class="comment">% ENDOR/ESEEM are untested and may have varying results but the</span>
0037 <span class="comment">% information array should be complete.</span>
0038 <span class="comment">%</span>
0039 <span class="comment">% Inputs:</span>
0040 <span class="comment">%    input1     - a string input to the path of a file</span>
0041 <span class="comment">%    input2     - 'plot' draws a plot of the imported file</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% Outputs:</span>
0044 <span class="comment">%    output0    - plot</span>
0045 <span class="comment">%                   A new figure showing the data</span>
0046 <span class="comment">%    output1    - x axis</span>
0047 <span class="comment">%                   Magnetic field</span>
0048 <span class="comment">%    output2    - y axis</span>
0049 <span class="comment">%                   Intensity</span>
0050 <span class="comment">%    output3    - information</span>
0051 <span class="comment">%                   Array of information about the loaded file</span>
0052 <span class="comment">%</span>
0053 <span class="comment">% Example:</span>
0054 <span class="comment">%    [x,y] = BrukerRead</span>
0055 <span class="comment">%               GUI load a file</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%    [x,y,info] = BrukerRead('/path/to/file.DTA','plot')</span>
0058 <span class="comment">%               load x,y and info of file.DTA with to the workspace and</span>
0059 <span class="comment">%               plot x,y as a new figure</span>
0060 <span class="comment">%</span>
0061 <span class="comment">% Other m-files required:   none</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Subfunctions:             none</span>
0064 <span class="comment">%</span>
0065 <span class="comment">% MAT-files required:       none</span>
0066 <span class="comment">%</span>
0067 <span class="comment">%</span>
0068 <span class="comment">% See also: EPRTOOLBOX CWPLOTTER</span>
0069 
0070 
0071 <span class="comment">%                                        _                             _</span>
0072 <span class="comment">%                                       | |                           | |</span>
0073 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0074 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0075 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0076 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0077 <span class="comment">%                       __/ |                   __/ |</span>
0078 <span class="comment">%                      |___/                   |___/</span>
0079 <span class="comment">%</span>
0080 <span class="comment">%</span>
0081 <span class="comment">% M. Bye v12.7</span>
0082 <span class="comment">%</span>
0083 <span class="comment">% Author:       Morgan Bye</span>
0084 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0085 <span class="comment">%               University of East Anglia</span>
0086 <span class="comment">%               NORWICH, UK</span>
0087 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0088 <span class="comment">% Website:      http://www.morganbye.net/eprtoolbox/brukerread</span>
0089 <span class="comment">% Jul 2012;     Last revision: 9-July-2012</span>
0090 <span class="comment">%</span>
0091 <span class="comment">% Approximate coding time of file:</span>
0092 <span class="comment">%               10 hours</span>
0093 <span class="comment">%</span>
0094 <span class="comment">%</span>
0095 <span class="comment">% Version history:</span>
0096 <span class="comment">% Jun 12        &gt; Muege Aksoyoglu (Uni. Freiburg, DE) kindly donated some</span>
0097 <span class="comment">%                   .spc/.par files from an EMX machine allowing for</span>
0098 <span class="comment">%                   support for these files</span>
0099 <span class="comment">%               &gt; GUI load window updated to &quot;Bruker files&quot; instead of</span>
0100 <span class="comment">%                   seperate options for DTA and spc</span>
0101 <span class="comment">%               &gt; if statements for DTA/spc changed to switch statements</span>
0102 <span class="comment">%                   for cleaner code</span>
0103 <span class="comment">%</span>
0104 <span class="comment">% Apr 12        &gt; Better handling of pulse experiments</span>
0105 <span class="comment">%               &gt; Inputs changed so that 'plot' can be used by itself</span>
0106 <span class="comment">%               &gt; Figure plotting reconfigured and improved</span>
0107 <span class="comment">%                       - imaginary channel for pulse experiments</span>
0108 <span class="comment">%                       - legend is displayed for real/imaginary channels</span>
0109 <span class="comment">%                       - x-axis corrected for time or mag field depending</span>
0110 <span class="comment">%                       on FSE or FID experiment with correct units/label</span>
0111 <span class="comment">%</span>
0112 <span class="comment">% Feb 12        Minor edit - fix for occasional file load by command line</span>
0113 <span class="comment">%               error</span>
0114 <span class="comment">%</span>
0115 <span class="comment">% Dec 11        Plotted figures have file names included in header</span>
0116 <span class="comment">%</span>
0117 <span class="comment">% Oct 11        &gt; &quot;Return&quot; catch statement if user cancels a file load</span>
0118 <span class="comment">%                   using the GUI</span>
0119 <span class="comment">%               &gt; Fixed bug with 'plot' input parameter</span>
0120 <span class="comment">%</span>
0121 <span class="comment">% Sept 11       Changed fid/fopen name reference system so that files are</span>
0122 <span class="comment">%               still loaded even if not in the same location as MATLAB's</span>
0123 <span class="comment">%               &quot;Current Folder&quot;. Only a problem occasionally when called</span>
0124 <span class="comment">%               from another script.</span>
0125 
0126 <span class="comment">%                         Input arguments</span>
0127 <span class="comment">% ========================================================================</span>
0128 
0129 <span class="keyword">switch</span> nargin
0130     <span class="keyword">case</span> 0
0131         <span class="comment">% GUI get file</span>
0132         [file , directory] = uigetfile({<span class="string">'*.DTA;*.spc'</span>,<span class="string">'Bruker File (*.DTA,*.spc)'</span>; <span class="keyword">...</span>
0133             <span class="string">'*.*'</span>,  <span class="string">'All Files (*.*)'</span>},<span class="keyword">...</span>
0134             <span class="string">'Load Bruker file'</span>);
0135         
0136         <span class="comment">% if user cancels command nothing happens</span>
0137         <span class="keyword">if</span> isequal(file,0) <span class="comment">%|| isequal(directory,0)</span>
0138             <span class="keyword">return</span>
0139         <span class="keyword">end</span>
0140                 
0141         <span class="comment">% File name/path manipulation</span>
0142         address = [directory,file];
0143         [~, name,extension] = fileparts(address);
0144         
0145         graph = <span class="string">''</span>;
0146         
0147         
0148     <span class="keyword">case</span> 1
0149         <span class="comment">% If input is 'plot'</span>
0150         <span class="keyword">if</span> strcmp(varargin{1},<span class="string">'plot'</span>)
0151             graph = <span class="string">'plot'</span>;
0152             
0153             <span class="comment">% GUI get file</span>
0154             [file , directory] = uigetfile({<span class="string">'*.DTA'</span>,<span class="string">'Bruker BES3T File (*.DTA)'</span>; <span class="keyword">...</span>
0155             <span class="string">'*.spc'</span>,<span class="string">'Bruker Spc File (*.spc)'</span>; <span class="keyword">...</span>
0156             <span class="string">'*.*'</span>,  <span class="string">'All Files (*.*)'</span>},<span class="string">'Load Bruker file'</span>);
0157         
0158             <span class="comment">% if user cancels command nothing happens</span>
0159             <span class="keyword">if</span> isequal(file,0) <span class="comment">%|| isequal(directory,0)</span>
0160                 <span class="keyword">return</span>
0161             <span class="keyword">end</span>
0162                 
0163             <span class="comment">% File name/path manipulation</span>
0164             address = [directory,file];
0165             [~, name,extension] = fileparts(address);
0166             
0167         <span class="comment">% Or if input is a path</span>
0168         <span class="keyword">else</span>
0169             address = varargin{1};
0170             [directory,name,extension] = fileparts(address);
0171             graph = <span class="string">''</span>;
0172         <span class="keyword">end</span>
0173         
0174     <span class="keyword">case</span> 2
0175         address = varargin{1};
0176         [directory,name,extension] = fileparts(address);
0177         graph = varargin{2};
0178 <span class="keyword">end</span>
0179 
0180 <span class="comment">%                         Parameter files</span>
0181 <span class="comment">% ========================================================================</span>
0182 
0183 <span class="comment">% Load .dsc/.par file</span>
0184 <span class="comment">% ===================</span>
0185 <span class="keyword">switch</span> extension
0186     <span class="keyword">case</span> <span class="string">'.spc'</span>
0187     filepar = [ directory <span class="string">'/'</span> name <span class="string">'.par'</span>];
0188     fid = fopen( filepar , <span class="string">'r'</span>);
0189     
0190     delimiter = 10;
0191     
0192     <span class="keyword">case</span> <span class="string">'.DTA'</span>
0193     filedsc = [directory <span class="string">'/'</span> name <span class="string">'.DSC'</span>];
0194     fid = fopen( filedsc , <span class="string">'r'</span>);
0195     
0196     delimiter = 10;
0197 <span class="keyword">end</span>
0198 
0199 <span class="comment">% Get characters from file</span>
0200 [string , string_characters] = fscanf( fid , <span class="string">'%c'</span> );
0201 
0202 <span class="comment">% Close file, free up memory</span>
0203 fclose(fid);
0204 
0205 <span class="comment">% Convert character array into useful string array (insert line breaks)</span>
0206 parameters = [];
0207 
0208 <span class="keyword">while</span> isempty(string) == 0;
0209     [token, string] = strtok(string,char(delimiter));
0210     parameters = str2mat(parameters,token);
0211 <span class="keyword">end</span>
0212 
0213 <span class="comment">% Do basic reading of info file to decide on how to proceed with number</span>
0214 <span class="comment">% crunching.</span>
0215 
0216 <span class="keyword">switch</span> extension
0217     <span class="keyword">case</span> <span class="string">'.spc'</span>
0218         info.EXPT = <span class="string">'CW'</span>;
0219         
0220     <span class="keyword">case</span> <span class="string">'.DTA'</span>
0221         
0222         info.EXPT  = strtrim(regexprep(parameters((strmatch(<span class="string">'EXPT'</span>,parameters)),:),<span class="string">'EXPT'</span>,<span class="string">''</span>));
0223         info.IRNAM = strtrim(regexprep(parameters((strmatch(<span class="string">'IRNAM'</span>,parameters)),:),<span class="string">'IRNAM'</span>,<span class="string">''</span>));
0224         info.XNAM  = strtrim(regexprep(parameters((strmatch(<span class="string">'XNAM'</span>,parameters)),:),<span class="string">'XNAM'</span>,<span class="string">''</span>));
0225         info.XUNI  = strtrim(regexprep(parameters((strmatch(<span class="string">'XUNI'</span>,parameters)),:),<span class="string">'XUNI'</span>,<span class="string">''</span>));
0226         info.TITL  = strtrim(regexprep(parameters((strmatch(<span class="string">'TITL'</span>,parameters)),:),<span class="string">'TITL'</span>,<span class="string">''</span>));
0227 <span class="keyword">end</span>
0228 
0229 
0230 <span class="comment">%                            Data files</span>
0231 <span class="comment">% ========================================================================</span>
0232 
0233 
0234 <span class="comment">% Load .dta/.spc file</span>
0235 <span class="keyword">switch</span> extension
0236     <span class="keyword">case</span> <span class="string">'.spc'</span>
0237         fid   = fopen( [directory <span class="string">'/'</span> name <span class="string">'.spc'</span>], <span class="string">'r'</span>);
0238         [y,n] = fread(fid,inf,<span class="string">'float'</span>);
0239         
0240     <span class="keyword">case</span> <span class="string">'.DTA'</span>
0241         fid   = fopen( [directory <span class="string">'/'</span> name <span class="string">'.DTA'</span>], <span class="string">'r'</span>,<span class="string">'ieee-be.l64'</span>);
0242         [y,n] = fread(fid,inf,<span class="string">'float64'</span>);
0243 <span class="keyword">end</span>
0244 
0245 fclose(fid);
0246 
0247 
0248 <span class="comment">% Pulsed experiment splitting into real and imaginary channels</span>
0249 <span class="keyword">if</span> strcmp(info.EXPT,<span class="string">'PLS'</span>)
0250     z = reshape(y,2,[]);
0251     y.real = z(1,:)';
0252     y.imag = z(2,:)';
0253 <span class="keyword">end</span>
0254     
0255 
0256 
0257 
0258 <span class="comment">%                            YGF files</span>
0259 <span class="comment">% ========================================================================</span>
0260 
0261 
0262 <span class="comment">% search directory for .YGF file</span>
0263 <span class="keyword">if</span> exist([directory name <span class="string">'.YGF'</span>],<span class="string">'file'</span>)
0264     
0265     <span class="comment">% if exist, load .YGF , convert to usable matrix</span>
0266     fid = fopen( [directory name <span class="string">'.YGF'</span>], <span class="string">'r'</span>,<span class="string">'ieee-be.l64'</span>);
0267     [info.z_axis,info.z_axis_points] = fread(fid,inf,<span class="string">'float64'</span>);
0268     
0269     <span class="comment">% find number of data points</span>
0270     MagField.points = str2num(regexprep(parameters((strmatch(<span class="string">'XPTS'</span>,parameters)),:),<span class="string">'XPTS'</span>,<span class="string">''</span>));
0271     <span class="comment">% reshape the y-axis into columns using number of data points</span>
0272     y = reshape(y, MagField.points , []);
0273     
0274 <span class="keyword">end</span>
0275 
0276 
0277 
0278 
0279 <span class="comment">%                         Magnetic field</span>
0280 <span class="comment">% ========================================================================</span>
0281 
0282 
0283 <span class="keyword">switch</span> extension
0284     <span class="keyword">case</span> <span class="string">'.spc'</span>
0285         
0286         <span class="comment">% Mag field centre point</span>
0287         MagField.centre = str2num(regexprep(parameters((strmatch(<span class="string">'HCF'</span>,parameters)),:),<span class="string">'HCF'</span>,<span class="string">''</span>));
0288         
0289         <span class="comment">% Mag field sweep width</span>
0290         MagField.width  = str2num(regexprep(parameters((strmatch(<span class="string">'HSW'</span>,parameters)),:),<span class="string">'HSW'</span>,<span class="string">''</span>));
0291         
0292         <span class="comment">% Mag field data points</span>
0293         MagField.points = str2num(regexprep(parameters((strmatch(<span class="string">'ANZ'</span>,parameters)),:),<span class="string">'ANZ'</span>,<span class="string">''</span>));
0294         
0295         MagField.min      = MagField.centre - (MagField.width / 2);
0296         MagField.sampling = MagField.width / MagField.points;
0297         
0298         <span class="keyword">for</span> k = 1:MagField.points
0299             x(k) = MagField.min + (MagField.sampling * ((k)-1));
0300         <span class="keyword">end</span>
0301         
0302         x = x';
0303         
0304     <span class="keyword">case</span> <span class="string">'.DTA'</span>    
0305 
0306         <span class="comment">% =================================</span>
0307         <span class="comment">% a = strmatch('XMIN',basic_info)  % find line of XMIN</span>
0308         <span class="comment">% mag_start = basic_info(a,:);     % read that line</span>
0309         <span class="comment">% regexprep(mag_start,'XMIN','')   % delete XMIN from that line</span>
0310         <span class="comment">% str2num                          % convert string to number</span>
0311         <span class="comment">%</span>
0312         <span class="comment">% in a shell this could easily be done with &quot;awk&quot;</span>
0313         <span class="comment">% =================================</span>
0314         
0315         <span class="comment">% Mag field start</span>
0316         MagField.min = str2num(regexprep(parameters((strmatch(<span class="string">'XMIN'</span>,parameters)),:),<span class="string">'XMIN'</span>,<span class="string">''</span>));
0317         
0318         <span class="comment">% Mag field width</span>
0319         MagField.width = str2num(regexprep(parameters((strmatch(<span class="string">'XWID'</span>,parameters)),:),<span class="string">'XWID'</span>,<span class="string">''</span>));
0320         
0321         <span class="comment">% Mag number of data points</span>
0322         MagField.points = str2num(regexprep(parameters((strmatch(<span class="string">'XPTS'</span>,parameters)),:),<span class="string">'XPTS'</span>,<span class="string">''</span>));
0323         
0324         
0325         MagField.max = MagField.min + MagField.width;
0326         MagField.sampling = MagField.width / MagField.points;
0327         
0328         <span class="keyword">for</span> k = 1:MagField.points
0329             x(k) = MagField.min + (MagField.sampling * ((k)-1));
0330         <span class="keyword">end</span>
0331         
0332         x = x';
0333         
0334 <span class="keyword">end</span>
0335 
0336 
0337 
0338 <span class="comment">%                         Output arguments</span>
0339 <span class="comment">% ========================================================================</span>
0340 
0341 <span class="comment">% Output results according to requests</span>
0342 <span class="keyword">switch</span> nargout
0343     <span class="keyword">case</span> 0
0344         graph = <span class="string">'plot'</span>;
0345     <span class="keyword">case</span> 1
0346         varargout{1} = y;
0347     <span class="keyword">case</span> 2
0348         varargout{1} = x;
0349         varargout{2} = y;
0350     <span class="keyword">case</span> 3
0351         <span class="keyword">switch</span> extension
0352             <span class="keyword">case</span> <span class="string">'.spc'</span>
0353                 info.MWFQ = str2num(regexprep(parameters((strmatch(<span class="string">'MF'</span> ,parameters)),:),<span class="string">'MF'</span> ,<span class="string">''</span>));
0354                 info.MWPW = str2num(regexprep(parameters((strmatch(<span class="string">'MP'</span> ,parameters)),:),<span class="string">'MP'</span> ,<span class="string">''</span>));
0355                 
0356                 info.CenterField    = str2num(regexprep(parameters((strmatch(<span class="string">'HCF'</span>,parameters)),:),<span class="string">'HCF'</span>,<span class="string">''</span>));
0357                 info.SweepWidth     = str2num(regexprep(parameters((strmatch(<span class="string">'HSW'</span>,parameters)),:),<span class="string">'HSW'</span>,<span class="string">''</span>));
0358                 
0359             <span class="keyword">case</span> <span class="string">'.DTA'</span>
0360                 
0361                 <span class="comment">% create info parameters, only done if requested to minimise</span>
0362                 <span class="comment">% computation time of function</span>
0363                 info.DSRC = strtrim(regexprep(parameters((strmatch(<span class="string">'DSRC'</span>,parameters)),:),<span class="string">'DSRC'</span>,<span class="string">''</span>));
0364                 info.BSEQ = strtrim(regexprep(parameters((strmatch(<span class="string">'BSEQ'</span>,parameters)),:),<span class="string">'BSEQ'</span>,<span class="string">''</span>));
0365                 info.IKKF = strtrim(regexprep(parameters((strmatch(<span class="string">'IKKF'</span>,parameters)),:),<span class="string">'IKKF'</span>,<span class="string">''</span>));
0366                 info.XTYP = strtrim(regexprep(parameters((strmatch(<span class="string">'XTYP'</span>,parameters)),:),<span class="string">'XTYP'</span>,<span class="string">''</span>));
0367                 info.YTYP = strtrim(regexprep(parameters((strmatch(<span class="string">'YTYP'</span>,parameters)),:),<span class="string">'YTYP'</span>,<span class="string">''</span>));
0368                 info.ZTYP = strtrim(regexprep(parameters((strmatch(<span class="string">'ZTYP'</span>,parameters)),:),<span class="string">'ZTYP'</span>,<span class="string">''</span>));
0369                 
0370                 info.IRFMT = strtrim(regexprep(parameters((strmatch(<span class="string">'IRFMT'</span>,parameters)),:),<span class="string">'IRFMT'</span>,<span class="string">''</span>));
0371                 
0372                 info.XMIN = str2num(regexprep(parameters((strmatch(<span class="string">'XMIN'</span>,parameters)),:),<span class="string">'XMIN'</span>,<span class="string">''</span>));
0373                 info.XWID = str2num(regexprep(parameters((strmatch(<span class="string">'XWID'</span>,parameters)),:),<span class="string">'XWID'</span>,<span class="string">''</span>));
0374                 info.XPTS = str2num(regexprep(parameters((strmatch(<span class="string">'XPTS'</span>,parameters)),:),<span class="string">'XPTS'</span>,<span class="string">''</span>));
0375                 
0376                 <span class="comment">% info.TITL = strtrim(regexprep(parameters((strmatch('TITL',parameters)),:),'TITL',''));</span>
0377                 info.IRUNI = strtrim(regexprep(parameters((strmatch(<span class="string">'IRUNI'</span>,parameters)),:),<span class="string">'IRUNI'</span>,<span class="string">''</span>));
0378                 
0379                 info.OPER = strtrim(regexprep(parameters((strmatch(<span class="string">'OPER'</span>,parameters)),:),<span class="string">'OPER'</span>,<span class="string">''</span>));
0380                 info.DATE = strtrim(regexprep(parameters((strmatch(<span class="string">'DATE'</span>,parameters)),:),<span class="string">'DATE'</span>,<span class="string">''</span>));
0381                 info.TIME = strtrim(regexprep(parameters((strmatch(<span class="string">'TIME'</span>,parameters)),:),<span class="string">'TIME'</span>,<span class="string">''</span>));
0382                 info.CMNT = strtrim(regexprep(parameters((strmatch(<span class="string">'CMNT'</span>,parameters)),:),<span class="string">'CMNT'</span>,<span class="string">''</span>));
0383                 info.SAMP = strtrim(regexprep(parameters((strmatch(<span class="string">'SAMP'</span>,parameters)),:),<span class="string">'SAMP'</span>,<span class="string">''</span>));
0384                 info.SFOR = strtrim(regexprep(parameters((strmatch(<span class="string">'SFOR'</span>,parameters)),:),<span class="string">'SFOR'</span>,<span class="string">''</span>));
0385                 info.STAG = strtrim(regexprep(parameters((strmatch(<span class="string">'STAG'</span>,parameters)),:),<span class="string">'STAG'</span>,<span class="string">''</span>));
0386                 info.OXS1 = strtrim(regexprep(parameters((strmatch(<span class="string">'OXS1'</span>,parameters)),:),<span class="string">'OXS1'</span>,<span class="string">''</span>));
0387                 info.AXS1 = strtrim(regexprep(parameters((strmatch(<span class="string">'AXS1'</span>,parameters)),:),<span class="string">'AXS1'</span>,<span class="string">''</span>));
0388                 info.AXS2 = strtrim(regexprep(parameters((strmatch(<span class="string">'AXS2'</span>,parameters)),:),<span class="string">'AXS2'</span>,<span class="string">''</span>));
0389                 info.AXS3 = strtrim(regexprep(parameters((strmatch(<span class="string">'AXS3'</span>,parameters)),:),<span class="string">'AXS3'</span>,<span class="string">''</span>));
0390                 info.A1CT = str2num(regexprep(parameters((strmatch(<span class="string">'A1CT'</span>,parameters)),:),<span class="string">'A1CT'</span>,<span class="string">''</span>));
0391                 info.A1SW = str2num(regexprep(parameters((strmatch(<span class="string">'A1SW'</span>,parameters)),:),<span class="string">'A1SW'</span>,<span class="string">''</span>));
0392                 info.MWFQ = str2num(regexprep(parameters((strmatch(<span class="string">'MWFQ'</span>,parameters)),:),<span class="string">'MWFQ'</span>,<span class="string">''</span>));
0393                 info.MWPW = str2num(regexprep(parameters((strmatch(<span class="string">'MWPW'</span>,parameters)),:),<span class="string">'MWPW'</span>,<span class="string">''</span>));
0394                 info.AVGS = str2num(regexprep(parameters((strmatch(<span class="string">'AVGS'</span>,parameters)),:),<span class="string">'AVGS'</span>,<span class="string">''</span>));
0395                 
0396                 info.CenterField = strtrim(regexprep(parameters((strmatch(<span class="string">'CenterField'</span>,parameters)),:),<span class="string">'CenterField'</span>,<span class="string">''</span>));
0397                 info.FieldFlyback = strtrim(regexprep(parameters((strmatch(<span class="string">'FieldFlyback'</span>,parameters)),:),<span class="string">'FieldFlyback'</span>,<span class="string">''</span>));
0398                 info.FieldWait = strtrim(regexprep(parameters((strmatch(<span class="string">'FieldWait'</span>,parameters)),:),<span class="string">'FieldWait'</span>,<span class="string">''</span>));
0399                 info.GFactor = str2num(regexprep(parameters((strmatch(<span class="string">'GFactor'</span>,parameters)),:),<span class="string">'GFactor'</span>,<span class="string">''</span>));
0400                 info.SetToSampleG = strtrim(regexprep(parameters((strmatch(<span class="string">'SetToSampleG'</span>,parameters)),:),<span class="string">'SetToSampleG'</span>,<span class="string">''</span>));
0401                 info.SweepDirection = strtrim(regexprep(parameters((strmatch(<span class="string">'SweepDirection'</span>,parameters)),:),<span class="string">'SweepDirection'</span>,<span class="string">''</span>));
0402                 
0403                 info.FrequencyMon = strtrim(regexprep(parameters((strmatch(<span class="string">'FrequencyMon'</span>,parameters)),:),<span class="string">'FrequencyMon'</span>,<span class="string">''</span>));
0404                 info.QMonitBridge = strtrim(regexprep(parameters((strmatch(<span class="string">'QMonitBridge'</span>,parameters)),:),<span class="string">'QMonitBridge'</span>,<span class="string">''</span>));
0405                 <span class="comment">% Power is different because strmatch for 'Power' finds Power and</span>
0406                 <span class="comment">% PowerAtten</span>
0407                 info.Power = parameters((strmatch(<span class="string">'Power'</span>,parameters)),:);
0408                 info.Power = strtrim(regexprep((info.Power(1,:)),<span class="string">'Power'</span>,<span class="string">''</span>));
0409                 info.PowerAtten = strtrim(regexprep(parameters((strmatch(<span class="string">'PowerAtten'</span>,parameters)),:),<span class="string">'PowerAtten'</span>,<span class="string">''</span>));
0410                 info.BaselineCorr = strtrim(regexprep(parameters((strmatch(<span class="string">'BaselineCorr'</span>,parameters)),:),<span class="string">'BaselineCorr'</span>,<span class="string">''</span>));
0411                 info.NbScansAcc = str2num(regexprep(parameters((strmatch(<span class="string">'NbScansAcc'</span>,parameters)),:),<span class="string">'NbScansAcc'</span>,<span class="string">''</span>));
0412                 info.NbScansDone = str2num(regexprep(parameters((strmatch(<span class="string">'NbScansDone'</span>,parameters)),:),<span class="string">'NbScansDone'</span>,<span class="string">''</span>));
0413                 info.NbScansToDo = str2num(regexprep(parameters((strmatch(<span class="string">'NbScansToDo'</span>,parameters)),:),<span class="string">'NbScansToDo'</span>,<span class="string">''</span>));
0414                 
0415                 
0416                 <span class="comment">% Experiment dependent parameters</span>
0417                 <span class="keyword">switch</span> info.EXPT
0418                     <span class="keyword">case</span> <span class="string">'PLS'</span>
0419                         <span class="comment">% documentation text</span>
0420                         info.IIFMT = strtrim(regexprep(parameters((strmatch(<span class="string">'IIFMT'</span>,parameters)),:),<span class="string">'IIFMT'</span>,<span class="string">''</span>));
0421                         info.IIUNI = strtrim(regexprep(parameters((strmatch(<span class="string">'IIUNI'</span>,parameters)),:),<span class="string">'IIUNI'</span>,<span class="string">''</span>));
0422                         
0423                         info.Delay = parameters((strmatch(<span class="string">'Delay'</span>,parameters)),:);
0424                         info.Delay = strtrim(regexprep((info.Delay(1,:)),<span class="string">'Delay'</span>,<span class="string">''</span>));
0425                         <span class="comment">% cw bridge</span>
0426                         info.AcqFineTuning = strtrim(regexprep(parameters((strmatch(<span class="string">'AcqFineTuning'</span>,parameters)),:),<span class="string">'AcqFineTuning'</span>,<span class="string">''</span>));
0427                         info.AcqScanFTuning = strtrim(regexprep(parameters((strmatch(<span class="string">'AcqScanFTuning'</span>,parameters)),:),<span class="string">'AcqScanFTuning'</span>,<span class="string">''</span>));
0428                         info.AcqSliceFTuning = strtrim(regexprep(parameters((strmatch(<span class="string">'AcqSliceFTuning'</span>,parameters)),:),<span class="string">'AcqSliceFTuning'</span>,<span class="string">''</span>));
0429                         <span class="comment">% endor</span>
0430                         info.EIEENDORFreq = strtrim(regexprep(parameters((strmatch(<span class="string">'EIEENDORFreq'</span>,parameters)),:),<span class="string">'EIEENDORFreq'</span>,<span class="string">''</span>));
0431                         info.EIEIsotope = strtrim(regexprep(parameters((strmatch(<span class="string">'EIEIsotope'</span>,parameters)),:),<span class="string">'EIEIsotope'</span>,<span class="string">''</span>));
0432                         info.EIERFSweepDir = strtrim(regexprep(parameters((strmatch(<span class="string">'EIERFSweepDir'</span>,parameters)),:),<span class="string">'EIERFSweepDir'</span>,<span class="string">''</span>));
0433                         info.EIEStaticField = strtrim(regexprep(parameters((strmatch(<span class="string">'EIEStaticField'</span>,parameters)),:),<span class="string">'EIEStaticField'</span>,<span class="string">''</span>));
0434                         info.EIEStaticRF = strtrim(regexprep(parameters((strmatch(<span class="string">'EIEStaticRF'</span>,parameters)),:),<span class="string">'EIEStaticRF'</span>,<span class="string">''</span>));
0435                         info.ENDORType = strtrim(regexprep(parameters((strmatch(<span class="string">'ENDORType'</span>,parameters)),:),<span class="string">'ENDORType'</span>,<span class="string">''</span>));
0436                         info.RF1Atten = strtrim(regexprep(parameters((strmatch(<span class="string">'RF1Atten'</span>,parameters)),:),<span class="string">'RF1Atten'</span>,<span class="string">''</span>));
0437                         info.RF1FreqPos = strtrim(regexprep(parameters((strmatch(<span class="string">'RF1FreqPos'</span>,parameters)),:),<span class="string">'RF1FreqPos'</span>,<span class="string">''</span>));
0438                         info.RF1StartFreq = strtrim(regexprep(parameters((strmatch(<span class="string">'RF1StartFreq'</span>,parameters)),:),<span class="string">'RF1StartFreq'</span>,<span class="string">''</span>));
0439                         info.RF1SweepWidth = strtrim(regexprep(parameters((strmatch(<span class="string">'RF1SweepWidth'</span>,parameters)),:),<span class="string">'RF1SweepWidth'</span>,<span class="string">''</span>));
0440                         info.RF2Atten = strtrim(regexprep(parameters((strmatch(<span class="string">'RF2Atten'</span>,parameters)),:),<span class="string">'RF2Atten'</span>,<span class="string">''</span>));
0441                         info.RF2FreqPos = strtrim(regexprep(parameters((strmatch(<span class="string">'RF2FreqPos'</span>,parameters)),:),<span class="string">'RF2FreqPos'</span>,<span class="string">''</span>));
0442                         info.RF2StartFreq = strtrim(regexprep(parameters((strmatch(<span class="string">'RF2StartFreq'</span>,parameters)),:),<span class="string">'RF2StartFreq'</span>,<span class="string">''</span>));
0443                         info.RF2SweepWidth = strtrim(regexprep(parameters((strmatch(<span class="string">'RF2SweepWidth'</span>,parameters)),:),<span class="string">'RF2SweepWidth'</span>,<span class="string">''</span>));
0444                         info.RFSrcMixing = strtrim(regexprep(parameters((strmatch(<span class="string">'RFSrcMixing'</span>,parameters)),:),<span class="string">'RFSrcMixing'</span>,<span class="string">''</span>));
0445                         info.SumAtten = parameters((strmatch(<span class="string">'SumAtten'</span>,parameters)),:);
0446                         info.SumAtten = strtrim(regexprep((info.Power(1,:)),<span class="string">'SumAtten'</span>,<span class="string">''</span>));
0447                         info.SumAttenStart = strtrim(regexprep(parameters((strmatch(<span class="string">'SumAttenStart'</span>,parameters)),:),<span class="string">'SumAttenStart'</span>,<span class="string">''</span>));
0448                         info.SumAttenWidth = strtrim(regexprep(parameters((strmatch(<span class="string">'SumAttenWidth'</span>,parameters)),:),<span class="string">'SumAttenWidth'</span>,<span class="string">''</span>));
0449                         <span class="comment">% fieldCtrl</span>
0450                         info.FieldResol = str2num(regexprep(parameters((strmatch(<span class="string">'FieldResol'</span>,parameters)),:),<span class="string">'FieldResol'</span>,<span class="string">''</span>));
0451                         <span class="comment">% ftBridge</span>
0452                         info.Attenuation = strtrim(regexprep(parameters((strmatch(<span class="string">'Attenuation'</span>,parameters)),:),<span class="string">'Attenuation'</span>,<span class="string">''</span>));
0453                         info.ELDORAtt = strtrim(regexprep(parameters((strmatch(<span class="string">'ELDORAtt'</span>,parameters)),:),<span class="string">'ELDORAtt'</span>,<span class="string">''</span>));
0454                         info.FrequencyA = strtrim(regexprep(parameters((strmatch(<span class="string">'FrequencyA'</span>,parameters)),:),<span class="string">'FrequencyA'</span>,<span class="string">''</span>));
0455                         info.VideoBW = strtrim(regexprep(parameters((strmatch(<span class="string">'VideoBW'</span>,parameters)),:),<span class="string">'VideoBW'</span>,<span class="string">''</span>));
0456                         info.VideoGain = strtrim(regexprep(parameters((strmatch(<span class="string">'VideoGain'</span>,parameters)),:),<span class="string">'VideoGain'</span>,<span class="string">''</span>));
0457                         <span class="comment">% ftEpr</span>
0458                         info.AutoTimeOut = strtrim(regexprep(parameters((strmatch(<span class="string">'AutoTimeOut'</span>,parameters)),:),<span class="string">'AutoTimeOut'</span>,<span class="string">''</span>));
0459                         info.AveragesPerScan = str2num(regexprep(parameters((strmatch(<span class="string">'AveragesPerScan'</span>,parameters)),:),<span class="string">'AveragesPerScan'</span>,<span class="string">''</span>));
0460                         info.ELDORFreqStart = strtrim(regexprep(parameters((strmatch(<span class="string">'ELDORFreqStart'</span>,parameters)),:),<span class="string">'ELDORFreqStart'</span>,<span class="string">''</span>));
0461                         info.ELDORFreqWidth = strtrim(regexprep(parameters((strmatch(<span class="string">'ELDORFreqWidth'</span>,parameters)),:),<span class="string">'ELDORFreqWidth'</span>,<span class="string">''</span>));
0462                         info.FTAcqModeSlct = strtrim(regexprep(parameters((strmatch(<span class="string">'FTAcqModeSlct'</span>,parameters)),:),<span class="string">'FTAcqModeSlct'</span>,<span class="string">''</span>));
0463                         info.PPExtTrg = parameters((strmatch(<span class="string">'PPExtTrg'</span>,parameters)),:);
0464                         info.PPExtTrg = strtrim(regexprep((info.PPExtTrg(1,:)),<span class="string">'PPExtTrg'</span>,<span class="string">''</span>));
0465                         info.PPExtTrgSlope = strtrim(regexprep(parameters((strmatch(<span class="string">'PPExtTrgSlope'</span>,parameters)),:),<span class="string">'PPExtTrgSlope'</span>,<span class="string">''</span>));
0466                         info.PlsSPELEXPSlct = strtrim(regexprep(parameters((strmatch(<span class="string">'PlsSPELEXPSlct'</span>,parameters)),:),<span class="string">'PlsSPELEXPSlct'</span>,<span class="string">''</span>));
0467                         info.ReplaceMode = parameters((strmatch(<span class="string">'ReplaceMode'</span>,parameters)),:);
0468                         info.ReplaceMode_ftEpr = strtrim(regexprep((info.ReplaceMode(1,:)),<span class="string">'ReplaceMode'</span>,<span class="string">''</span>));
0469                         info.ReplaceMode_recorder = strtrim(regexprep((info.ReplaceMode(2,:)),<span class="string">'ReplaceMode'</span>,<span class="string">''</span>));
0470                         clear info.ReplaceMode
0471                         info.ShotRepTime = strtrim(regexprep(parameters((strmatch(<span class="string">'ShotRepTime'</span>,parameters)),:),<span class="string">'ShotRepTime'</span>,<span class="string">''</span>));
0472                         info.ShotsPLoop = strtrim(regexprep(parameters((strmatch(<span class="string">'ShotsPLoop'</span>,parameters)),:),<span class="string">'ShotsPLoop'</span>,<span class="string">''</span>));
0473                         info.SptProgress = strtrim(regexprep(parameters((strmatch(<span class="string">'SptProgress'</span>,parameters)),:),<span class="string">'SptProgress'</span>,<span class="string">''</span>));
0474                         info.SweepsPExp = strtrim(regexprep(parameters((strmatch(<span class="string">'SweepsPExp'</span>,parameters)),:),<span class="string">'SweepsPExp'</span>,<span class="string">''</span>));
0475                         info.TriggerTimeOut = strtrim(regexprep(parameters((strmatch(<span class="string">'TriggerTimeOut'</span>,parameters)),:),<span class="string">'TriggerTimeOut'</span>,<span class="string">''</span>));
0476                         info.XAxisQuant = strtrim(regexprep(parameters((strmatch(<span class="string">'XAxisQuant'</span>,parameters)),:),<span class="string">'XAxisQuant'</span>,<span class="string">''</span>));
0477                         info.XSpecRes = str2num(regexprep(parameters((strmatch(<span class="string">'XSpecRes'</span>,parameters)),:),<span class="string">'XSpecRes'</span>,<span class="string">''</span>));
0478                         info.YAxisQuant = strtrim(regexprep(parameters((strmatch(<span class="string">'YAxisQuant'</span>,parameters)),:),<span class="string">'YAxisQuant'</span>,<span class="string">''</span>));
0479                         info.YSpecRes = str2num(regexprep(parameters((strmatch(<span class="string">'YSpecRes'</span>,parameters)),:),<span class="string">'YSpecRes'</span>,<span class="string">''</span>));
0480                         
0481                         
0482                     <span class="keyword">case</span> <span class="string">'CW'</span>
0483                         <span class="comment">% document text</span>
0484                         info.YFMT = strtrim(regexprep(parameters((strmatch(<span class="string">'YFMT'</span>,parameters)),:),<span class="string">'YFMT'</span>,<span class="string">''</span>));
0485                         info.YNAM = strtrim(regexprep(parameters((strmatch(<span class="string">'YNAM'</span>,parameters)),:),<span class="string">'YNAM'</span>,<span class="string">''</span>));
0486                         info.YUNI = strtrim(regexprep(parameters((strmatch(<span class="string">'YUNI'</span>,parameters)),:),<span class="string">'YUNI'</span>,<span class="string">''</span>));
0487                         <span class="comment">% standard parameter</span>
0488                         info.RESO = strtrim(regexprep(parameters((strmatch(<span class="string">'RESO'</span>,parameters)),:),<span class="string">'RESO'</span>,<span class="string">''</span>));
0489                         info.SPTP = str2num(regexprep(parameters((strmatch(<span class="string">'SPTP'</span>,parameters)),:),<span class="string">'SPTP'</span>,<span class="string">''</span>));
0490                         info.RCAG = str2num(regexprep(parameters((strmatch(<span class="string">'RCAG'</span>,parameters)),:),<span class="string">'RCAG'</span>,<span class="string">''</span>));
0491                         info.RCHM = str2num(regexprep(parameters((strmatch(<span class="string">'RCHM'</span>,parameters)),:),<span class="string">'RCHM'</span>,<span class="string">''</span>));
0492                         info.B0MA = str2num(regexprep(parameters((strmatch(<span class="string">'B0MA'</span>,parameters)),:),<span class="string">'B0MA'</span>,<span class="string">''</span>));
0493                         info.B0MF = str2num(regexprep(parameters((strmatch(<span class="string">'B0MF'</span>,parameters)),:),<span class="string">'B0MF'</span>,<span class="string">''</span>));
0494                         info.RCPH = str2num(regexprep(parameters((strmatch(<span class="string">'RCPH'</span>,parameters)),:),<span class="string">'RCPH'</span>,<span class="string">''</span>));
0495                         info.RCOF = str2num(regexprep(parameters((strmatch(<span class="string">'RCOF'</span>,parameters)),:),<span class="string">'RCOF'</span>,<span class="string">''</span>));
0496                         info.A1RS = str2num(regexprep(parameters((strmatch(<span class="string">'A1RS'</span>,parameters)),:),<span class="string">'A1RS'</span>,<span class="string">''</span>));
0497                         info.RCTC = str2num(regexprep(parameters((strmatch(<span class="string">'RCTC'</span>,parameters)),:),<span class="string">'RCTC'</span>,<span class="string">''</span>));
0498                         <span class="comment">% mwBridge</span>
0499                         info.AcqFineTuning = strtrim(regexprep(parameters((strmatch(<span class="string">'AcqFineTuning'</span>,parameters)),:),<span class="string">'AcqFineTuning'</span>,<span class="string">''</span>));
0500                         <span class="comment">% fieldCtrl</span>
0501                         <span class="comment">%            info.SweepWidth = parameters((strmatch('SweepWidth',parameters)),:);</span>
0502                         <span class="comment">%            info.SweepWidth_fieldCtrl = strtrim(regexprep((info.SweepWidth(1,:)),'SweepWidth',''));</span>
0503                         <span class="comment">%            info.SweepWidth_ramp2 = strtrim(regexprep((info.SweepWidth(2,:)),'SweepWidth',''));</span>
0504                         clear info.SweepWidth
0505                         info.Delay = strtrim(regexprep(parameters((strmatch(<span class="string">'Delay'</span>,parameters,<span class="string">'exact'</span>)),:),<span class="string">'Delay'</span>,<span class="string">''</span>));
0506                         info.ReplaceMode = strtrim(regexprep(parameters((strmatch(<span class="string">'ReplaceMode'</span>,parameters)),:),<span class="string">'ReplaceMode'</span>,<span class="string">''</span>));
0507                         <span class="comment">% signalChannel</span>
0508                         info.AFCTrap = strtrim(regexprep(parameters((strmatch(<span class="string">'AFCTrap'</span>,parameters)),:),<span class="string">'AFCTrap'</span>,<span class="string">''</span>));
0509                         info.Calibrated = strtrim(regexprep(parameters((strmatch(<span class="string">'Calibrated'</span>,parameters)),:),<span class="string">'Calibrated'</span>,<span class="string">''</span>));
0510                         info.ConvTime = strtrim(regexprep(parameters((strmatch(<span class="string">'ConvTime'</span>,parameters)),:),<span class="string">'ConvTime'</span>,<span class="string">''</span>));
0511                         info.DModAFCTrap = strtrim(regexprep(parameters((strmatch(<span class="string">'DModAFCTrap'</span>,parameters)),:),<span class="string">'DModAFCTrap'</span>,<span class="string">''</span>));
0512                         info.DModAmp = strtrim(regexprep(parameters((strmatch(<span class="string">'DModAmp'</span>,parameters)),:),<span class="string">'DModAmp'</span>,<span class="string">''</span>));
0513                         info.DModCalibrated = strtrim(regexprep(parameters((strmatch(<span class="string">'DModCalibrated'</span>,parameters)),:),<span class="string">'DModCalibrated'</span>,<span class="string">''</span>));
0514                         info.DModDetectSCT = strtrim(regexprep(parameters((strmatch(<span class="string">'DModDetectSCT'</span>,parameters)),:),<span class="string">'DModDetectSCT'</span>,<span class="string">''</span>));
0515                         info.DModEliDelay = strtrim(regexprep(parameters((strmatch(<span class="string">'DModEliDelay'</span>,parameters)),:),<span class="string">'DModEliDelay'</span>,<span class="string">''</span>));
0516                         info.DModExtLockIn = strtrim(regexprep(parameters((strmatch(<span class="string">'DModExtLockIn'</span>,parameters)),:),<span class="string">'DModExtLockIn'</span>,<span class="string">''</span>));
0517                         info.DModExtTrigger = strtrim(regexprep(parameters((strmatch(<span class="string">'DModExtTrigger'</span>,parameters)),:),<span class="string">'DModExtTrigger'</span>,<span class="string">''</span>));
0518                         info.DModFieldMod = strtrim(regexprep(parameters((strmatch(<span class="string">'DModFieldMod'</span>,parameters)),:),<span class="string">'DModFieldMod'</span>,<span class="string">''</span>));
0519                         info.DModGain = strtrim(regexprep(parameters((strmatch(<span class="string">'DModGain'</span>,parameters)),:),<span class="string">'DModGain'</span>,<span class="string">''</span>));
0520                         info.DModHighPass = strtrim(regexprep(parameters((strmatch(<span class="string">'DModHighPass'</span>,parameters)),:),<span class="string">'DModHighPass'</span>,<span class="string">''</span>));
0521                         info.DModIntegrator = strtrim(regexprep(parameters((strmatch(<span class="string">'DModIntegrator'</span>,parameters)),:),<span class="string">'DModIntegrator'</span>,<span class="string">''</span>));
0522                         info.DModModOutput = strtrim(regexprep(parameters((strmatch(<span class="string">'DModModOutput'</span>,parameters)),:),<span class="string">'DModModOutput'</span>,<span class="string">''</span>));
0523                         info.DModSignalInput = strtrim(regexprep(parameters((strmatch(<span class="string">'DModSignalInput'</span>,parameters)),:),<span class="string">'DModSignalInput'</span>,<span class="string">''</span>));
0524                         info.DModTimeConst = strtrim(regexprep(parameters((strmatch(<span class="string">'DModTimeConst'</span>,parameters)),:),<span class="string">'DModTimeConst'</span>,<span class="string">''</span>));
0525                         info.DoubleModFreq = strtrim(regexprep(parameters((strmatch(<span class="string">'DoubleModFreq'</span>,parameters)),:),<span class="string">'DoubleModFreq'</span>,<span class="string">''</span>));
0526                         info.DoubleModPhase = strtrim(regexprep(parameters((strmatch(<span class="string">'DoubleModPhase'</span>,parameters)),:),<span class="string">'DoubleModPhase'</span>,<span class="string">''</span>));
0527                         info.DoubleMode = strtrim(regexprep(parameters((strmatch(<span class="string">'DoubleMode'</span>,parameters)),:),<span class="string">'DoubleMode'</span>,<span class="string">''</span>));
0528                         info.EliDelay = strtrim(regexprep(parameters((strmatch(<span class="string">'EliDelay'</span>,parameters)),:),<span class="string">'EliDelay'</span>,<span class="string">''</span>));
0529                         info.ExtLockIn = strtrim(regexprep(parameters((strmatch(<span class="string">'ExtLockIn'</span>,parameters)),:),<span class="string">'ExtLockIn'</span>,<span class="string">''</span>));
0530                         info.ExtTrigger = strtrim(regexprep(parameters((strmatch(<span class="string">'ExtTrigger'</span>,parameters)),:),<span class="string">'ExtTrigger'</span>,<span class="string">''</span>));
0531                         info.Gain = strtrim(regexprep(parameters((strmatch(<span class="string">'Gain'</span>,parameters)),:),<span class="string">'Gain'</span>,<span class="string">''</span>));
0532                         info.Harmonic = str2num(regexprep(parameters((strmatch(<span class="string">'Harmonic'</span>,parameters)),:),<span class="string">'Harmonic'</span>,<span class="string">''</span>));
0533                         info.HighPass = strtrim(regexprep(parameters((strmatch(<span class="string">'HighPass'</span>,parameters)),:),<span class="string">'HighPass'</span>,<span class="string">''</span>));
0534                         info.Integrator = strtrim(regexprep(parameters((strmatch(<span class="string">'Integrator'</span>,parameters)),:),<span class="string">'Integrator'</span>,<span class="string">''</span>));
0535                         info.ModAmp = strtrim(regexprep(parameters((strmatch(<span class="string">'ModAmp'</span>,parameters)),:),<span class="string">'ModAmp'</span>,<span class="string">''</span>));
0536                         info.ModFreq = strtrim(regexprep(parameters((strmatch(<span class="string">'ModFreq'</span>,parameters)),:),<span class="string">'ModFreq'</span>,<span class="string">''</span>));
0537                         info.ModInput = strtrim(regexprep(parameters((strmatch(<span class="string">'ModInput'</span>,parameters)),:),<span class="string">'ModInput'</span>,<span class="string">''</span>));
0538                         info.ModOutput = strtrim(regexprep(parameters((strmatch(<span class="string">'ModOutput'</span>,parameters)),:),<span class="string">'ModOutput'</span>,<span class="string">''</span>));
0539                         info.ModPhase = str2num(regexprep(parameters((strmatch(<span class="string">'ModPhase'</span>,parameters)),:),<span class="string">'ModPhase'</span>,<span class="string">''</span>));
0540                         info.Offset = strtrim(regexprep(parameters((strmatch(<span class="string">'Offset'</span>,parameters)),:),<span class="string">'Offset'</span>,<span class="string">''</span>));
0541                         info.QuadMode = strtrim(regexprep(parameters((strmatch(<span class="string">'QuadMode'</span>,parameters)),:),<span class="string">'QuadMode'</span>,<span class="string">''</span>));
0542                         info.QuadPhase = str2num(regexprep(parameters((strmatch(<span class="string">'QuadPhase'</span>,parameters)),:),<span class="string">'QuadPhase'</span>,<span class="string">''</span>));
0543                         info.Resolution = str2num(regexprep(parameters((strmatch(<span class="string">'Resolution'</span>,parameters)),:),<span class="string">'Resolution'</span>,<span class="string">''</span>));
0544                         info.Resonator = str2num(regexprep(parameters((strmatch(<span class="string">'Resonator'</span>,parameters)),:),<span class="string">'Resonator'</span>,<span class="string">''</span>));
0545                         info.SctNorm = strtrim(regexprep(parameters((strmatch(<span class="string">'SctNorm'</span>,parameters)),:),<span class="string">'SctNorm'</span>,<span class="string">''</span>));
0546                         info.SctRevision = strtrim(regexprep(parameters((strmatch(<span class="string">'SctRevision'</span>,parameters)),:),<span class="string">'SctRevision'</span>,<span class="string">''</span>));
0547                         info.SignalInput = strtrim(regexprep(parameters((strmatch(<span class="string">'SignalInput'</span>,parameters)),:),<span class="string">'SignalInput'</span>,<span class="string">''</span>));
0548                         info.SweepTime = strtrim(regexprep(parameters((strmatch(<span class="string">'SweepTime'</span>,parameters)),:),<span class="string">'SweepTime'</span>,<span class="string">''</span>));
0549                         info.TimeConst = strtrim(regexprep(parameters((strmatch(<span class="string">'TimeConst'</span>,parameters)),:),<span class="string">'TimeConst'</span>,<span class="string">''</span>));
0550                         info.TuneCaps = str2num(regexprep(parameters((strmatch(<span class="string">'TuneCaps'</span>,parameters)),:),<span class="string">'TuneCaps'</span>,<span class="string">''</span>));
0551                 <span class="keyword">end</span>
0552         <span class="keyword">end</span>
0553         
0554         varargout{1} = x;
0555         varargout{2} = y;
0556         varargout{3} = info;
0557     <span class="keyword">otherwise</span>
0558         varargout{1} = x;
0559         varargout{2} = y;
0560 <span class="keyword">end</span>
0561 
0562 <span class="comment">%                         Figure plotting</span>
0563 <span class="comment">% ========================================================================</span>
0564 
0565 <span class="comment">% Check if figure plotting is selected</span>
0566 <span class="keyword">if</span> isequal(graph,<span class="string">'plot'</span>)
0567     figure(<span class="string">'name'</span> , [<span class="string">'BrukerRead: '</span> name], <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>);
0568     
0569     <span class="comment">% PULSE EXPERIMENTS</span>
0570     <span class="keyword">switch</span> info.EXPT
0571         <span class="keyword">case</span> <span class="string">'PLS'</span>
0572             <span class="keyword">switch</span> info.XNAM
0573                     <span class="comment">% For FSEs</span>
0574                 <span class="keyword">case</span> <span class="string">'''Field'''</span>
0575                     plot(x/10,y.real,<span class="string">'k-'</span> , x/10,y.imag,<span class="string">'r-'</span>);
0576                     xlabel(<span class="string">'Magnetic Field / mT'</span>);
0577                     
0578                     <span class="comment">% For FIDs</span>
0579                 <span class="keyword">case</span> <span class="string">'''Time'''</span>
0580                     plot(x,y.real,<span class="string">'k-'</span> , x,y.imag,<span class="string">'r-'</span>);
0581                     xlabel(<span class="string">'Time / ns'</span>);
0582                     
0583                 <span class="comment">% case '''Frequency'''</span>
0584                     <span class="comment">% PLACEHOLDER</span>
0585                     
0586                     <span class="comment">% Try plotting for other experiments (ie ENDOR)</span>
0587                 <span class="keyword">otherwise</span>
0588                     <span class="keyword">try</span>
0589                         plot(x,y.real,<span class="string">'k-'</span> , x,y.imag,<span class="string">'r-'</span>);
0590                     <span class="keyword">end</span>
0591             <span class="keyword">end</span>
0592             
0593             legend(<span class="string">'Real'</span>,<span class="string">'Imaginary'</span>)
0594             
0595     <span class="comment">% CW EXPERIMENTS</span>
0596         <span class="keyword">case</span> <span class="string">'CW'</span>
0597             plot(x/10,y);
0598             xlabel(<span class="string">'Magnetic Field / mT'</span>);
0599     <span class="keyword">end</span>
0600     
0601     <span class="comment">% Figure formatting</span>
0602     ylabel(<span class="string">'Intensity'</span>);
0603     set(gcf,<span class="string">'color'</span>, <span class="string">'white'</span>);
0604     axis tight;
0605     
0606 <span class="keyword">end</span>
0607 
0608 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 25-Oct-2012 18:03:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>