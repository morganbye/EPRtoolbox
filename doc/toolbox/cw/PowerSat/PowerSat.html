<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of PowerSat</title>
  <meta name="keywords" content="PowerSat">
  <meta name="description" content="POWERSAT Open, analyse and plot power saturation experiments">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">toolbox</a> &gt; <a href="../index.html">cw</a> &gt; <a href="index.html">PowerSat</a> &gt; PowerSat.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for toolbox/cw/PowerSat&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>PowerSat
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>POWERSAT Open, analyse and plot power saturation experiments</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function varargout = PowerSat(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> POWERSAT Open, analyse and plot power saturation experiments
      POWERSAT, is designed as a complete solution for power saturation
      experiments. Taking raw spectra straight from the spectrometer and
      turning them into Power Saturation curves and accessibility
      parameters (Pi values) in seconds.

      POWERSAT, loads Bruker BES3T files either as a single file (actually
      3 files with the extensions .DTA / .DSC / .YGF extensions) or an
      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or
      the older Bruker format still used on EMX machines (.spc/.par). If a
      folder load method is used then each of the oxygen, nitrogen, NiEDDA
      and DPPH experiments data files need to be in a different folders.

      REFERENCES:
      ===========

      This calculations in this program are all derived from:
       Accessibility of Nitroxide Side Chains: Absolute Heisenberg
       Exchange Rates from Power Saturation EPR
       Biophysical Journal, vol 89 (2005) 2103 - 2112.
       DOI: 10.1529/biophysj.105.059063

      Equations for first and second derivative Gaussian and Lorentzian
       functions are taken from:
       http://www.hulinks.co.jp/software/peakfit/functions.html

      RELEASE NOTES:
      ==============

      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the
      fitting of the Gaussian or Lorentzian profiles to raw data as well
      as fitting power saturation curves. This is due to the CFtoolbox
      giving greater control and flexibility to fitting.

      POWERSAT v12.6 and before instead used the freely
      available toolbox EzyFit.
       www.fast.u-psud.fr/ezyfit/

      This method was discontinued as the EzyFit toolbox allows for no
      restriction of coefficient ranges during fitting. This often meant
      that during the fitting of the power saturation curves that a
      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;
      usually in the shape of a diagonal line with a loop in the middle.
      This problem whilst promised to be fixed in an upcoming release of
      Ezyfit (in personal correspondance with the author) has been
      outstanding for over a year.

      If users, do not wish to use the CFtoolbox then it is recommended to
      install a version of POWERSAT prior to v12.7, still available at:
      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download

      A demonstration videos are available on YouTube:
       Basic functionality - http://youtu.be/n8wWRzHoF-8
       Fitting options     - http://youtu.be/DstC7ysrYG0


 Syntax:  PowerSat

 Inputs:
    input1 - n/a

 Outputs:
    output1 - n/a

 Example: 
    see http://morganbye.net/PowerSat
        http://youtu.be/n8wWRzHoF-8
        http://youtu.be/DstC7ysrYG0

 Other m-files required:
    PowerSat.fig
    Curve Fitting Toolbox - fit, fittype, coeffvalues
    BrukerRead

 Subfunctions:         /_private (folder)

 MAT-files required:   none</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function edit_SDs_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function edit_SDs_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function menu_file_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function menu_open_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function menu_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function menu_close_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function menu_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function help_about_Callback(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = PowerSat(varargin)</a>
0002 <span class="comment">% POWERSAT Open, analyse and plot power saturation experiments</span>
0003 <span class="comment">%      POWERSAT, is designed as a complete solution for power saturation</span>
0004 <span class="comment">%      experiments. Taking raw spectra straight from the spectrometer and</span>
0005 <span class="comment">%      turning them into Power Saturation curves and accessibility</span>
0006 <span class="comment">%      parameters (Pi values) in seconds.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%      POWERSAT, loads Bruker BES3T files either as a single file (actually</span>
0009 <span class="comment">%      3 files with the extensions .DTA / .DSC / .YGF extensions) or an</span>
0010 <span class="comment">%      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or</span>
0011 <span class="comment">%      the older Bruker format still used on EMX machines (.spc/.par). If a</span>
0012 <span class="comment">%      folder load method is used then each of the oxygen, nitrogen, NiEDDA</span>
0013 <span class="comment">%      and DPPH experiments data files need to be in a different folders.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%      REFERENCES:</span>
0016 <span class="comment">%      ===========</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%      This calculations in this program are all derived from:</span>
0019 <span class="comment">%       Accessibility of Nitroxide Side Chains: Absolute Heisenberg</span>
0020 <span class="comment">%       Exchange Rates from Power Saturation EPR</span>
0021 <span class="comment">%       Biophysical Journal, vol 89 (2005) 2103 - 2112.</span>
0022 <span class="comment">%       DOI: 10.1529/biophysj.105.059063</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%      Equations for first and second derivative Gaussian and Lorentzian</span>
0025 <span class="comment">%       functions are taken from:</span>
0026 <span class="comment">%       http://www.hulinks.co.jp/software/peakfit/functions.html</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%      RELEASE NOTES:</span>
0029 <span class="comment">%      ==============</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the</span>
0032 <span class="comment">%      fitting of the Gaussian or Lorentzian profiles to raw data as well</span>
0033 <span class="comment">%      as fitting power saturation curves. This is due to the CFtoolbox</span>
0034 <span class="comment">%      giving greater control and flexibility to fitting.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%      POWERSAT v12.6 and before instead used the freely</span>
0037 <span class="comment">%      available toolbox EzyFit.</span>
0038 <span class="comment">%       www.fast.u-psud.fr/ezyfit/</span>
0039 <span class="comment">%</span>
0040 <span class="comment">%      This method was discontinued as the EzyFit toolbox allows for no</span>
0041 <span class="comment">%      restriction of coefficient ranges during fitting. This often meant</span>
0042 <span class="comment">%      that during the fitting of the power saturation curves that a</span>
0043 <span class="comment">%      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;</span>
0044 <span class="comment">%      usually in the shape of a diagonal line with a loop in the middle.</span>
0045 <span class="comment">%      This problem whilst promised to be fixed in an upcoming release of</span>
0046 <span class="comment">%      Ezyfit (in personal correspondance with the author) has been</span>
0047 <span class="comment">%      outstanding for over a year.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">%      If users, do not wish to use the CFtoolbox then it is recommended to</span>
0050 <span class="comment">%      install a version of POWERSAT prior to v12.7, still available at:</span>
0051 <span class="comment">%      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download</span>
0052 <span class="comment">%</span>
0053 <span class="comment">%      A demonstration videos are available on YouTube:</span>
0054 <span class="comment">%       Basic functionality - http://youtu.be/n8wWRzHoF-8</span>
0055 <span class="comment">%       Fitting options     - http://youtu.be/DstC7ysrYG0</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% Syntax:  PowerSat</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% Inputs:</span>
0061 <span class="comment">%    input1 - n/a</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Outputs:</span>
0064 <span class="comment">%    output1 - n/a</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% Example:</span>
0067 <span class="comment">%    see http://morganbye.net/PowerSat</span>
0068 <span class="comment">%        http://youtu.be/n8wWRzHoF-8</span>
0069 <span class="comment">%        http://youtu.be/DstC7ysrYG0</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% Other m-files required:</span>
0072 <span class="comment">%    PowerSat.fig</span>
0073 <span class="comment">%    Curve Fitting Toolbox - fit, fittype, coeffvalues</span>
0074 <span class="comment">%    BrukerRead</span>
0075 <span class="comment">%</span>
0076 <span class="comment">% Subfunctions:         /_private (folder)</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% MAT-files required:   none</span>
0079 <span class="comment">%</span>
0080 <span class="comment">%</span>
0081 
0082 <span class="comment">%                                        _                             _</span>
0083 <span class="comment">%                                       | |                           | |</span>
0084 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0085 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0086 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0087 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0088 <span class="comment">%                       __/ |                   __/ |</span>
0089 <span class="comment">%                      |___/                   |___/</span>
0090 <span class="comment">%</span>
0091 <span class="comment">%</span>
0092 <span class="comment">% M. Bye v12.8</span>
0093 <span class="comment">%</span>
0094 <span class="comment">% Author:       Morgan Bye</span>
0095 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0096 <span class="comment">%               University of East Anglia</span>
0097 <span class="comment">%               NORWICH, UK</span>
0098 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0099 <span class="comment">% Website:      http://www.morganbye.net/PowerSat</span>
0100 <span class="comment">% Aug 2012;     Last revision: 15-August-2012</span>
0101 <span class="comment">%</span>
0102 <span class="comment">% Version history:</span>
0103 <span class="comment">% Aug 12        &gt; New Gaussian and Lorentzian derivative fitting methods</span>
0104 <span class="comment">%</span>
0105 <span class="comment">%               &gt; Change from Gaussian tickbox to a fitting dropdown menu</span>
0106 <span class="comment">%                   for Lorentzian fitting</span>
0107 <span class="comment">%</span>
0108 <span class="comment">% Jun 12        Another big overhaul of the PowerSat function</span>
0109 <span class="comment">%               &gt; New menu system</span>
0110 <span class="comment">%               &gt; Better loading and handling of files</span>
0111 <span class="comment">%               &gt; Bruker .DTA and .spc support</span>
0112 <span class="comment">%               &gt; Support for loading a folder of files, not just a 3D</span>
0113 <span class="comment">%                   Bruker BE3ST file (.DTA/.DSC/.YGF)</span>
0114 <span class="comment">%               &gt; EzyFit toolbox has been replaced with the MATLAB Curve</span>
0115 <span class="comment">%                   Fitting Toolbox for better fitting control</span>
0116 <span class="comment">%               &gt; Peak finding is now done via a Gaussian curve fit to the</span>
0117 <span class="comment">%                   data (this can be toggled in the Dataset Manipulation</span>
0118 <span class="comment">%                   panel - which replaces the digital smoothing function</span>
0119 <span class="comment">%                   used previously)</span>
0120 <span class="comment">%               &gt; Ability to save and later load a session without having</span>
0121 <span class="comment">%               to reload all the spectra files.</span>
0122 <span class="comment">%               &gt; Export the PowerSat curve data to the MATLAB workspace</span>
0123 <span class="comment">%</span>
0124 <span class="comment">% Oct 11        &gt; Massive overhaul of function into a &quot;modular&quot; form.</span>
0125 <span class="comment">%               Giving large speed increase, better maintaince and</span>
0126 <span class="comment">%               documentation.</span>
0127 <span class="comment">%               &gt; Removed ~ (tilde) variables from program, although it</span>
0128 <span class="comment">%               should work in all MATLAB (and does on Linux) it causes</span>
0129 <span class="comment">%               problems for Windows users.</span>
0130 <span class="comment">%               &gt; GUI objects moved, for better visualisation on Windows</span>
0131 <span class="comment">%</span>
0132 <span class="comment">% Sept 11       &gt; Removed need for external files by adding additional</span>
0133 <span class="comment">%               functions to end of file (except BrukerRead)</span>
0134 <span class="comment">%               &gt; Loaded spectra are autozeroed when displayed in Datasets</span>
0135 <span class="comment">%               window</span>
0136 <span class="comment">%               &gt; Datasets scrollbar only appears when individual plots are</span>
0137 <span class="comment">%               displayed</span>
0138 <span class="comment">%               &gt; &quot;Show all plots&quot; tick boxes removed and replaced by a</span>
0139 <span class="comment">%               view dropdown menu</span>
0140 <span class="comment">%               &gt; Plotting code stream lined and now with better error</span>
0141 <span class="comment">%               catching</span>
0142 <span class="comment">%               &gt; Digital smoothing feature of loaded spectra, useful for</span>
0143 <span class="comment">%               noisy spectra, but should be used carefully</span>
0144 <span class="comment">%               &gt; DPPH file load option, allows for &quot;Pi&quot; accessbility</span>
0145 <span class="comment">%               factor to be calculated</span>
0146 <span class="comment">%               &gt; Error bars added to Power Saturation curve data points,</span>
0147 <span class="comment">%               calculated by a standard deviation of the noise.</span>
0148 
0149 <span class="comment">% Last Modified by GUIDE v2.5 06-Aug-2012 15:46:18</span>
0150 
0151 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0152 gui_Singleton = 0;
0153 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0154                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0155                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)">PowerSat_OpeningFcn</a>, <span class="keyword">...</span>
0156                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = PowerSat_OutputFcn(hObject, eventdata, handles)">PowerSat_OutputFcn</a>, <span class="keyword">...</span>
0157                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0158                    <span class="string">'gui_Callback'</span>,   []);
0159 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0160     gui_State.gui_Callback = str2func(varargin{1});
0161 <span class="keyword">end</span>
0162 
0163 <span class="keyword">if</span> nargout
0164     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0165 <span class="keyword">else</span>
0166     gui_mainfcn(gui_State, varargin{:});
0167 <span class="keyword">end</span>
0168 <span class="comment">% End initialization code - DO NOT EDIT</span>
0169 
0170 
0171 <span class="comment">% --- Executes just before PowerSat is made visible.</span>
0172 <a name="_sub1" href="#_subfunctions" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0173 
0174 clear <span class="keyword">global</span>
0175 
0176 <span class="comment">% Check fitting program exists</span>
0177 <span class="keyword">if</span> exist(<span class="string">'cftool'</span>) == 0,
0178         warndlg(sprintf(<span class="string">'The Curve Fitting Toolbox could not be found on your system.\n\nWithout it this program will show very little functionality as the P1/2s cannot be calculated and no Gaussian fitting can be used\n\n'</span>),<span class="string">'Curve Fitting Toolbox missing'</span>)
0179  
0180 <span class="keyword">end</span>
0181  
0182 
0183 <span class="comment">% Choose default command line statusbar for PowerSat</span>
0184 handles.statusbar = hObject;
0185 
0186 <span class="comment">% Name the window</span>
0187 set(gcf,<span class="string">'Name'</span>,<span class="string">'PowerSat - v12.8'</span>);
0188 
0189 <span class="comment">% Update handles structure</span>
0190 <span class="comment">% set(hObject,'toolbar','figure');</span>
0191 set(handles.panel_Plot,<span class="string">'SelectionChangeFcn'</span>,@<a href="#_sub3" class="code" title="subfunction panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)">panel_Plot_SelectionChangeFcn</a>);
0192 
0193 axes(handles.plot_load);
0194 xlabel(<span class="string">'Magnetic Field / Gauss'</span>);
0195 ylabel(<span class="string">'Intensity'</span>);
0196 
0197 axes(handles.plot_PS);
0198 xlabel(<span class="string">'\surd Microwave Power / mW^Â½'</span>);
0199 ylabel(<span class="string">'Y'' / arb. units'</span>);
0200 
0201 set(handles.slider1,<span class="string">'Value'</span>,1);
0202 set(handles.slider1,<span class="string">'Min'</span>,1);
0203 set(handles.slider1,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0204 
0205 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0206 
0207 guidata(hObject, handles);
0208 
0209 <span class="comment">% UIWAIT makes PowerSat wait for user response (see UIRESUME)</span>
0210 <span class="comment">% uiwait(handles.figure1);</span>
0211 
0212 
0213 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0214 <a name="_sub2" href="#_subfunctions" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles) </a>
0215 
0216 varargout{1} = handles.statusbar;
0217 
0218 
0219 <span class="comment">%          ===================================================</span>
0220 <span class="comment">%          ===================================================</span>
0221 <span class="comment">%                     Dataset Manipulation Panel</span>
0222 <span class="comment">%          ===================================================</span>
0223 <span class="comment">%          ===================================================</span>
0224 
0225 
0226 <span class="comment">% ===================================================</span>
0227 <span class="comment">% Radio Buttons</span>
0228 <span class="comment">% ===================================================</span>
0229 
0230 <span class="comment">% --- Radio buttons in Plot Selection</span>
0231 <a name="_sub3" href="#_subfunctions" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a>
0232 
0233 handles = guidata(hObject); 
0234 
0235 set(handles.slider1,<span class="string">'Value'</span>,1);
0236 PS_Plot1(handles)
0237 
0238 guidata(hObject, handles);
0239 
0240 <span class="comment">% ===================================================</span>
0241 <span class="comment">% User input (text fields)</span>
0242 <span class="comment">% ===================================================</span>
0243 
0244 <span class="comment">% Oxygen</span>
0245 <span class="comment">% ===================================================</span>
0246 
0247 <a name="_sub4" href="#_subfunctions" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a>
0248 
0249 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)     <span class="comment">% Select Oxy</span>
0250 
0251 input = str2num(get(hObject,<span class="string">'String'</span>));     <span class="comment">% Convert input to number</span>
0252 
0253 <span class="keyword">if</span> (isempty(input))                         <span class="comment">% If empty then catch</span>
0254      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0255 <span class="keyword">else</span>
0256     <span class="keyword">global</span> vars
0257     vars.Oxy.MaxPeak = input;
0258 <span class="keyword">end</span>
0259 
0260 PS_Plot1(handles)                           <span class="comment">% Replot with new values</span>
0261 PS_PlotPS(handles);
0262 
0263 guidata(hObject, handles);
0264 
0265 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0266 <a name="_sub5" href="#_subfunctions" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a>
0267 
0268 
0269 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0270 <span class="comment">%       See ISPC and COMPUTER.</span>
0271 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0272     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0273 <span class="keyword">end</span>
0274 
0275 
0276 
0277 <a name="_sub6" href="#_subfunctions" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a>
0278 
0279 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)
0280 
0281 input = str2num(get(hObject,<span class="string">'String'</span>));
0282 
0283 <span class="keyword">if</span> (isempty(input))
0284      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0285 <span class="keyword">else</span>
0286     <span class="keyword">global</span> vars
0287     vars.Oxy.MinPeak = input;
0288 <span class="keyword">end</span>
0289 
0290 PS_Plot1(handles)
0291 PS_PlotPS(handles);
0292 
0293 guidata(hObject, handles);
0294 
0295 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0296 <a name="_sub7" href="#_subfunctions" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a>
0297 
0298 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0299 <span class="comment">%       See ISPC and COMPUTER.</span>
0300 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0301     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0302 <span class="keyword">end</span>
0303 
0304 
0305 <span class="comment">% Nitrogen</span>
0306 <span class="comment">% ===================================================</span>
0307 
0308 <a name="_sub8" href="#_subfunctions" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a>
0309 
0310 <span class="keyword">global</span> vars
0311 vars.N2.MaxPeak = str2num(get(hObject,<span class="string">'String'</span>));
0312 
0313 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0314 
0315 input = str2num(get(hObject,<span class="string">'String'</span>));
0316 
0317 <span class="keyword">if</span> (isempty(input))
0318      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0319 <span class="keyword">else</span>
0320     <span class="keyword">global</span> vars
0321     vars.N2.MaxPeak = input;
0322 <span class="keyword">end</span>
0323 
0324 PS_Plot1(handles)
0325 PS_PlotPS(handles);
0326 
0327 guidata(hObject, handles);
0328 
0329 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0330 <a name="_sub9" href="#_subfunctions" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a>
0331 
0332 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0333     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0334 <span class="keyword">end</span>
0335 
0336 
0337 
0338 <a name="_sub10" href="#_subfunctions" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a>
0339 
0340 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0341 
0342 input = str2num(get(hObject,<span class="string">'String'</span>));
0343 
0344 <span class="keyword">if</span> (isempty(input))
0345      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0346 <span class="keyword">else</span>
0347     <span class="keyword">global</span> vars
0348     vars.N2.MinPeak = input;
0349 <span class="keyword">end</span>
0350 
0351 PS_Plot1(handles)
0352 PS_PlotPS(handles);
0353 
0354 guidata(hObject, handles);
0355 
0356 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0357 <a name="_sub11" href="#_subfunctions" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a>
0358 
0359 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0360     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0361 <span class="keyword">end</span>
0362 
0363 
0364 <span class="comment">% NiEDDA</span>
0365 <span class="comment">% ===================================================</span>
0366 
0367 <a name="_sub12" href="#_subfunctions" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a>
0368 
0369 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0370 
0371 input = str2num(get(hObject,<span class="string">'String'</span>));
0372 
0373 <span class="keyword">if</span> (isempty(input))
0374      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0375 <span class="keyword">else</span>
0376     <span class="keyword">global</span> vars
0377     vars.Ni.MaxPeak = input;
0378 <span class="keyword">end</span>
0379 
0380 PS_Plot1(handles)
0381 PS_PlotPS(handles);
0382 
0383 guidata(hObject, handles);
0384 
0385 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0386 <a name="_sub13" href="#_subfunctions" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a>
0387 
0388 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0389     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0390 <span class="keyword">end</span>
0391 
0392 
0393 
0394 <a name="_sub14" href="#_subfunctions" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a>
0395 
0396 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0397 
0398 input = str2num(get(hObject,<span class="string">'String'</span>));
0399 
0400 <span class="keyword">if</span> (isempty(input))
0401      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0402 <span class="keyword">else</span>
0403     <span class="keyword">global</span> vars
0404     vars.Ni.MinPeak = input;
0405 <span class="keyword">end</span>
0406 
0407 PS_Plot1(handles)
0408 PS_PlotPS(handles);
0409 
0410 guidata(hObject, handles);
0411 
0412 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0413 <a name="_sub15" href="#_subfunctions" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a>
0414 
0415 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0416     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0417 <span class="keyword">end</span>
0418 
0419 
0420 
0421 <span class="comment">% DPPH</span>
0422 <span class="comment">% ===================================================</span>
0423 
0424 <a name="_sub16" href="#_subfunctions" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a>
0425 
0426 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0427 
0428 input = str2num(get(hObject,<span class="string">'String'</span>));
0429 
0430 <span class="keyword">if</span> (isempty(input))
0431      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0432 <span class="keyword">else</span>
0433     <span class="keyword">global</span> vars
0434     vars.DPPH.MaxPeak = input;
0435 <span class="keyword">end</span>
0436 
0437 PS_Plot1(handles)
0438 PS_PlotPS(handles);
0439 
0440 guidata(hObject, handles);
0441 
0442 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0443 <a name="_sub17" href="#_subfunctions" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a>
0444 
0445 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0446     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0447 <span class="keyword">end</span>
0448 
0449 
0450 
0451 <a name="_sub18" href="#_subfunctions" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a>
0452 
0453 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0454 
0455 input = str2num(get(hObject,<span class="string">'String'</span>));
0456 
0457 <span class="keyword">if</span> (isempty(input))
0458      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0459 <span class="keyword">else</span>
0460     <span class="keyword">global</span> vars
0461     vars.DPPH.MinPeak = input;
0462 <span class="keyword">end</span>
0463 
0464 PS_Plot1(handles)
0465 PS_PlotPS(handles);
0466 
0467 guidata(hObject, handles);
0468 
0469 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0470 <a name="_sub19" href="#_subfunctions" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a>
0471 
0472 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0473     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0474 <span class="keyword">end</span>
0475 
0476 
0477 <span class="comment">%          ===================================================</span>
0478 <span class="comment">%          ===================================================</span>
0479 <span class="comment">%                          Spectra Panel</span>
0480 <span class="comment">%          ===================================================</span>
0481 <span class="comment">%          ===================================================</span>
0482 
0483 
0484 <span class="comment">% --- Executes on Slider movement.</span>
0485 <a name="_sub20" href="#_subfunctions" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a>
0486 
0487 PS_Plot1(handles)
0488 
0489 
0490 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0491 <a name="_sub21" href="#_subfunctions" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a>
0492 
0493 <span class="keyword">if</span> isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0494     set(hObject,<span class="string">'BackgroundColor'</span>,[.9 .9 .9]);
0495 <span class="keyword">end</span>
0496 
0497 
0498 <span class="comment">%          ===================================================</span>
0499 <span class="comment">%          ===================================================</span>
0500 <span class="comment">%                        PS Curves Panel</span>
0501 <span class="comment">%          ===================================================</span>
0502 <span class="comment">%          ===================================================</span>
0503 
0504 
0505 
0506 <span class="comment">%          ===================================================</span>
0507 <span class="comment">%          ===================================================</span>
0508 <span class="comment">%                     Dataset Manipulation Panel</span>
0509 <span class="comment">%          ===================================================</span>
0510 <span class="comment">%          ===================================================</span>
0511 
0512 <span class="comment">% --- Executes on button press in checkbox_autozero.</span>
0513 <a name="_sub22" href="#_subfunctions" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a>
0514 
0515 PS_Plot1(handles);
0516 PS_PlotPS(handles);
0517 
0518 
0519 
0520 <span class="comment">% --- Executes on selection change in dropdown_fitting.</span>
0521 <a name="_sub23" href="#_subfunctions" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a>
0522 
0523 PS_Plot1(handles);
0524 PS_PlotPS(handles);
0525 
0526 
0527 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0528 <a name="_sub24" href="#_subfunctions" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a>
0529 
0530 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0531     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0532 <span class="keyword">end</span>
0533 
0534 
0535 <a name="_sub25" href="#_subfunctions" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a>
0536 
0537 PS_Plot1(handles);
0538 PS_PlotPS(handles);
0539 
0540 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0541 <a name="_sub26" href="#_subfunctions" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a>
0542 
0543 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0544     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0545 <span class="keyword">end</span>
0546 
0547 
0548 <span class="comment">%          ===================================================</span>
0549 <span class="comment">%          ===================================================</span>
0550 <span class="comment">%                        Viewing options panel</span>
0551 <span class="comment">%          ===================================================</span>
0552 <span class="comment">%          ===================================================</span>
0553 
0554 <a name="_sub27" href="#_subfunctions" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a>
0555 
0556 PS_Plot1(handles);
0557 
0558 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0559 <a name="_sub28" href="#_subfunctions" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a>
0560 
0561 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0562     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0563 <span class="keyword">end</span>
0564 
0565 
0566 <span class="comment">% --- Executes on selection change in dropdown_view.</span>
0567 <a name="_sub29" href="#_subfunctions" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a>
0568 
0569 PS_Plot1(handles);
0570 
0571 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0572 <a name="_sub30" href="#_subfunctions" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a>
0573 
0574 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0575     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0576 <span class="keyword">end</span>
0577 
0578 
0579 <span class="comment">%          ===================================================</span>
0580 <span class="comment">%          ===================================================</span>
0581 <span class="comment">%                        PS Options Panel</span>
0582 <span class="comment">%          ===================================================</span>
0583 <span class="comment">%          ===================================================</span>
0584 
0585 <span class="comment">% --- Executes on button press in checkbox_PSfits.</span>
0586 <a name="_sub31" href="#_subfunctions" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a>
0587 
0588 <span class="keyword">if</span> exist(<span class="string">'ezfit'</span>) == 2
0589     PS_PlotPS(handles);
0590 <span class="keyword">else</span>
0591     warndlg(<span class="string">'The EzyFit toolbox is not installed, without it the data cannot be fitted'</span>,<span class="string">'Fitting Error'</span>);
0592 <span class="keyword">end</span>
0593 
0594 <span class="comment">% --- Executes on button press in checkbox_errorbars.</span>
0595 <a name="_sub32" href="#_subfunctions" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a>
0596 
0597 PS_PlotPS(handles);
0598 
0599 
0600 <a name="_sub33" href="#_subfunctions" class="code">function edit_SDs_Callback(hObject, eventdata, handles)</a>
0601 
0602 <span class="keyword">if</span> isempty(get(handles.edit_SDs,<span class="string">'String'</span>))
0603      set(hObject,<span class="string">'String'</span>,<span class="string">'1'</span>);
0604      set(handles.checkbox_errorbars,<span class="string">'Value'</span>,0);
0605 <span class="keyword">end</span>
0606 
0607 PS_PlotPS(handles);
0608 
0609 
0610 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0611 <a name="_sub34" href="#_subfunctions" class="code">function edit_SDs_CreateFcn(hObject, eventdata, handles)</a>
0612 
0613 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0614     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0615 <span class="keyword">end</span>
0616 
0617 
0618 <span class="comment">%          ===================================================</span>
0619 <span class="comment">%          ===================================================</span>
0620 <span class="comment">%                             PS Data Panel</span>
0621 <span class="comment">%          ===================================================</span>
0622 <span class="comment">%          ===================================================</span>
0623 
0624 <span class="comment">% Oxygen</span>
0625 <span class="comment">% ===================================================</span>
0626 
0627 <a name="_sub35" href="#_subfunctions" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a>
0628 
0629 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0630 <a name="_sub36" href="#_subfunctions" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a>
0631 
0632 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0633     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0634 <span class="keyword">end</span>
0635 
0636 
0637 
0638 <a name="_sub37" href="#_subfunctions" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a>
0639 
0640 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0641 <a name="_sub38" href="#_subfunctions" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a>
0642 
0643 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0644     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0645 <span class="keyword">end</span>
0646 
0647 
0648 <a name="_sub39" href="#_subfunctions" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a>
0649 
0650 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0651 <a name="_sub40" href="#_subfunctions" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a>
0652 
0653 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0654     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0655 <span class="keyword">end</span>
0656 
0657 
0658 
0659 <a name="_sub41" href="#_subfunctions" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a>
0660 
0661 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0662 <a name="_sub42" href="#_subfunctions" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a>
0663 
0664 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0665     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0666 <span class="keyword">end</span>
0667 
0668 
0669 <span class="comment">% Nitrogen</span>
0670 <span class="comment">% ===================================================</span>
0671 
0672 <a name="_sub43" href="#_subfunctions" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a>
0673 
0674 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0675 <a name="_sub44" href="#_subfunctions" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a>
0676 
0677 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0678     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0679 <span class="keyword">end</span>
0680 
0681 
0682 
0683 <a name="_sub45" href="#_subfunctions" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a>
0684 
0685 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0686 <a name="_sub46" href="#_subfunctions" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a>
0687 
0688 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0689     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0690 <span class="keyword">end</span>
0691 
0692 
0693 
0694 <a name="_sub47" href="#_subfunctions" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a>
0695 
0696 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0697 <a name="_sub48" href="#_subfunctions" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a>
0698 
0699 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0700     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0701 <span class="keyword">end</span>
0702 
0703 
0704 
0705 <a name="_sub49" href="#_subfunctions" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a>
0706 
0707 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0708 <a name="_sub50" href="#_subfunctions" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a>
0709 
0710 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0711     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0712 <span class="keyword">end</span>
0713 
0714 
0715 <span class="comment">% NiEDDA</span>
0716 <span class="comment">% ===================================================</span>
0717 
0718 <a name="_sub51" href="#_subfunctions" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a>
0719 
0720 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0721 <a name="_sub52" href="#_subfunctions" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a>
0722 
0723 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0724     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0725 <span class="keyword">end</span>
0726 
0727 
0728 
0729 <a name="_sub53" href="#_subfunctions" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a>
0730 
0731 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0732 <a name="_sub54" href="#_subfunctions" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a>
0733 
0734 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0735     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0736 <span class="keyword">end</span>
0737 
0738 
0739 
0740 <a name="_sub55" href="#_subfunctions" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a>
0741 
0742 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0743 <a name="_sub56" href="#_subfunctions" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a>
0744 
0745 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0746     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0747 <span class="keyword">end</span>
0748 
0749 
0750 
0751 <a name="_sub57" href="#_subfunctions" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a>
0752 
0753 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0754 <a name="_sub58" href="#_subfunctions" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a>
0755 
0756 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0757     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0758 <span class="keyword">end</span>
0759 
0760 
0761 <span class="comment">%          ===================================================</span>
0762 <span class="comment">%          ===================================================</span>
0763 <span class="comment">%                     Accessibility Panel</span>
0764 <span class="comment">%          ===================================================</span>
0765 <span class="comment">%          ===================================================</span>
0766 
0767 
0768 <a name="_sub59" href="#_subfunctions" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a>
0769 
0770 <a name="_sub60" href="#_subfunctions" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a>
0771 
0772 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0773     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0774 <span class="keyword">end</span>
0775 
0776 
0777 
0778 <a name="_sub61" href="#_subfunctions" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a>
0779 
0780 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0781 <a name="_sub62" href="#_subfunctions" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a>
0782 
0783 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0784     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0785 <span class="keyword">end</span>
0786 
0787 
0788 
0789 <a name="_sub63" href="#_subfunctions" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a>
0790 
0791 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0792 <a name="_sub64" href="#_subfunctions" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a>
0793 
0794 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0795     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0796 <span class="keyword">end</span>
0797 
0798 
0799 
0800 <span class="comment">%          ===================================================</span>
0801 <span class="comment">%          ===================================================</span>
0802 <span class="comment">%                                Menu</span>
0803 <span class="comment">%          ===================================================</span>
0804 <span class="comment">%          ===================================================</span>
0805 
0806 
0807 <span class="comment">% File</span>
0808 <span class="comment">% ===================================================</span>
0809 
0810 <span class="comment">% --------------------------------------------------------------------</span>
0811 <a name="_sub65" href="#_subfunctions" class="code">function menu_file_Callback(hObject, eventdata, handles)</a>
0812 
0813 <span class="comment">% --------------------------------------------------------------------</span>
0814 <a name="_sub66" href="#_subfunctions" class="code">function menu_open_Callback(hObject, eventdata, handles)</a>
0815 
0816 <span class="keyword">global</span> vars
0817 
0818 <span class="comment">% GUI get file</span>
0819 [file , directory] = uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="string">'Load PowerSat file'</span>);
0820 address = [directory,file];
0821 
0822 <span class="comment">% Load variable</span>
0823 load(address , <span class="string">'vars'</span>);
0824 
0825 <span class="comment">% Update plots</span>
0826 PS_Plot1(handles);
0827 
0828 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
0829     set(handles.button_DPPHSelect ,<span class="string">'Value'</span>,1)
0830     set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
0831     set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
0832 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Ni'</span>)
0833     set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
0834     set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
0835     set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
0836 <span class="keyword">elseif</span> isfield(vars,<span class="string">'N2'</span>)
0837     set(handles.button_N2Select ,<span class="string">'Value'</span>,1)
0838     set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
0839     set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
0840 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Oxy'</span>)
0841     set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
0842     set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0843     set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0844 <span class="keyword">else</span>
0845     <span class="keyword">return</span>
0846 <span class="keyword">end</span>
0847 
0848 PS_PlotPS(handles);
0849 
0850 
0851 
0852 
0853 <span class="comment">% --------------------------------------------------------------------</span>
0854 <a name="_sub67" href="#_subfunctions" class="code">function menu_save_Callback(hObject, eventdata, handles)</a>
0855 
0856 <span class="keyword">global</span> vars
0857 
0858 [file, pathname] = uiputfile({ <span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0859         <span class="string">'Save PowerSat as'</span>,<span class="string">'default'</span>);
0860     
0861 address = [pathname file];
0862 
0863 save(address,<span class="string">'vars'</span>);
0864 
0865 
0866 <span class="comment">% --------------------------------------------------------------------</span>
0867 <a name="_sub68" href="#_subfunctions" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a>
0868 
0869 closeGUI = handles.figure1;                     <span class="comment">% handles.figure1 is the GUI figure</span>
0870  
0871 guiPosition = get(handles.figure1,<span class="string">'Position'</span>);  <span class="comment">% get the position of the GUI</span>
0872 guiName = get(handles.figure1,<span class="string">'Name'</span>);          <span class="comment">% get the name of the GUI</span>
0873 eval(<span class="string">'PowerSat'</span>)                                <span class="comment">% call the GUI again</span>
0874  
0875 close(closeGUI);                                <span class="comment">% close the old GUI</span>
0876 set(gcf,<span class="string">'Position'</span>,guiPosition);                <span class="comment">% set the position for the new GUI</span>
0877 
0878 clear <span class="keyword">global</span>
0879 
0880 <span class="comment">% --------------------------------------------------------------------</span>
0881 <a name="_sub69" href="#_subfunctions" class="code">function menu_close_Callback(hObject, eventdata, handles)</a>
0882 
0883 figure1_CloseRequestFcn
0884 
0885 
0886 
0887 <span class="comment">% Datasets</span>
0888 <span class="comment">% ===================================================</span>
0889 
0890 <span class="comment">% --------------------------------------------------------------------</span>
0891 <a name="_sub70" href="#_subfunctions" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a>
0892 
0893 
0894 <span class="comment">% --------------------------------------------------------------------</span>
0895 <a name="_sub71" href="#_subfunctions" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a>
0896 
0897 
0898 <span class="comment">% --------------------------------------------------------------------</span>
0899 <a name="_sub72" href="#_subfunctions" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a>
0900 
0901 clear <span class="keyword">global</span> vars.Oxy
0902 
0903 <span class="comment">% Set defaults</span>
0904 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1);
0905 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0906 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0907 
0908 <span class="comment">% Load and plot file</span>
0909 PS_FileLoad(<span class="string">'Oxy'</span>,<span class="string">'file'</span>);
0910 PS_Plot1(handles);
0911 
0912 <span class="comment">% Update data boxes in GUI</span>
0913 <span class="keyword">global</span> vars
0914 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0915 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0916 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0917 
0918 PS_PlotPS(handles);
0919 
0920 guidata(hObject, handles);
0921 
0922 
0923 <span class="comment">% --------------------------------------------------------------------</span>
0924 <a name="_sub73" href="#_subfunctions" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a>
0925 
0926 clear <span class="keyword">global</span> vars.Oxy
0927 
0928 <span class="comment">% Set defaults</span>
0929 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
0930 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0931 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0932 
0933 <span class="comment">% Load and plot file</span>
0934 PS_FileLoad(<span class="string">'Oxy'</span>,<span class="string">'folder'</span>);
0935 PS_Plot1(handles);
0936 
0937 <span class="comment">% Update data boxes in GUI</span>
0938 <span class="keyword">global</span> vars
0939 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0940 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0941 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0942 
0943 PS_PlotPS(handles);
0944 
0945 guidata(hObject, handles);
0946 
0947 
0948 <span class="comment">% --------------------------------------------------------------------</span>
0949 <a name="_sub74" href="#_subfunctions" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a>
0950 
0951 
0952 <span class="comment">% --------------------------------------------------------------------</span>
0953 <a name="_sub75" href="#_subfunctions" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a>
0954 
0955 clear <span class="keyword">global</span> N2
0956 
0957 <span class="comment">% Set defaults</span>
0958 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
0959 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0960 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0961 
0962 <span class="comment">% Load and plot file</span>
0963 PS_FileLoad(<span class="string">'N2'</span>,<span class="string">'file'</span>);
0964 PS_Plot1(handles);
0965 
0966 <span class="comment">% Update data boxes in GUI</span>
0967 <span class="keyword">global</span> vars
0968 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0969 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
0970 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
0971 
0972 PS_PlotPS(handles);
0973 
0974 guidata(hObject, handles);
0975 
0976 <span class="comment">% --------------------------------------------------------------------</span>
0977 <a name="_sub76" href="#_subfunctions" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a>
0978 
0979 clear <span class="keyword">global</span> N2
0980 
0981 <span class="comment">% Set defaults</span>
0982 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
0983 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0984 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0985 
0986 <span class="comment">% Load and plot file</span>
0987 PS_FileLoad(<span class="string">'N2'</span>,<span class="string">'folder'</span>);
0988 PS_Plot1(handles);
0989 
0990 <span class="comment">% Update data boxes in GUI</span>
0991 <span class="keyword">global</span> vars
0992 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0993 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
0994 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
0995 
0996 PS_PlotPS(handles);
0997 
0998 guidata(hObject, handles);
0999 
1000 <span class="comment">% --------------------------------------------------------------------</span>
1001 <a name="_sub77" href="#_subfunctions" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a>
1002 
1003 <span class="comment">% --------------------------------------------------------------------</span>
1004 <a name="_sub78" href="#_subfunctions" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a>
1005 
1006 clear <span class="keyword">global</span> Ni
1007 
1008 <span class="comment">% Set defaults</span>
1009 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1010 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1011 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1012 
1013 <span class="comment">% Load and plot file</span>
1014 PS_FileLoad(<span class="string">'Ni'</span>,<span class="string">'file'</span>);
1015 PS_Plot1(handles);
1016 
1017 <span class="comment">% Update data boxes in GUI</span>
1018 <span class="keyword">global</span> vars
1019 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1020 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1021 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1022 
1023 PS_PlotPS(handles);
1024 
1025 guidata(hObject, handles);
1026 
1027 <span class="comment">% --------------------------------------------------------------------</span>
1028 <a name="_sub79" href="#_subfunctions" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a>
1029 
1030 clear <span class="keyword">global</span> Ni
1031 
1032 <span class="comment">% Set defaults</span>
1033 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1034 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1035 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1036 
1037 <span class="comment">% Load and plot file</span>
1038 PS_FileLoad(<span class="string">'Ni'</span>,<span class="string">'folder'</span>);
1039 PS_Plot1(handles);
1040 
1041 <span class="comment">% Update data boxes in GUI</span>
1042 <span class="keyword">global</span> vars
1043 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1044 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1045 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1046 
1047 PS_PlotPS(handles);
1048 
1049 guidata(hObject, handles);
1050 
1051 <span class="comment">% --------------------------------------------------------------------</span>
1052 <a name="_sub80" href="#_subfunctions" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a>
1053 
1054 <span class="comment">% --------------------------------------------------------------------</span>
1055 <a name="_sub81" href="#_subfunctions" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a>
1056 
1057 clear <span class="keyword">global</span> DPPH
1058 
1059 <span class="comment">% Set defaults</span>
1060 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1061 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1062 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1063 
1064 <span class="comment">% Load and plot file</span>
1065 PS_FileLoad(<span class="string">'DPPH'</span>,<span class="string">'file'</span>);
1066 PS_Plot1(handles);
1067 
1068 <span class="comment">% Update data boxes in GUI</span>
1069 <span class="keyword">global</span> vars
1070 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1071 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1072 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1073 
1074 PS_PlotPS(handles);
1075 
1076 guidata(hObject, handles);
1077 
1078 
1079 <span class="comment">% --------------------------------------------------------------------</span>
1080 <a name="_sub82" href="#_subfunctions" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a>
1081 
1082 clear <span class="keyword">global</span> DPPH
1083 
1084 <span class="comment">% Set defaults</span>
1085 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1086 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1087 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1088 
1089 <span class="comment">% Load and plot file</span>
1090 PS_FileLoad(<span class="string">'DPPH'</span>,<span class="string">'folder'</span>);
1091 PS_Plot1(handles);
1092 
1093 <span class="comment">% Update data boxes in GUI</span>
1094 <span class="keyword">global</span> vars
1095 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1096 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1097 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1098 
1099 PS_PlotPS(handles);
1100 
1101 guidata(hObject, handles);
1102 
1103 
1104 <span class="comment">% Spectra</span>
1105 <span class="comment">% ===================================================</span>
1106 
1107 <span class="comment">% --------------------------------------------------------------------</span>
1108 <a name="_sub83" href="#_subfunctions" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a>
1109 
1110 
1111 <span class="comment">% --------------------------------------------------------------------</span>
1112 <a name="_sub84" href="#_subfunctions" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a>
1113 
1114 cla(handles.plot_load,<span class="string">'reset'</span>);
1115 guidata(hObject, handles);
1116 
1117 
1118 <span class="comment">% --------------------------------------------------------------------</span>
1119 <a name="_sub85" href="#_subfunctions" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a>
1120 
1121 <span class="keyword">global</span> vars
1122 
1123 <span class="comment">% if get(handles.checkbox_Gauss,'Value')</span>
1124 <span class="comment">%     if isfield(vars,'DPPH')</span>
1125 <span class="comment">%         PS_Plot1_Gaussian(handles,'DPPH')</span>
1126 <span class="comment">%     end</span>
1127 <span class="comment">%     if isfield(vars,'Ni')</span>
1128 <span class="comment">%         PS_Plot1_Gaussian(handles,'Ni')</span>
1129 <span class="comment">%     end</span>
1130 <span class="comment">%     if isfield(vars,'N2')</span>
1131 <span class="comment">%         PS_Plot1_Gaussian(handles,'N2')</span>
1132 <span class="comment">%     end</span>
1133 <span class="comment">%     if isfield(vars,'Oxy')</span>
1134 <span class="comment">%         PS_Plot1_Gaussian(handles,'Oxy')</span>
1135 <span class="comment">%     end</span>
1136 <span class="comment">% end</span>
1137 
1138 PS_Plot1(handles);
1139 PS_PlotPS(handles);
1140 
1141 
1142 <span class="comment">% --------------------------------------------------------------------</span>
1143 <a name="_sub86" href="#_subfunctions" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a>
1144 
1145 PS_DetachPlot(handles.plot_load);
1146 
1147 
1148 <span class="comment">% --------------------------------------------------------------------</span>
1149 <a name="_sub87" href="#_subfunctions" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a>
1150 
1151 PS_SavePlot(handles.plot_load);
1152 
1153 
1154 
1155 <span class="comment">% PowerSat</span>
1156 <span class="comment">% ===================================================</span>
1157 
1158 <span class="comment">% --------------------------------------------------------------------</span>
1159 <a name="_sub88" href="#_subfunctions" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a>
1160 
1161 <span class="comment">% --------------------------------------------------------------------</span>
1162 <a name="_sub89" href="#_subfunctions" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a>
1163 
1164 <span class="keyword">global</span> vars
1165 
1166 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
1167     out.Y           = vars.DPPH.Y;
1168     out.sqrtPower   = vars.DPPH.sqrtPower;
1169     out.FitResults  = vars.DPPH.FitResults;
1170     
1171     assignin(<span class="string">'base'</span>,<span class="string">'DPPH'</span>,out)
1172 <span class="keyword">end</span>
1173 <span class="keyword">if</span> isfield(vars,<span class="string">'Ni'</span>)
1174     out.Y           = vars.Ni.Y;
1175     out.sqrtPower   = vars.Ni.sqrtPower;
1176     out.FitResults  = vars.Ni.FitResults;
1177     
1178     assignin(<span class="string">'base'</span>,<span class="string">'Ni'</span>,out)
1179 <span class="keyword">end</span>
1180 <span class="keyword">if</span> isfield(vars,<span class="string">'N2'</span>)
1181     out.Y           = vars.N2.Y;
1182     out.sqrtPower   = vars.N2.sqrtPower;
1183     out.FitResults  = vars.N2.FitResults;
1184     
1185     assignin(<span class="string">'base'</span>,<span class="string">'N2'</span>,out)
1186 <span class="keyword">end</span>
1187 <span class="keyword">if</span> isfield(vars,<span class="string">'Oxy'</span>)
1188     out.Y           = vars.Oxy.Y;
1189     out.sqrtPower   = vars.Oxy.sqrtPower;
1190     out.FitResults  = vars.Oxy.FitResults;
1191     
1192     assignin(<span class="string">'base'</span>,<span class="string">'Oxy'</span>,out)
1193 <span class="keyword">end</span>
1194 
1195 
1196 
1197 <span class="comment">% --------------------------------------------------------------------</span>
1198 <a name="_sub90" href="#_subfunctions" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a>
1199 
1200 PS_PlotPS(handles);
1201 
1202 
1203 <span class="comment">% --------------------------------------------------------------------</span>
1204 <a name="_sub91" href="#_subfunctions" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a>
1205 
1206 PS_DetachPlot(handles.plot_PS);
1207 
1208 <span class="comment">% --------------------------------------------------------------------</span>
1209 <a name="_sub92" href="#_subfunctions" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a>
1210 
1211 PS_SavePlot(handles.plot_PS);
1212 
1213 
1214 <span class="comment">% --------------------------------------------------------------------</span>
1215 <a name="_sub93" href="#_subfunctions" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a>
1216 
1217 cla(handles.plot_PS,<span class="string">'reset'</span>);
1218 guidata(hObject, handles);
1219 
1220 <span class="comment">% Help</span>
1221 <span class="comment">% ===================================================</span>
1222 
1223 <span class="comment">% --------------------------------------------------------------------</span>
1224 <a name="_sub94" href="#_subfunctions" class="code">function menu_help_Callback(hObject, eventdata, handles)</a>
1225 
1226 
1227 <span class="comment">% --------------------------------------------------------------------</span>
1228 <a name="_sub95" href="#_subfunctions" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a>
1229 
1230 PS_Help_Help;
1231 
1232 
1233 <span class="comment">% --------------------------------------------------------------------</span>
1234 <a name="_sub96" href="#_subfunctions" class="code">function help_about_Callback(hObject, eventdata, handles)</a>
1235 
1236 PS_Help_About;</pre></div>
<hr><address>Generated on Thu 25-Oct-2012 18:03:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>