<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of cwViewer</title>
  <meta name="keywords" content="cwViewer">
  <meta name="description" content="CWVIEWER Open, analyse and plot cw-EPR experiments.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">toolbox</a> &gt; <a href="../index.html">cw</a> &gt; <a href="index.html">cwViewer</a> &gt; cwViewer.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for toolbox/cw/cwViewer&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>cwViewer
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>CWVIEWER Open, analyse and plot cw-EPR experiments.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function varargout = cwViewer(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> CWVIEWER Open, analyse and plot cw-EPR experiments.
      CWVIEWER, is designed as a complete solution for viewing standard 
      cwEPR experiments, quickly and simply.

       CWVIEWER also provides basic data manipulation tools to quickly
       tidy up spectra. Spectra can then be exported as:
           &gt; Bruker files (*.DTA / *.DSC)
           &gt; Comma seperated value files (*.csv files)
               for ease of use with spreadsheet programs such as MS
               Excel/OpenOffice Calc and graphing programs such as
               Origin/Qtiplot)
           &gt; Image files (*.png / *.eps / *jpg)

      CWVIEWER, provides support for:
           &gt; Bruker BE3ST files (.DTA / .DSC)
                   - .YGF when accessory files are in the same folder)
           &gt; Older Bruker files (.spc / .par)  - UNTESTED
           &gt; FSC2 files                        - LIMITED FUNCTIONALITY
           &gt; Jeol files (*.ESR)                - UNTESTED

   A demonstration video is available on YouTube
       http://youtu.be/SNjlbl-3ZsU

 Syntax:  cwViewer

 Inputs:
    input1     - n/a

 Outputs:
    output1    - n/a

 Example: 
    see http://morganbye.net/eprtoolbox/cwviewer
        http://youtu.be/SNjlbl-3ZsU

 Other m-files required:   BrukerRead
                           BrukerWrite
                           JeolRead
                           Fsc2Read

 Subfunctions:             cv_plot
                           file_details
                           viewing_options
                           data_man

 MAT-files required:       none

 To-do list:               &gt; Full support of Jeol and Fsc2 files
                           &gt; Tidy up image export
                           &gt; DEER traces show up but real and imaginary
                           channels need to be on seperate Y-axes
                           &gt; Export feature for multi-dimension datasets
                           needs to be written


 See also: CWNORM CWPLOT CWZERO PEAKFINDER</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>	CV_PLOT Plotting function for cwViewer</li><li><a href="data_man.html" class="code" title="function varargout = data_man(varargin)">data_man</a>	FILE_DETAILS The data manipulation window for cwViewer</li><li><a href="easyfitting.html" class="code" title="function varargout = easyfitting(varargin)">easyfitting</a>	EASYFITTING The send to EasySpin window for cwViewer</li><li><a href="file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>	FILE_DETAILS The file details window for cwViewer</li><li><a href="viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>	VIEWING_OPTIONS The Viewing Options window for cwViewer</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = cwViewer_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function viewer_blank</a></li><li><a href="#_sub4" class="code">function slider_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function slider_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menu_File_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menu_File_Open_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menu_File_Bruker_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menu_File_Bruker_folder_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menu_File_Jeol_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menu_File_Fsc2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menu_File_Save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menu_File_Export_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menu_File_Export_Dataset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menu_File_Export_toWorkspace_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menu_File_Export_Image_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menu_File_Exit_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menu_Window_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menu_Window_File_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menu_Window_View_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menu_Window_DataMan_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menu_Window_EasyFitting_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menu_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menu_help_about_Callback(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = cwViewer(varargin)</a>
0002 
0003 <span class="comment">% CWVIEWER Open, analyse and plot cw-EPR experiments.</span>
0004 <span class="comment">%      CWVIEWER, is designed as a complete solution for viewing standard</span>
0005 <span class="comment">%      cwEPR experiments, quickly and simply.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%       CWVIEWER also provides basic data manipulation tools to quickly</span>
0008 <span class="comment">%       tidy up spectra. Spectra can then be exported as:</span>
0009 <span class="comment">%           &gt; Bruker files (*.DTA / *.DSC)</span>
0010 <span class="comment">%           &gt; Comma seperated value files (*.csv files)</span>
0011 <span class="comment">%               for ease of use with spreadsheet programs such as MS</span>
0012 <span class="comment">%               Excel/OpenOffice Calc and graphing programs such as</span>
0013 <span class="comment">%               Origin/Qtiplot)</span>
0014 <span class="comment">%           &gt; Image files (*.png / *.eps / *jpg)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%      CWVIEWER, provides support for:</span>
0017 <span class="comment">%           &gt; Bruker BE3ST files (.DTA / .DSC)</span>
0018 <span class="comment">%                   - .YGF when accessory files are in the same folder)</span>
0019 <span class="comment">%           &gt; Older Bruker files (.spc / .par)  - UNTESTED</span>
0020 <span class="comment">%           &gt; FSC2 files                        - LIMITED FUNCTIONALITY</span>
0021 <span class="comment">%           &gt; Jeol files (*.ESR)                - UNTESTED</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   A demonstration video is available on YouTube</span>
0024 <span class="comment">%       http://youtu.be/SNjlbl-3ZsU</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Syntax:  cwViewer</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% Inputs:</span>
0029 <span class="comment">%    input1     - n/a</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% Outputs:</span>
0032 <span class="comment">%    output1    - n/a</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% Example:</span>
0035 <span class="comment">%    see http://morganbye.net/eprtoolbox/cwviewer</span>
0036 <span class="comment">%        http://youtu.be/SNjlbl-3ZsU</span>
0037 <span class="comment">%</span>
0038 <span class="comment">% Other m-files required:   BrukerRead</span>
0039 <span class="comment">%                           BrukerWrite</span>
0040 <span class="comment">%                           JeolRead</span>
0041 <span class="comment">%                           Fsc2Read</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% Subfunctions:             cv_plot</span>
0044 <span class="comment">%                           file_details</span>
0045 <span class="comment">%                           viewing_options</span>
0046 <span class="comment">%                           data_man</span>
0047 <span class="comment">%</span>
0048 <span class="comment">% MAT-files required:       none</span>
0049 <span class="comment">%</span>
0050 <span class="comment">% To-do list:               &gt; Full support of Jeol and Fsc2 files</span>
0051 <span class="comment">%                           &gt; Tidy up image export</span>
0052 <span class="comment">%                           &gt; DEER traces show up but real and imaginary</span>
0053 <span class="comment">%                           channels need to be on seperate Y-axes</span>
0054 <span class="comment">%                           &gt; Export feature for multi-dimension datasets</span>
0055 <span class="comment">%                           needs to be written</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% See also: CWNORM CWPLOT CWZERO PEAKFINDER</span>
0059 
0060 <span class="comment">%                           oooooo     oooo   o8o</span>
0061 <span class="comment">%                            `888.     .8'    `&quot;'</span>
0062 <span class="comment">%  .ooooo.  oooo oooo    ooo   `888.   .8'   oooo   .ooooo.  oooo oooo    ooo  .ooooo.  oooo d8b</span>
0063 <span class="comment">% d88' `&quot;Y8  `88. `88.  .8'     `888. .8'    `888  d88' `88b  `88. `88.  .8'  d88' `88b `888&quot;&quot;8P</span>
0064 <span class="comment">% 888         `88..]88..8'       `888.8'      888  888ooo888   `88..]88..8'   888ooo888  888</span>
0065 <span class="comment">% 888   .o8    `888'`888'         `888'       888  888    .o    `888'`888'    888    .o  888</span>
0066 <span class="comment">% `Y8bod8P'     `8'  `8'           `8'       o888o `Y8bod8P'     `8'  `8'     `Y8bod8P' d888b</span>
0067 <span class="comment">%</span>
0068 
0069 <span class="comment">%                                        _                             _</span>
0070 <span class="comment">%                                       | |                           | |</span>
0071 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0072 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0073 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0074 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0075 <span class="comment">%                       __/ |                   __/ |</span>
0076 <span class="comment">%                      |___/                   |___/</span>
0077 <span class="comment">%</span>
0078 <span class="comment">%</span>
0079 <span class="comment">% M. Bye v12.7</span>
0080 <span class="comment">%</span>
0081 <span class="comment">% Author:       Morgan Bye</span>
0082 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0083 <span class="comment">%               University of East Anglia</span>
0084 <span class="comment">%               NORWICH, UK</span>
0085 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0086 <span class="comment">% Website:      http://www.morganbye.net/eprtoolbox/cwviewer</span>
0087 <span class="comment">% Jun 2012;     Last revision: 12-June-2012</span>
0088 <span class="comment">%</span>
0089 <span class="comment">% Approximate coding time of file:</span>
0090 <span class="comment">%               21 hours</span>
0091 <span class="comment">%</span>
0092 <span class="comment">%</span>
0093 <span class="comment">% Version history:</span>
0094 <span class="comment">% Jul 12        &gt; Export of datasets to the MATLAB workspace not just to a</span>
0095 <span class="comment">%                   file. Useful for EasySpin. File &gt; Export &gt; to Workspace</span>
0096 <span class="comment">%</span>
0097 <span class="comment">% Jun 12        &gt; Savitzky-Golay smoothing implemented</span>
0098 <span class="comment">%               &gt; Update of export dataset to include g-values</span>
0099 <span class="comment">%               &gt; Adding of &quot;Noise&quot; to Data manipulation</span>
0100 <span class="comment">%               &gt; g-value x-axis scale now available in Viewing options</span>
0101 <span class="comment">%</span>
0102 <span class="comment">% May 12        Initial release (open beta)</span>
0103 <span class="comment">%</span>
0104 <span class="comment">% Feb 12        First alpha</span>
0105 
0106 <span class="comment">% Last Modified by GUIDE v2.5 19-Jun-2012 17:25:49</span>
0107 
0108 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0109 gui_Singleton = 1;
0110 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0111                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0112                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)">cwViewer_OpeningFcn</a>, <span class="keyword">...</span>
0113                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = cwViewer_OutputFcn(hObject, eventdata, handles)">cwViewer_OutputFcn</a>, <span class="keyword">...</span>
0114                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0115                    <span class="string">'gui_Callback'</span>,   []);
0116 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0117     gui_State.gui_Callback = str2func(varargin{1});
0118 <span class="keyword">end</span>
0119 
0120 <span class="keyword">if</span> nargout
0121     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0122 <span class="keyword">else</span>
0123     warning off all
0124     gui_mainfcn(gui_State, varargin{:});
0125     warning on all
0126 <span class="keyword">end</span>
0127 <span class="comment">% End initialization code - DO NOT EDIT</span>
0128 
0129 
0130 <span class="comment">% --- Executes just before viewer is made visible.</span>
0131 <a name="_sub1" href="#_subfunctions" class="code">function cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0132 <span class="comment">% This function has no output args, see OutputFcn.</span>
0133 <span class="comment">% hObject    handle to figure</span>
0134 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0135 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0136 <span class="comment">% varargin   command line arguments to viewer (see VARARGIN)</span>
0137 
0138 <span class="comment">% Choose default command line output for viewer</span>
0139 handles.output = hObject;
0140 
0141 <span class="comment">% Update handles structure</span>
0142 guidata(hObject, handles);
0143 
0144 <span class="comment">% Name the window</span>
0145 set(gcf,<span class="string">'Name'</span>,<span class="string">'cwViewer - v12.7'</span>);
0146 
0147 <span class="comment">%Hand.cwViewer = handles;</span>
0148 
0149 <span class="comment">% Setup the global variables</span>
0150 setappdata(0, <span class="string">'cwview'</span>, gcf);
0151 
0152 cwview = getappdata(0, <span class="string">'cwview'</span>);
0153 
0154 <span class="comment">% Setup slider</span>
0155 Var.Slider.Min      = 1;
0156 Var.Slider.Max      = 1;
0157 Var.Slider.Value    = 1;
0158 Var.Slider.Visible  = <span class="string">'off'</span>;
0159 
0160 set(handles.slider , <span class="string">'Min'</span>    , Var.Slider.Min);
0161 set(handles.slider , <span class="string">'Max'</span>    , Var.Slider.Max);
0162 set(handles.slider , <span class="string">'Value'</span>  , Var.Slider.Value);
0163 set(handles.slider , <span class="string">'Visible'</span>, Var.Slider.Visible);
0164 
0165 setappdata(cwview, <span class="string">'Var'</span> , Var);
0166 setappdata(cwview,<span class="string">'hcwView'</span>,handles);
0167 
0168 
0169 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0170 <a name="_sub2" href="#_subfunctions" class="code">function varargout = cwViewer_OutputFcn(hObject, eventdata, handles) </a>
0171 
0172 varargout{1} = handles.output;
0173 
0174 cwview = getappdata(0, <span class="string">'cwview'</span>);
0175 set(gcf, <span class="string">'Units'</span> , <span class="string">'pixels'</span>);
0176 
0177 viewer_size =  get(gcf,<span class="string">'OuterPosition'</span>);
0178 screen      =  get(0,<span class="string">'ScreenSize'</span>);
0179 
0180 set(cwview, <span class="string">'OuterPosition'</span>, [325, <span class="keyword">...</span>
0181     (screen(4) - 5) , <span class="keyword">...</span>
0182     (viewer_size(3)),<span class="keyword">...</span>
0183     (viewer_size(4))]);
0184 
0185 setappdata(cwview,<span class="string">'screen'</span>,screen);
0186 setappdata(cwview,<span class="string">'size_viewer'</span>,viewer_size);
0187 setappdata(cwview,<span class="string">'logo'</span>, 1);
0188 setappdata(cwview,<span class="string">'data'</span>, <span class="string">''</span>);
0189 
0190 <a href="#_sub3" class="code" title="subfunction viewer_blank">viewer_blank</a>
0191 
0192 <span class="comment">% Call startup windows</span>
0193 <span class="comment">% ====================</span>
0194 
0195 <span class="comment">% Get handle of cwViewer and save it</span>
0196 Win = allchild(0);
0197 WindowHandles.cwViewer = Win(1);
0198 WindowVisible.cwViewer = 1;
0199 
0200 <span class="comment">% Open file details</span>
0201 wFile = <a href="file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>;
0202 Win = allchild(0);
0203 WindowHandles.FileDetails = Win(1);
0204 WindowVisible.FileDetails = 1;
0205 
0206 <span class="comment">% Open viewing options</span>
0207 wView = <a href="viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>;
0208 Win = allchild(0);
0209 WindowHandles.ViewingOptions = Win(1);
0210 WindowVisible.ViewingOptions = 1;
0211 
0212 <span class="comment">% Open data manipulation</span>
0213 wDataMan = <a href="data_man.html" class="code" title="function varargout = data_man(varargin)">data_man</a>;
0214 Win = allchild(0);
0215 WindowHandles.DataMan = Win(1);
0216 WindowVisible.DataMan = 1;
0217 
0218 <span class="comment">% Write open windows to cwview</span>
0219 setappdata(cwview,<span class="string">'wFile'</span>  ,wFile);
0220 setappdata(cwview,<span class="string">'wView'</span>  ,wView);
0221 setappdata(cwview,<span class="string">'wMan'</span>   ,wDataMan );
0222 setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0223 setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0224 
0225 
0226 
0227 <a name="_sub3" href="#_subfunctions" class="code">function viewer_blank</a>
0228 
0229 cwview = getappdata(0, <span class="string">'cwview'</span>);
0230 
0231 <span class="keyword">if</span> getappdata(cwview,<span class="string">'logo'</span>) == 1;
0232     set(gcf,<span class="string">'Color'</span>,[0.702 0.702 0.702]);
0233 
0234     <span class="comment">% Insert logos</span>
0235     logo_mb = which(<span class="string">'mb_net.jpg'</span>);
0236     logo_mb = imread(logo_mb);
0237 
0238     image(logo_mb);
0239     axis off
0240     axis image
0241 <span class="keyword">end</span>
0242 
0243 <span class="comment">%  .d8888b.  888 d8b      888</span>
0244 <span class="comment">% d88P  Y88b 888 Y8P      888</span>
0245 <span class="comment">% Y88b.      888          888</span>
0246 <span class="comment">%  &quot;Y888b.   888 888  .d88888  .d88b.  888d888</span>
0247 <span class="comment">%     &quot;Y88b. 888 888 d88&quot; 888 d8P  Y8b 888P&quot;</span>
0248 <span class="comment">%       &quot;888 888 888 888  888 88888888 888</span>
0249 <span class="comment">% Y88b  d88P 888 888 Y88b 888 Y8b.     888</span>
0250 <span class="comment">%  &quot;Y8888P&quot;  888 888  &quot;Y88888  &quot;Y8888  888</span>
0251 <span class="comment">% ============================================</span>
0252 
0253 <span class="comment">% --- Executes on slider movement.</span>
0254 <a name="_sub4" href="#_subfunctions" class="code">function slider_Callback(hObject, eventdata, handles)</a>
0255 
0256 cwview = getappdata(0,<span class="string">'cwview'</span>);
0257 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0258 
0259 Var.Slider.Value = get(hObject,<span class="string">'Value'</span>);
0260 setappdata(cwview, <span class="string">'Var'</span> , Var);
0261 
0262 <a href="cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>;
0263 
0264 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0265 <a name="_sub5" href="#_subfunctions" class="code">function slider_CreateFcn(hObject, eventdata, handles)</a>
0266 <span class="comment">% hObject    handle to slider (see GCBO)</span>
0267 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0268 <span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>
0269 
0270 <span class="comment">% Hint: slider controls usually have a light gray background.</span>
0271 <span class="keyword">if</span> isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0272     set(hObject,<span class="string">'BackgroundColor'</span>,[.9 .9 .9]);
0273 <span class="keyword">end</span>
0274 
0275 
0276 
0277 
0278 
0279 <span class="comment">%  .d8888b.  888                   d8b</span>
0280 <span class="comment">% d88P  Y88b 888                   Y8P</span>
0281 <span class="comment">% 888    888 888</span>
0282 <span class="comment">% 888        888  .d88b.  .d8888b  888 88888b.   .d88b.</span>
0283 <span class="comment">% 888        888 d88&quot;&quot;88b 88K      888 888 &quot;88b d88P&quot;88b</span>
0284 <span class="comment">% 888    888 888 888  888 &quot;Y8888b. 888 888  888 888  888</span>
0285 <span class="comment">% Y88b  d88P 888 Y88..88P      X88 888 888  888 Y88b 888</span>
0286 <span class="comment">%  &quot;Y8888P&quot;  888  &quot;Y88P&quot;   88888P' 888 888  888  &quot;Y88888</span>
0287 <span class="comment">%                                                    888</span>
0288 <span class="comment">%                                               Y8b d88P</span>
0289 <span class="comment">%                                                &quot;Y88P&quot;</span>
0290 <span class="comment">% ======================================================</span>
0291 
0292 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0293 <a name="_sub6" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0294 
0295 cwview = getappdata(0, <span class="string">'cwview'</span>);
0296 
0297 prompt = questdlg(<span class="string">'Are you sure you want to quit?'</span>,<span class="string">'Exit cwViewer'</span>,<span class="keyword">...</span>
0298         <span class="string">'Yes'</span>,<span class="string">'No'</span>,<span class="string">'Yes'</span>);
0299 
0300 <span class="keyword">switch</span> prompt
0301         <span class="keyword">case</span> <span class="string">'Yes'</span>
0302             
0303             Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0304             Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0305             
0306             <span class="keyword">if</span> isfield(Handles,<span class="string">'cwViewer'</span>) 
0307                 delete(Handles.cwViewer);
0308             <span class="keyword">end</span>
0309             
0310             <span class="keyword">if</span> isfield(Handles,<span class="string">'FileDetails'</span>) &amp;&amp; Visible.FileDetails == 1
0311                 delete(Handles.FileDetails);
0312             <span class="keyword">end</span>
0313             
0314             <span class="keyword">if</span> isfield(Handles,<span class="string">'ViewingOptions'</span>) &amp;&amp; Visible.ViewingOptions == 1
0315                 delete(Handles.ViewingOptions);
0316             <span class="keyword">end</span>
0317             
0318             <span class="keyword">if</span> isfield(Handles,<span class="string">'DataMan'</span>) &amp;&amp; Visible.ViewingOptions == 1
0319                 delete(Handles.DataMan);
0320             <span class="keyword">end</span>
0321                         
0322         <span class="keyword">case</span> <span class="string">'No'</span>
0323             
0324             <span class="keyword">return</span>
0325             
0326 <span class="keyword">end</span>
0327 
0328 <span class="comment">% =========================================================================</span>
0329 <span class="comment">% 888b     d888                                 888888b.</span>
0330 <span class="comment">% 8888b   d8888                                 888  &quot;88b</span>
0331 <span class="comment">% 88888b.d88888                                 888  .88P</span>
0332 <span class="comment">% 888Y88888P888  .d88b.  88888b.  888  888      8888888K.   8888b.  888d888</span>
0333 <span class="comment">% 888 Y888P 888 d8P  Y8b 888 &quot;88b 888  888      888  &quot;Y88b     &quot;88b 888P&quot;</span>
0334 <span class="comment">% 888  Y8P  888 88888888 888  888 888  888      888    888 .d888888 888</span>
0335 <span class="comment">% 888   &quot;   888 Y8b.     888  888 Y88b 888      888   d88P 888  888 888</span>
0336 <span class="comment">% 888       888  &quot;Y8888  888  888  &quot;Y88888      8888888P&quot;  &quot;Y888888 888</span>
0337 <span class="comment">% =========================================================================</span>
0338 
0339 <span class="comment">% ===================================================</span>
0340 <span class="comment">% File</span>
0341 <span class="comment">% ===================================================</span>
0342 
0343 <span class="comment">% --------------------------------------------------------------------</span>
0344 <a name="_sub7" href="#_subfunctions" class="code">function menu_File_Callback(hObject, eventdata, handles)</a>
0345 <span class="comment">% hObject    handle to menu_File (see GCBO)</span>
0346 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0347 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0348 
0349 
0350 <span class="comment">% --------------------------------------------------------------------</span>
0351 <a name="_sub8" href="#_subfunctions" class="code">function menu_File_Open_Callback(hObject, eventdata, handles)</a>
0352 <span class="comment">% hObject    handle to menu_File_Open (see GCBO)</span>
0353 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0354 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0355 
0356 cwview = getappdata(0,<span class="string">'cwview'</span>);
0357 data   = getappdata(cwview,<span class="string">'data'</span>);
0358 hFile  = getappdata(cwview,<span class="string">'hFile'</span>);
0359 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0360 
0361 <span class="comment">% GUI get file</span>
0362 [file , directory] = uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="string">'Load cwViewer file'</span>);
0363 address = [directory,file];
0364 
0365 <span class="comment">% Load variable</span>
0366 load(address , <span class="string">'data'</span> , <span class="string">'Var'</span>)
0367 
0368 <span class="comment">% Store variable into cwview</span>
0369 setappdata(cwview,<span class="string">'data'</span> ,data);
0370 setappdata(cwview,<span class="string">'Var'</span>  ,Var);
0371 
0372 fileNum =length(fieldnames(data));
0373 
0374 <span class="comment">% Update the display</span>
0375 info  = data.([<span class="string">'File'</span>  num2str(fileNum)]).info;
0376 
0377 <span class="comment">% Set File(s) list</span>
0378 set(hFile.listbox_files,<span class="string">'String'</span>, Var.files);
0379 <span class="comment">% Set File(s) list so that last entry is selected as active</span>
0380 set(hFile.listbox_files,<span class="string">'Value'</span>, fileNum);
0381 <span class="comment">% Other File details boxes</span>
0382 set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0383 set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0384 set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0385 
0386 <span class="comment">% Update the axes.</span>
0387 <a href="cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>;
0388 
0389 <span class="comment">% 8888888                                         888</span>
0390 <span class="comment">%   888                                           888</span>
0391 <span class="comment">%   888                                           888</span>
0392 <span class="comment">%   888   88888b.d88b.  88888b.   .d88b.  888d888 888888</span>
0393 <span class="comment">%   888   888 &quot;888 &quot;88b 888 &quot;88b d88&quot;&quot;88b 888P&quot;   888</span>
0394 <span class="comment">%   888   888  888  888 888  888 888  888 888     888</span>
0395 <span class="comment">%   888   888  888  888 888 d88P Y88..88P 888     Y88b.</span>
0396 <span class="comment">% 8888888 888  888  888 88888P&quot;   &quot;Y88P&quot;  888      &quot;Y888</span>
0397 <span class="comment">% ===================== 888 ============================</span>
0398 <span class="comment">%                       888</span>
0399 <span class="comment">%                       888</span>
0400 
0401 <span class="comment">% --------------------------------------------------------------------</span>
0402 <a name="_sub9" href="#_subfunctions" class="code">function menu_File_Bruker_Callback(hObject, eventdata, handles)</a>
0403 <span class="comment">% hObject    handle to menu_File_Bruker (see GCBO)</span>
0404 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0405 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0406 
0407 cwview = getappdata(0,<span class="string">'cwview'</span>);
0408 data   = getappdata(cwview,<span class="string">'data'</span>);
0409 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0410 
0411 <span class="comment">% Set file number for file</span>
0412 <span class="keyword">try</span>
0413     fileNum = size(fieldnames(data),1) +1;
0414 <span class="keyword">catch</span>
0415     fileNum = 1;
0416 <span class="keyword">end</span>
0417 
0418 <span class="comment">% Load the file</span>
0419 [x , y , info] = BrukerRead;
0420 
0421 <span class="comment">% Move the file to data structure</span>
0422 data.([<span class="string">'File'</span> mat2str(fileNum)]).x = x;
0423 data.([<span class="string">'File'</span> mat2str(fileNum)]).y = y;
0424 data.([<span class="string">'File'</span> mat2str(fileNum)]).info = info;
0425 
0426 <span class="comment">% Update data</span>
0427 setappdata(cwview,<span class="string">'data'</span>,data);
0428 
0429 <span class="comment">% Update file details</span>
0430 hFile = getappdata(cwview,<span class="string">'hFile'</span>);
0431 
0432 <span class="comment">% Get string in File Details window listbox</span>
0433 files = get(hFile.listbox_files,<span class="string">'String'</span>);
0434 
0435 <span class="comment">% See if files have been listed previously</span>
0436 <span class="keyword">if</span> strcmp(files , <span class="string">'-- No file loaded --'</span>)
0437     files = [<span class="string">'1: '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0438     files = sscanf(files,<span class="string">'%c'</span>,25);      <span class="comment">% Cuts down to 25 characters</span>
0439     files = sprintf(<span class="string">'%-25s'</span>,files);     <span class="comment">% Makes up to 25 characters</span>
0440     
0441     <span class="comment">% Change focus of listbox to the new file</span>
0442     set(hFile.listbox_files,<span class="string">'Value'</span>, 1)
0443 
0444 <span class="comment">% If previous file then get string, add new string title to a new line</span>
0445 <span class="keyword">else</span>
0446     Num = mat2str(fileNum);
0447     next_line = [Num , <span class="string">': '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0448     next_formated = sscanf(next_line,<span class="string">'%c'</span>,25);
0449     next_formated = sprintf(<span class="string">'%-25s'</span>,next_formated);
0450     files = [files ; next_formated];
0451     
0452     <span class="comment">% Change focus of listbox to the new file</span>
0453     set(hFile.listbox_files,<span class="string">'Value'</span>, str2num(Num));
0454 
0455 <span class="keyword">end</span>
0456        
0457 <span class="comment">% Write out new string to File Details listbox</span>
0458 set(hFile.listbox_files,<span class="string">'String'</span>,files)
0459 Var.files = files;
0460 setappdata(cwview,<span class="string">'Var'</span>,Var);
0461 
0462 <span class="comment">% Set other details in the File Details window</span>
0463 set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0464 set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0465 set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0466 
0467 <span class="comment">% Test to see if it is a 3D experiment &amp; adjust slider variables if needed</span>
0468 c = size(y,2);
0469 
0470 <span class="keyword">switch</span> c
0471     <span class="keyword">case</span> 1
0472         Var.Slider.Min      = 1;
0473         Var.Slider.Max      = 2;
0474         Var.Slider.Value    = 1;
0475         Var.Slider.Visible  = <span class="string">'off'</span>;
0476     
0477         setappdata(cwview, <span class="string">'Var'</span> , Var);
0478         
0479     <span class="keyword">otherwise</span>
0480         Var.Slider.Min      = 1;
0481         Var.Slider.Max      = c;
0482         Var.Slider.Value    = 1;
0483         Var.Slider.Visible  = <span class="string">'off'</span>;
0484         
0485         setappdata(cwview, <span class="string">'Var'</span> , Var);
0486         
0487         set(handles.slider , <span class="string">'Min'</span>    , Var.Slider.Min);
0488         set(handles.slider , <span class="string">'Max'</span>    , Var.Slider.Max);
0489         set(handles.slider , <span class="string">'Value'</span>  , Var.Slider.Value);
0490         set(handles.slider , <span class="string">'Visible'</span>, Var.Slider.Visible);
0491         
0492         setappdata(cwview,<span class="string">'hcwView'</span>,handles);
0493 <span class="keyword">end</span>
0494 
0495 <span class="comment">% Plot the new graph</span>
0496 <a href="cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>;
0497 
0498 
0499 <span class="comment">% --------------------------------------------------------------------</span>
0500 <a name="_sub10" href="#_subfunctions" class="code">function menu_File_Bruker_folder_Callback(hObject, eventdata, handles)</a>
0501 <span class="comment">% hObject    handle to menu_File_Bruker_folder (see GCBO)</span>
0502 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0503 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0504 
0505 cwview = getappdata(0,<span class="string">'cwview'</span>);
0506 data   = getappdata(cwview,<span class="string">'data'</span>);
0507 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0508 
0509 <span class="comment">% Find all the spectra</span>
0510 folder = uigetdir;
0511 dtaFiles = dir([folder <span class="string">'/*.DTA'</span>]);
0512 
0513 <span class="comment">% Puts all x data into a x array (each column next experiment, ie 1024x16)</span>
0514 
0515 <span class="keyword">if</span> numel(dtaFiles) ~= 0
0516     <span class="keyword">for</span> k=1:numel(dtaFiles)
0517                 
0518         <span class="comment">% Set file number for file</span>
0519         <span class="keyword">try</span>
0520             fileNum = size(fieldnames(data),1) +1;
0521         <span class="keyword">catch</span>
0522             fileNum = 1;
0523         <span class="keyword">end</span>
0524         
0525         <span class="comment">% Load the file</span>
0526         [x , y , info] = BrukerRead([folder <span class="string">'/'</span> dtaFiles(k).name]);
0527         
0528         <span class="comment">% Move the file to data structure</span>
0529         data.([<span class="string">'File'</span> mat2str(fileNum)]).x = x;
0530         data.([<span class="string">'File'</span> mat2str(fileNum)]).y = y;
0531         data.([<span class="string">'File'</span> mat2str(fileNum)]).info = info;
0532         
0533         <span class="comment">% Update data</span>
0534         setappdata(cwview,<span class="string">'data'</span>,data);
0535         
0536         <span class="comment">% Get string in File Details window listbox</span>
0537         hFile = getappdata(cwview,<span class="string">'hFile'</span>);
0538         files = get(hFile.listbox_files,<span class="string">'String'</span>);
0539         
0540         <span class="comment">% See if files have been listed previously</span>
0541         <span class="keyword">if</span> strcmp(files , <span class="string">'-- No file loaded --'</span>)
0542             files = [<span class="string">'1: '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0543             files = sscanf(files,<span class="string">'%c'</span>,25);      <span class="comment">% Cuts down to 25 characters</span>
0544             files = sprintf(<span class="string">'%-25s'</span>,files);     <span class="comment">% Makes up to 25 characters</span>
0545             
0546             <span class="comment">% Write out new string to File Details listbox</span>
0547             set(hFile.listbox_files,<span class="string">'String'</span>,files)
0548             
0549             <span class="comment">% If previous file then get string, add new string title to a new line</span>
0550         <span class="keyword">else</span>
0551             Num = mat2str(fileNum);
0552             next_line = [Num , <span class="string">': '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0553             next_formated = sscanf(next_line,<span class="string">'%c'</span>,25);
0554             next_formated = sprintf(<span class="string">'%-25s'</span>,next_formated);
0555             files = [files ; next_formated];
0556             
0557             <span class="comment">% Write out new string to File Details listbox</span>
0558             set(hFile.listbox_files,<span class="string">'String'</span>,files)
0559                         
0560         <span class="keyword">end</span>
0561     <span class="keyword">end</span>
0562     
0563     Var.files = files;
0564     setappdata(cwview,<span class="string">'Var'</span>,Var);
0565     
0566     <span class="comment">% Change focus of listbox to the new file</span>
0567     set(hFile.listbox_files,<span class="string">'Value'</span>, size(get(hFile.listbox_files,<span class="string">'String'</span>),1));
0568     
0569     <span class="comment">% Set other details in the File Details window</span>
0570     set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0571     set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0572     set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0573 <span class="keyword">end</span>
0574 
0575 <span class="comment">% Save variables to main workspace</span>
0576 setappdata(cwview,<span class="string">'hFile'</span>,hFile);
0577 
0578 <a href="cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>;
0579 
0580 
0581 
0582 <span class="comment">% --------------------------------------------------------------------</span>
0583 <a name="_sub11" href="#_subfunctions" class="code">function menu_File_Jeol_Callback(hObject, eventdata, handles)</a>
0584 <span class="comment">% hObject    handle to menu_File_Jeol (see GCBO)</span>
0585 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0586 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0587 
0588 warndlg(<span class="string">'Unfortunately this feature has not yet been implemented, but will be included in the next version release'</span>,<span class="string">'Placeholder'</span>);
0589 
0590 
0591 <span class="comment">% --------------------------------------------------------------------</span>
0592 <a name="_sub12" href="#_subfunctions" class="code">function menu_File_Fsc2_Callback(hObject, eventdata, handles)</a>
0593 <span class="comment">% hObject    handle to menu_File_Fsc2 (see GCBO)</span>
0594 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0595 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0596 
0597 warndlg(<span class="string">'Unfortunately this feature has not yet been implemented, but will be included in the next version release'</span>,<span class="string">'Placeholder'</span>);
0598 
0599 
0600 <span class="comment">% --------------------------------------------------------------------</span>
0601 <a name="_sub13" href="#_subfunctions" class="code">function menu_File_Save_Callback(hObject, eventdata, handles)</a>
0602 <span class="comment">% hObject    handle to menu_File_Save (see GCBO)</span>
0603 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0604 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0605 
0606 cwview = getappdata(0,<span class="string">'cwview'</span>);
0607 data   = getappdata(cwview,<span class="string">'data'</span>);
0608 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0609 
0610 [file, pathname] = uiputfile({ <span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0611         <span class="string">'Save file as'</span>,<span class="string">'default'</span>);
0612     
0613 address = [pathname file];
0614 
0615 save(address,<span class="string">'data'</span>,<span class="string">'Var'</span>);
0616 
0617 <span class="comment">% 8888888888                                    888</span>
0618 <span class="comment">% 888                                           888</span>
0619 <span class="comment">% 888                                           888</span>
0620 <span class="comment">% 8888888    888  888 88888b.   .d88b.  888d888 888888</span>
0621 <span class="comment">% 888        `Y8bd8P' 888 &quot;88b d88&quot;&quot;88b 888P&quot;   888</span>
0622 <span class="comment">% 888          X88K   888  888 888  888 888     888</span>
0623 <span class="comment">% 888        .d8&quot;&quot;8b. 888 d88P Y88..88P 888     Y88b.</span>
0624 <span class="comment">% 8888888888 888  888 88888P&quot;   &quot;Y88P&quot;  888      &quot;Y888</span>
0625 <span class="comment">% =================== 888 ============================</span>
0626 <span class="comment">%                     888</span>
0627 <span class="comment">%                     888</span>
0628 
0629 <span class="comment">% --------------------------------------------------------------------</span>
0630 <a name="_sub14" href="#_subfunctions" class="code">function menu_File_Export_Callback(hObject, eventdata, handles)</a>
0631 <span class="comment">% hObject    handle to menu_File_Export (see GCBO)</span>
0632 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0633 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0634 
0635 <span class="comment">% --------------------------------------------------------------------</span>
0636 <a name="_sub15" href="#_subfunctions" class="code">function menu_File_Export_Dataset_Callback(hObject, eventdata, handles)</a>
0637 <span class="comment">% hObject    handle to menu_File_Export_Dataset (see GCBO)</span>
0638 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0639 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0640 
0641 [out_name, out_path] = uiputfile( <span class="keyword">...</span>
0642     {<span class="string">'*.csv'</span>,<span class="string">'Comma Seperated Value (*.csv)'</span>;
0643     <span class="string">'*.DTA'</span> ,<span class="string">'Bruker BES3T (*.DTA/*.DSC)'</span>;<span class="keyword">...</span>
0644     <span class="string">'*.*'</span>,  <span class="string">'All Files (*.*)'</span>},<span class="keyword">...</span>
0645     <span class="string">'Save output as...'</span>);
0646 
0647 <span class="comment">% If user cancels then no error message is returned to command window</span>
0648 <span class="keyword">if</span> isequal(out_name,0)
0649     <span class="keyword">return</span>
0650 <span class="keyword">end</span>
0651 
0652 <span class="comment">% Merge file parts into a proper address</span>
0653 out_add = fullfile(out_path,out_name);
0654 
0655 <span class="comment">% Load variables necessary to write out data</span>
0656 cwview = getappdata(0,<span class="string">'cwview'</span>);
0657 data    = getappdata(cwview,<span class="string">'data'</span>);
0658 hFile   = getappdata(cwview,<span class="string">'hFile'</span>);
0659 
0660 <span class="comment">% Find which file is currently selected and query it</span>
0661 <span class="keyword">try</span>
0662     fSelection  = get(hFile.listbox_files,<span class="string">'Value'</span>);
0663 <span class="keyword">catch</span>
0664     errordlg(<span class="string">'No file has been selected in the File Details window'</span>,<span class="string">'Export...'</span>);
0665 <span class="keyword">end</span>
0666 
0667 exp         = data.([<span class="string">'File'</span> mat2str(fSelection)]);
0668 size_x      = size(exp.x,2);
0669 size_y      = size(exp.y,2);
0670 mwFreq      = exp.info.MWFQ;
0671 
0672 <span class="comment">% Create file and then create the header lines</span>
0673 file = fopen(out_add,<span class="string">'w'</span>);
0674 
0675 header = [<span class="keyword">...</span>
0676 <span class="string">'#                             __     ___                                   '</span>;<span class="keyword">...</span>
0677 <span class="string">'#                _____      __\ \   / (_) _____      _____ _ ___           '</span>;<span class="keyword">...</span>
0678 <span class="string">'#               / __\ \ /\ / / \ \ / /| |/ _ \ \ /\ / / _ \ ''__|           '</span>;<span class="keyword">...</span>
0679 <span class="string">'#              | (__ \ V  V /   \ V / | |  __/\ V  V /  __/ |              '</span>;<span class="keyword">...</span>
0680 <span class="string">'#               \___| \_/\_/     \_/  |_|\___| \_/\_/ \___|_|              '</span>;<span class="keyword">...</span>
0681 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0682 <span class="string">'#  Part of the EPR toolbox:                           developed at         '</span>;<span class="keyword">...</span>
0683 <span class="string">'#  morganbye.net/eprtoolbox                    University of East Anglia   '</span>;<span class="keyword">...</span>
0684 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0685 <span class="string">'# This file has been created by cwViewer - v12.7 at:                       '</span>];
0686 
0687 header = [header ; sprintf(<span class="string">'%-75s'</span>, [<span class="string">'# '</span> datestr(now, <span class="string">'dd mmmm yyyy - HH:MM'</span>)])];
0688 
0689 
0690 <span class="comment">% Get the selected extension so that the switch can be invoked</span>
0691 [~,~,ext] = fileparts(out_add);
0692 
0693 <span class="keyword">switch</span> ext
0694     <span class="keyword">case</span> <span class="string">'.csv'</span>
0695         
0696         <span class="comment">% Single X, Single Y</span>
0697         <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0698             
0699             header = [header ; [<span class="keyword">...</span>
0700                 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0701                 <span class="string">'# This file contains 3 columns: Magnetic field, g-value and intensity      '</span>;<span class="keyword">...</span>
0702                 <span class="string">'#                                                                          '</span>]];
0703             
0704             <span class="comment">% Print header</span>
0705             <span class="keyword">for</span> k = 1:size(header,1)
0706                 fprintf(file,<span class="string">'%-75s\n'</span>,header(k,:));
0707             <span class="keyword">end</span>
0708             
0709             <span class="comment">% Calculate g</span>
0710             <span class="keyword">for</span> k = 1:numel(exp.x)
0711                 g(k,:) = ((6.626068e-34 * mwFreq) / (9.27e-24 * (exp.x(k) /10000) ));
0712             <span class="keyword">end</span>
0713             
0714             <span class="comment">% Write out data</span>
0715             out = [exp.x_view g exp.y_view];
0716             dlmwrite(out_add, out, <span class="string">'-append'</span>,<span class="string">'delimiter'</span>, <span class="string">','</span>,<span class="string">'precision'</span>, <span class="string">'%.13f'</span>);
0717             
0718             <span class="comment">% Close file and free memory</span>
0719             fclose(file);
0720         
0721         <span class="comment">% Many X, Single Y</span>
0722         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y == 1
0723             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0724             
0725         <span class="comment">% Single X, Many Y</span>
0726         <span class="keyword">elseif</span> size_x == 1 &amp;&amp; size_y ~= 1
0727             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0728 
0729                 
0730         <span class="comment">% Many X, Many Y</span>
0731         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y ~= 1
0732             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0733             
0734         <span class="keyword">end</span>
0735         
0736     <span class="keyword">case</span> <span class="string">'.DTA'</span>
0737         
0738         <span class="comment">% Check that we have the function to write out in Bruker format</span>
0739         <span class="keyword">if</span> exist(<span class="string">'BrukerWrite'</span>,<span class="string">'file'</span>) ~=2
0740             errordlg(sprintf(<span class="string">'To save files in the Bruker file format requires the script BrukerWrite.m be on the active path.\n\nIt is available freely as part of the EPR Toolbox at morganbye.net/eprtoolbox'</span>),<span class="string">'Export...Bruker Format'</span>);
0741         <span class="keyword">end</span>
0742         
0743         <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0744             BrukerWrite(exp.x_view,exp.y_view,out_add);
0745         
0746         <span class="comment">% Many X, Single Y</span>
0747         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y == 1
0748             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0749             
0750         <span class="comment">% Single X, Many Y</span>
0751         <span class="keyword">elseif</span> size_x == 1 &amp;&amp; size_y ~= 1
0752             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0753                 
0754         <span class="comment">% Many X, Many Y</span>
0755         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y ~= 1
0756             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0757             
0758         <span class="keyword">end</span>
0759         
0760     <span class="keyword">otherwise</span>
0761         <span class="keyword">try</span>
0762             <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0763                 out = [exp.x exp.y];
0764                 dlmwrite(out_add, out, <span class="string">'delimiter'</span>, <span class="string">','</span>,<span class="string">'precision'</span>, <span class="string">'%.13f'</span>);
0765             <span class="keyword">end</span>
0766         <span class="keyword">catch</span>
0767             errordlg(<span class="string">'You''re selected file format could not be recognized'</span>,<span class="string">'Export...'</span>);
0768         <span class="keyword">end</span>
0769         
0770 <span class="keyword">end</span>
0771 
0772 
0773 <span class="comment">% --------------------------------------------------------------------</span>
0774 <a name="_sub16" href="#_subfunctions" class="code">function menu_File_Export_toWorkspace_Callback(hObject, eventdata, handles)</a>
0775 <span class="comment">% hObject    handle to menu_File_Export_toWorkspace (see GCBO)</span>
0776 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0777 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0778 
0779 <span class="comment">% Load variables necessary to write out data</span>
0780 cwview  = getappdata(0,<span class="string">'cwview'</span>);
0781 data    = getappdata(cwview,<span class="string">'data'</span>);
0782 hFile   = getappdata(cwview,<span class="string">'hFile'</span>);
0783 hView   = getappdata(cwview,<span class="string">'hView'</span>);
0784 
0785 <span class="comment">% Find which file is currently selected and query it</span>
0786 <span class="keyword">try</span>
0787     fSelection  = get(hFile.listbox_files,<span class="string">'Value'</span>);
0788 <span class="keyword">catch</span>
0789     errordlg(<span class="string">'No file has been selected in the File Details window'</span>,<span class="string">'Export...'</span>);
0790 <span class="keyword">end</span>
0791 
0792 exp = data.([<span class="string">'File'</span> mat2str(fSelection)]);
0793 
0794 <span class="comment">% Prompt user for variables names</span>
0795 prompt  = {<span class="string">'Enter variable name for x-axis:'</span>, <span class="string">'Enter variable name for y-axis:'</span>};
0796 title   = <span class="string">'Export dataset to MATLAB Workspace - cwViewer v12.7'</span>;
0797 lines   = 1;
0798 default = {<span class="string">'x'</span>, <span class="string">'y'</span>};
0799 answer  = inputdlg(prompt, title, lines, default);
0800 
0801 <span class="comment">% Write variables to base workspace</span>
0802 assignin(<span class="string">'base'</span>, answer{1} , exp.x_view);
0803 assignin(<span class="string">'base'</span>, answer{2} , exp.y_view);
0804         
0805 
0806 
0807 <span class="comment">% --------------------------------------------------------------------</span>
0808 <a name="_sub17" href="#_subfunctions" class="code">function menu_File_Export_Image_Callback(hObject, eventdata, handles)</a>
0809 <span class="comment">% hObject    handle to menu_File_Export_Image (see GCBO)</span>
0810 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0811 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0812 
0813 cwview = getappdata(0,<span class="string">'cwview'</span>);
0814 hcwView = getappdata(cwview,<span class="string">'hcwView'</span>);
0815 
0816 <span class="comment">% stores savepath for the phase plot</span>
0817 [filename, pathname] = uiputfile({ <span class="string">'*.eps'</span>,<span class="string">'Encapsulated Postscript (*.eps)'</span>;<span class="keyword">...</span>
0818         <span class="string">'*.png'</span>,<span class="string">'Portable Network Graphic (*.png)'</span>;<span class="keyword">...</span>
0819         <span class="string">'*.bmp'</span>,<span class="string">'Bitmap (*.bmp)'</span>; <span class="string">'*.fig'</span>,<span class="string">'Figure (*.fig)'</span>}, <span class="keyword">...</span><span class="comment"> </span>
0820         <span class="string">'Save picture as'</span>,<span class="string">'default'</span>);
0821 
0822 <span class="comment">% if user cancels save command, nothing happens</span>
0823 <span class="keyword">if</span> isequal(filename,0) || isequal(pathname,0)
0824     <span class="keyword">return</span>
0825 <span class="keyword">end</span>
0826 <span class="comment">% create a new figure</span>
0827 newFig = figure;
0828 
0829 <span class="comment">% get the units and position of the axes object</span>
0830 axes_units = get(hcwView.viewer_axes,<span class="string">'Units'</span>);
0831 axes_pos   = get(hcwView.viewer_axes,<span class="string">'Position'</span>);
0832 
0833 <span class="comment">% copies axesObject onto new figure</span>
0834 axesObject = copyobj(hcwView.viewer_axes,newFig);
0835 
0836 <span class="comment">% realign the axes object on the new figure</span>
0837 set(axesObject,<span class="string">'Units'</span>,axes_units);
0838 set(axesObject,<span class="string">'Position'</span>,[15 5 axes_pos(3) axes_pos(4)]);
0839 
0840 <span class="comment">% adjusts the new figure accordingly</span>
0841 set(newFig,<span class="string">'Units'</span>,axes_units);
0842 set(newFig,<span class="string">'Position'</span>,[15 5 axes_pos(3)+30 axes_pos(4)+10]);
0843 
0844 <span class="comment">% saves the plot</span>
0845 saveas(newFig,[pathname filename]) 
0846 
0847 <span class="comment">% closes the figure</span>
0848 close(newFig)
0849 
0850 <span class="comment">% --------------------------------------------------------------------</span>
0851 <a name="_sub18" href="#_subfunctions" class="code">function menu_File_Exit_Callback(hObject, eventdata, handles)</a>
0852 <span class="comment">% hObject    handle to menu_File_Exit (see GCBO)</span>
0853 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0854 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0855 
0856 <a href="#_sub6" class="code" title="subfunction figure1_CloseRequestFcn(hObject, eventdata, handles)">figure1_CloseRequestFcn</a>
0857 
0858 
0859 <span class="comment">% 888       888 d8b               888</span>
0860 <span class="comment">% 888   o   888 Y8P               888</span>
0861 <span class="comment">% 888  d8b  888                   888</span>
0862 <span class="comment">% 888 d888b 888 888 88888b.   .d88888  .d88b.  888  888  888 .d8888b</span>
0863 <span class="comment">% 888d88888b888 888 888 &quot;88b d88&quot; 888 d88&quot;&quot;88b 888  888  888 88K</span>
0864 <span class="comment">% 88888P Y88888 888 888  888 888  888 888  888 888  888  888 &quot;Y8888b.</span>
0865 <span class="comment">% 8888P   Y8888 888 888  888 Y88b 888 Y88..88P Y88b 888 d88P      X88</span>
0866 <span class="comment">% 888P     Y888 888 888  888  &quot;Y88888  &quot;Y88P&quot;   &quot;Y8888888P&quot;   88888P'</span>
0867 
0868 <span class="comment">% --------------------------------------------------------------------</span>
0869 <a name="_sub19" href="#_subfunctions" class="code">function menu_Window_Callback(hObject, eventdata, handles)</a>
0870 <span class="comment">% hObject    handle to menu_Window (see GCBO)</span>
0871 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0872 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0873 
0874 <span class="comment">% --------------------------------------------------------------------</span>
0875 <a name="_sub20" href="#_subfunctions" class="code">function menu_Window_File_Callback(hObject, eventdata, handles)</a>
0876 <span class="comment">% hObject    handle to menu_Window_File (see GCBO)</span>
0877 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0878 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0879 
0880 
0881 cwview = getappdata(0,<span class="string">'cwview'</span>);
0882 
0883 h = getappdata(cwview,<span class="string">'handles'</span>);
0884 
0885 <span class="comment">% Get state of menu</span>
0886 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span>)
0887     
0888     <span class="comment">% If window is not open, open it</span>
0889     <span class="keyword">case</span> <span class="string">'off'</span>
0890         
0891         wFile = <a href="file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>;
0892         Win = allchild(0);
0893         WindowHandles.FileDetails = Win(1);
0894         WindowVisible.FileDetails = 1;
0895         
0896         setappdata(cwview,<span class="string">'wFile'</span>  ,wFile);
0897         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0898         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0899         
0900         set(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
0901         
0902     <span class="comment">% If window is open, close it</span>
0903     <span class="keyword">case</span> <span class="string">'on'</span>
0904         <span class="comment">% Close winow</span>
0905         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0906         delete(Handles.FileDetails);
0907         
0908         <span class="comment">% Change visibility status</span>
0909         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0910         Visible.ViewingOptions = 0;
0911         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
0912         
0913         <span class="comment">% Change menu status</span>
0914         h = getappdata(cwview,<span class="string">'handles'</span>);
0915         set(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span> , <span class="string">'off'</span>);             
0916 <span class="keyword">end</span>
0917 
0918 
0919 <span class="comment">% --------------------------------------------------------------------</span>
0920 <a name="_sub21" href="#_subfunctions" class="code">function menu_Window_View_Callback(hObject, eventdata, handles)</a>
0921 <span class="comment">% hObject    handle to menu_Window_View (see GCBO)</span>
0922 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0923 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0924 
0925 cwview = getappdata(0,<span class="string">'cwview'</span>);
0926 
0927 h = getappdata(cwview,<span class="string">'handles'</span>);
0928 
0929 <span class="comment">% Get state of menu</span>
0930 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span>)
0931     
0932     <span class="comment">% If window is not open, open it</span>
0933     <span class="keyword">case</span> <span class="string">'off'</span>
0934         
0935         wView = <a href="viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>;
0936         Win = allchild(0);
0937         WindowHandles.ViewingOptions = Win(1);
0938         WindowVisible.ViewingOptions = 1;
0939         
0940         setappdata(cwview,<span class="string">'wView'</span>  ,wView);
0941         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0942         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0943         
0944         set(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
0945         
0946     <span class="comment">% If window is open, close it</span>
0947     <span class="keyword">case</span> <span class="string">'on'</span>
0948         <span class="comment">% Close winow</span>
0949         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0950         delete(Handles.ViewingOptions);
0951         
0952         <span class="comment">% Change visibility status</span>
0953         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0954         Visible.ViewingOptions = 0;
0955         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
0956         
0957         <span class="comment">% Change menu status</span>
0958         h = getappdata(cwview,<span class="string">'handles'</span>);
0959         set(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
0960               
0961 <span class="keyword">end</span>
0962 
0963 
0964 <span class="comment">% --------------------------------------------------------------------</span>
0965 <a name="_sub22" href="#_subfunctions" class="code">function menu_Window_DataMan_Callback(hObject, eventdata, handles)</a>
0966 <span class="comment">% hObject    handle to menu_Window_DataMan (see GCBO)</span>
0967 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0968 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0969 
0970 cwview = getappdata(0,<span class="string">'cwview'</span>);
0971 
0972 h = getappdata(cwview,<span class="string">'handles'</span>);
0973 
0974 <span class="comment">% Get state of menu</span>
0975 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span>)
0976     
0977     <span class="comment">% If window is not open, open it</span>
0978     <span class="keyword">case</span> <span class="string">'off'</span>
0979         
0980         wView = <a href="viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>;
0981         Win = allchild(0);
0982         WindowHandles.DataMan = Win(1);
0983         WindowVisible.DataMan = 1;
0984         
0985         setappdata(cwview,<span class="string">'wMan'</span>  ,wDataMan);
0986         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0987         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0988         
0989         set(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
0990         
0991     <span class="comment">% If window is open, close it</span>
0992     <span class="keyword">case</span> <span class="string">'on'</span>
0993         <span class="comment">% Close winow</span>
0994         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0995         delete(Handles.DataMan);
0996         
0997         <span class="comment">% Change visibility status</span>
0998         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0999         Visible.DataMan = 0;
1000         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
1001         
1002         <span class="comment">% Change menu status</span>
1003         h = getappdata(cwview,<span class="string">'handles'</span>);
1004         set(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
1005               
1006 <span class="keyword">end</span>
1007 
1008 <span class="comment">% --------------------------------------------------------------------</span>
1009 <a name="_sub23" href="#_subfunctions" class="code">function menu_Window_EasyFitting_Callback(hObject, eventdata, handles)</a>
1010 <span class="comment">% hObject    handle to menu_Window_EasyFitting (see GCBO)</span>
1011 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1012 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1013 
1014 cwview = getappdata(0,<span class="string">'cwview'</span>);
1015 
1016 h = getappdata(cwview,<span class="string">'handles'</span>);
1017 
1018 <span class="comment">% Get state of menu</span>
1019 <span class="keyword">switch</span> get(handles.menu_Window_EasyFitting, <span class="string">'Checked'</span>)
1020     
1021     <span class="comment">% If window is not open, open it</span>
1022     <span class="keyword">case</span> <span class="string">'off'</span>
1023         
1024         wEzF = <a href="easyfitting.html" class="code" title="function varargout = easyfitting(varargin)">easyfitting</a>;
1025         Win = allchild(0);
1026         WindowHandles.EasyFitting = Win(1);
1027         WindowVisible.EasyFitting = 1;
1028         
1029         setappdata(cwview,<span class="string">'wEzF'</span>  ,wEzF);
1030         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
1031         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
1032         
1033         set(handles.menu_Window_EasyFitting, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
1034         
1035     <span class="comment">% If window is open, close it</span>
1036     <span class="keyword">case</span> <span class="string">'on'</span>
1037         <span class="comment">% Close winow</span>
1038         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
1039         delete(Handles.EasyFitting);
1040         
1041         <span class="comment">% Change visibility status</span>
1042         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
1043         Visible.EasyFitting = 0;
1044         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
1045         
1046         <span class="comment">% Change menu status</span>
1047         h = getappdata(cwview,<span class="string">'handles'</span>);
1048         set(h.cwViewer.menu_Window_EasyFitting, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
1049               
1050 <span class="keyword">end</span>
1051 
1052 
1053 <span class="comment">% --------------------------------------------------------------------</span>
1054 <a name="_sub24" href="#_subfunctions" class="code">function menu_help_Callback(hObject, eventdata, handles)</a>
1055 <span class="comment">% hObject    handle to menu_help (see GCBO)</span>
1056 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1057 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1058 
1059 
1060 <span class="comment">% --------------------------------------------------------------------</span>
1061 <a name="_sub25" href="#_subfunctions" class="code">function menu_help_about_Callback(hObject, eventdata, handles)</a>
1062 <span class="comment">% hObject    handle to menu_help_about (see GCBO)</span>
1063 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1064 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1065 
1066 l1 = sprintf(<span class="string">'cwViewer is part of the EPR Toolbox and has been developed by Morgan Bye as a side project whilst at the University of East Anglia. It is constantly in development and as such should be considered beta software\n\nThis software is distributed under a Creative Commons, non-commerical, share a-like license.\n\nPlease report any bugs, errors or requests to morgan.bye@uea.ac.uk\n\nMore information can be found at morganbye.net/eprtoolbox\n\nLatest releases can also be found at sourceforge.net/projects/eprtoolbox\n\nLinks have been placed in the Command Window for your convenience\n\n'</span>);
1067 
1068 Links = sprintf(<span class="string">'\n&lt;a href=&quot;http://morganbye.net/eprtoolbox&quot;&gt;morganbye.net/eprtoolbox&lt;/a&gt;\n&lt;a href=&quot;http://sourceforge.net/projects/eprtoolbox&quot;&gt;sourceforge.net/projects/eprtoolbox&lt;/a&gt;\n\n'</span>)
1069 
1070 msgbox(l1,<span class="string">'cwViewer - v12.7'</span>);</pre></div>
<hr><address>Generated on Thu 25-Oct-2012 18:03:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>