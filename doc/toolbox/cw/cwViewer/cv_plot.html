<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of cv_plot</title>
  <meta name="keywords" content="cv_plot">
  <meta name="description" content="CV_PLOT Plotting function for cwViewer">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">toolbox</a> &gt; <a href="../index.html">cw</a> &gt; <a href="index.html">cwViewer</a> &gt; cv_plot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for toolbox/cw/cwViewer&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>cv_plot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>CV_PLOT Plotting function for cwViewer</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function cv_plot(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> CV_PLOT Plotting function for cwViewer

 Syntax:  cv_plot

 Inputs:
    input1     - n/a

 Outputs:
    output1    - n/a

 Example: 
    see http://morganbye.net/cwViewer

 Other m-files required:   /private (directory)

 Subfunctions:             none

 MAT-files required:       none


 See also: <a href="cwViewer.html" class="code" title="function varargout = cwViewer(varargin)">CWVIEWER</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="cwViewer.html" class="code" title="function varargout = cwViewer(varargin)">cwViewer</a>	CWVIEWER Open, analyse and plot cw-EPR experiments.</li><li><a href="data_man.html" class="code" title="function varargout = data_man(varargin)">data_man</a>	FILE_DETAILS The data manipulation window for cwViewer</li><li><a href="file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>	FILE_DETAILS The file details window for cwViewer</li><li><a href="viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>	VIEWING_OPTIONS The Viewing Options window for cwViewer</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function cv_plot(varargin)</a>
0002 
0003 <span class="comment">% CV_PLOT Plotting function for cwViewer</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Syntax:  cv_plot</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% Inputs:</span>
0008 <span class="comment">%    input1     - n/a</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% Outputs:</span>
0011 <span class="comment">%    output1    - n/a</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% Example:</span>
0014 <span class="comment">%    see http://morganbye.net/cwViewer</span>
0015 <span class="comment">%</span>
0016 <span class="comment">% Other m-files required:   /private (directory)</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% Subfunctions:             none</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% MAT-files required:       none</span>
0021 <span class="comment">%</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% See also: CWVIEWER</span>
0024 
0025 <span class="comment">%                           oooooo     oooo   o8o</span>
0026 <span class="comment">%                            `888.     .8'    `&quot;'</span>
0027 <span class="comment">%  .ooooo.  oooo oooo    ooo   `888.   .8'   oooo   .ooooo.  oooo oooo    ooo  .ooooo.  oooo d8b</span>
0028 <span class="comment">% d88' `&quot;Y8  `88. `88.  .8'     `888. .8'    `888  d88' `88b  `88. `88.  .8'  d88' `88b `888&quot;&quot;8P</span>
0029 <span class="comment">% 888         `88..]88..8'       `888.8'      888  888ooo888   `88..]88..8'   888ooo888  888</span>
0030 <span class="comment">% 888   .o8    `888'`888'         `888'       888  888    .o    `888'`888'    888    .o  888</span>
0031 <span class="comment">% `Y8bod8P'     `8'  `8'           `8'       o888o `Y8bod8P'     `8'  `8'     `Y8bod8P' d888b</span>
0032 <span class="comment">%</span>
0033 
0034 <span class="comment">%                                        _                             _</span>
0035 <span class="comment">%                                       | |                           | |</span>
0036 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0037 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0038 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0039 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0040 <span class="comment">%                       __/ |                   __/ |</span>
0041 <span class="comment">%                      |___/                   |___/</span>
0042 <span class="comment">%</span>
0043 <span class="comment">%</span>
0044 <span class="comment">% M. Bye v12.6</span>
0045 <span class="comment">%</span>
0046 <span class="comment">% Author:       Morgan Bye</span>
0047 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0048 <span class="comment">%               University of East Anglia</span>
0049 <span class="comment">%               NORWICH, UK</span>
0050 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0051 <span class="comment">% Website:      http://www.morganbye.net/eprtoolbox/</span>
0052 <span class="comment">% May 2012;     Last revision: 30-May-2012</span>
0053 <span class="comment">%</span>
0054 <span class="comment">% Approximate coding time of file:</span>
0055 <span class="comment">%               6 hours</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% Version history:</span>
0059 <span class="comment">% Jun 12        &gt; Savitzky-Golay implemented</span>
0060 <span class="comment">%               &gt; Add noise added</span>
0061 <span class="comment">%               &gt; g - value x-axis scale added</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% May 12        Initial release (open beta)</span>
0064 <span class="comment">%</span>
0065 <span class="comment">% Feb 12        First alpha</span>
0066 
0067 <span class="comment">% Get variables</span>
0068 <span class="comment">% --------------------------------------------------------------------</span>
0069 cwview = getappdata(0,<span class="string">'cwview'</span>);
0070 
0071 data    = getappdata(cwview,<span class="string">'data'</span>);
0072 Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0073 Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0074 hFile   = getappdata(cwview,<span class="string">'hFile'</span>);
0075 hView   = getappdata(cwview,<span class="string">'hView'</span>);
0076 hMan    = getappdata(cwview,<span class="string">'hMan'</span>);
0077 hcwView = getappdata(cwview,<span class="string">'hcwView'</span>);
0078 Var     = getappdata(cwview,<span class="string">'Var'</span>);
0079 
0080 
0081 
0082 <span class="comment">% File details window</span>
0083 <span class="comment">% --------------------------------------------------------------------</span>
0084 fSelection = get(hFile.listbox_files,<span class="string">'Value'</span>);
0085 
0086 <span class="comment">% Data set selection</span>
0087 <span class="comment">% --------------------------------------------------------------------</span>
0088 <span class="keyword">try</span>
0089     exp = data.([<span class="string">'File'</span> mat2str(fSelection)]);
0090 <span class="keyword">catch</span>
0091     disp(<span class="string">'No file has been loaded, plotting could not occur.'</span>)
0092     <span class="keyword">return</span>
0093 <span class="keyword">end</span>
0094 
0095 x1 = exp.x;
0096 y1 = exp.y;
0097 
0098 [r,c] = size(y1);
0099 
0100 <span class="comment">% View window (g-value x-axis)</span>
0101 <span class="comment">% --------------------------------------------------------------------</span>
0102 
0103 <span class="keyword">switch</span> get(hView.checkbox_g,<span class="string">'Value'</span>)
0104     <span class="keyword">case</span> 0
0105         <span class="comment">% Change Gauss to mT</span>
0106         x3 = x1/10;
0107         
0108     <span class="keyword">case</span> 1
0109         <span class="comment">% If there is a reference then adjust mag field</span>
0110         <span class="keyword">switch</span> get(hView.checkbox_reference,<span class="string">'Value'</span>)
0111             <span class="keyword">case</span> 0
0112                 <span class="comment">% Do nothing</span>
0113                 x2 = x1;
0114                 
0115             <span class="keyword">case</span> 1
0116                 <span class="comment">% Get reference values from GUI</span>
0117                 g_ideal   = str2num(get(hView.edit_refg,<span class="string">'String'</span>));
0118                 ref_freq  = str2num(get(hView.edit_refFreq,<span class="string">'String'</span>));
0119                 ref_field = str2num(get(hView.edit_refField,<span class="string">'String'</span>));
0120                 
0121                 <span class="comment">% Calculate the reference offset</span>
0122                 
0123                 <span class="comment">%      Plank's constant X mwFreq</span>
0124                 <span class="comment">% g = ----------------------------</span>
0125                 <span class="comment">%     Bohr's constant X Mag. Field</span>
0126                 
0127                 <span class="comment">% Remember 1 GHz = 10^9 Hz and 1 Tesla = 10^5 Gauss</span>
0128                 g_measured = ((6.626068e-34 * ref_freq *10^9) / (9.27400915e-24 * (ref_field /10^4)));
0129                 
0130                 g_offset   = g_ideal - g_measured;
0131                 
0132                 <span class="comment">%              Plank's constant X mwFreq</span>
0133                 <span class="comment">% Mag.Field = ----------------------------</span>
0134                 <span class="comment">%                  Bohr's constant</span>
0135                 <span class="comment">%                  ---------------</span>
0136                 <span class="comment">%                         g</span>
0137                 
0138                 mag_offset = (((6.626068e-34 * (ref_freq*10^9)) / g_offset) / 9.27400915e-24);
0139                               
0140                 x2 = x1 + mag_offset;     
0141         <span class="keyword">end</span>
0142         
0143         <span class="comment">% Magnetic field to g-values</span>
0144         <span class="keyword">for</span> k = 1:numel(x2)
0145             
0146             <span class="comment">%      Plank's constant X mwFreq</span>
0147             <span class="comment">% g = ----------------------------</span>
0148             <span class="comment">%     Bohr's constant X Mag. Field</span>
0149             
0150             x3(k,:) = ((6.626068e-34 * exp.info.MWFQ) / (9.27400915e-24 * (x2(k) /10000) ));
0151         <span class="keyword">end</span>
0152         
0153 <span class="keyword">end</span>
0154 
0155 
0156 
0157 <span class="comment">% Data manipulation window</span>
0158 <span class="comment">% --------------------------------------------------------------------</span>
0159 
0160 <span class="comment">% Normalize</span>
0161 <span class="comment">% ===================================================</span>
0162 
0163 <span class="keyword">switch</span> get(hMan.checkbox_norm,<span class="string">'Value'</span>)
0164     <span class="keyword">case</span> 1
0165         <span class="keyword">for</span> k = 1:c
0166             max_y1(:,k) = max(y1(:,k));
0167             min_y1(:,k) = min(y1(:,k));
0168             
0169             y2(:,k) = (( y1(:,k) - min_y1(:,k))/(max_y1(:,k) - min_y1(:,k)) - 0.5) *2;
0170         <span class="keyword">end</span>
0171         
0172     <span class="keyword">case</span> 0
0173         y2 = y1;
0174 <span class="keyword">end</span>
0175 
0176 <span class="comment">% Digital smooth</span>
0177 <span class="comment">% ===================================================</span>
0178 
0179 <span class="keyword">switch</span> get(hMan.checkbox_dsmooth,<span class="string">'Value'</span>)
0180     <span class="keyword">case</span> 1
0181         <span class="keyword">for</span> k = 1:c
0182             wndw = str2num(get(hMan.edit_dsmooth,<span class="string">'String'</span>));
0183             h = ones(1,wndw)/wndw;
0184             y3(:,k) = filter(h, 1, y2(:,k));
0185         <span class="keyword">end</span>
0186     
0187     <span class="keyword">case</span> 0
0188         y3 = y2;
0189 <span class="keyword">end</span>        
0190 
0191 <span class="comment">% FFT smooth</span>
0192 <span class="comment">% ===================================================</span>
0193 
0194 <span class="keyword">switch</span> get(hMan.checkbox_fsmooth,<span class="string">'Value'</span>)
0195     <span class="keyword">case</span> 1
0196         <span class="keyword">for</span> k = 1:c
0197             points = str2num(get(hMan.edit_fsmooth,<span class="string">'String'</span>));
0198             f(:,k) = fft(y3(:,k));
0199             <span class="keyword">try</span>
0200                 f(r/2+1-points:r/2+points,k) = zeros(2*points,1);
0201             <span class="keyword">catch</span>
0202                 errordlg(sprintf(<span class="string">'FFT value is too high to compute or not a positive interger.\n\nPlease try again.'</span>),<span class="string">'FFT Smooth'</span>)
0203             <span class="keyword">end</span>
0204             
0205             y4(:,k) = real(ifft(f(:,k)));
0206         <span class="keyword">end</span>
0207         
0208     <span class="keyword">case</span> 0
0209         y4 = y3;
0210 <span class="keyword">end</span>
0211 
0212 <span class="comment">% Add noise</span>
0213 <span class="comment">% ===================================================</span>
0214 
0215 <span class="keyword">switch</span> get(hMan.checkbox_addnoise,<span class="string">'Value'</span>)
0216     <span class="keyword">case</span> 1
0217         noise = str2num(get(hMan.edit_noise,<span class="string">'String'</span>));
0218         
0219         y_max = max(y4);
0220         y_min = min(y4);
0221         y_range = y_max - y_min;
0222         
0223         range = y_range * (noise/100);
0224         
0225         <span class="keyword">for</span> k = 1:numel(y4)
0226             <span class="keyword">if</span> rand(1) &lt; 0.5
0227                 y_noise(k) = y4(k) - (range * rand(1));
0228             <span class="keyword">else</span>
0229                 y_noise(k) = y4(k) + (range * rand(1));
0230             <span class="keyword">end</span>
0231         <span class="keyword">end</span>
0232         
0233         y5 = y_noise';
0234         
0235     <span class="keyword">case</span> 0
0236         y5 = y4;
0237 <span class="keyword">end</span>
0238 
0239 <span class="comment">% Savitzky-Golay</span>
0240 <span class="comment">% ===================================================</span>
0241 
0242 <span class="keyword">switch</span> get(hMan.checkbox_sgo,<span class="string">'Value'</span>)
0243     <span class="keyword">case</span> 1
0244         sgo_points = str2num(get(hMan.edit_sgo_points,<span class="string">'String'</span>));
0245         sgo_poly   = str2num(get(hMan.edit_sgo_poly,  <span class="string">'String'</span>));
0246         
0247         nl = round(sgo_points / 2);
0248         nr = round(sgo_points / 2);
0249         
0250         A  = ones(nl+nr+1 , sgo_poly+1);
0251 
0252         <span class="keyword">for</span> j = sgo_poly:-1:1
0253             A(:,j) = [-nl:nr]' .* A(: , j+1);
0254         <span class="keyword">end</span>
0255         
0256         <span class="keyword">try</span>
0257             [Q,R] = qr(A);
0258             c = Q(: , sgo_poly+1) / R(sgo_poly+1 , sgo_poly+1);
0259         <span class="keyword">catch</span>
0260             warndlg(<span class="string">'An error occured, try keeping the number of points more than the polynominal order'</span>,<span class="string">'Savitzky-Golay Error'</span>)
0261         <span class="keyword">end</span>
0262         
0263         n = length(y5);
0264         y6            = filter(c(nl+nr+1:-1:1) , 1 , y5);
0265         y6(1:nl)      = y5(1:nl);
0266         y6(nl+1:n-nr) = y6(nl+nr+1:n);
0267         y6(n-nr+1:n)  = y5(n-nr+1:n);
0268         
0269         <span class="comment">% Remove the data points at the beginning and end as they will have</span>
0270         <span class="comment">% been unable to be smoothed. By removing them here, the points</span>
0271         <span class="comment">% still exist in the raw data file, they're just not plotted on</span>
0272         <span class="comment">% screen</span>
0273         
0274         y6 = y6(1+nl:end-nr);
0275         x3 = x3(1+nl:end-nr);
0276         
0277     <span class="keyword">case</span> 0
0278         y6 = y5;
0279         
0280 <span class="keyword">end</span>
0281 
0282 <span class="comment">% Auto-zero wants to be the last function that is called in the plotting,</span>
0283 <span class="comment">% for this reason we call everything first</span>
0284 <span class="comment">%</span>
0285 <span class="comment">% Use this to quickly variables when adding new functions before calling</span>
0286 <span class="comment">% the auto-zero</span>
0287 y98 = y6;
0288 
0289 <span class="comment">% Autozero</span>
0290 <span class="comment">% ===================================================</span>
0291 
0292 <span class="keyword">switch</span> get(hMan.checkbox_auto_zero,<span class="string">'Value'</span>)
0293     <span class="keyword">case</span> 1
0294         <span class="keyword">for</span> k = 1:size(y98,2)
0295             m = mean(y98(:,k));
0296             y99(:,k) = y98(:,k) - (m);
0297         <span class="keyword">end</span>
0298     <span class="keyword">case</span> 0
0299         y99 = y98;
0300 <span class="keyword">end</span>
0301 
0302 <span class="comment">% Finally convert the value to variables x and y for plotting</span>
0303 x = x3;
0304 y = y99;
0305 
0306 <span class="comment">% Write the values back to the data variables</span>
0307 data.([<span class="string">'File'</span> mat2str(fSelection)]).x_view = x;
0308 data.([<span class="string">'File'</span> mat2str(fSelection)]).y_view = y;
0309 
0310 setappdata(cwview,<span class="string">'data'</span>,data);
0311 
0312 
0313 <span class="comment">% Plot command</span>
0314 <span class="comment">% --------------------------------------------------------------------</span>
0315 
0316 <span class="keyword">switch</span> exp.info.EXPT
0317     
0318     <span class="comment">% PULSE EXPERIMENTS</span>
0319     <span class="comment">% =================</span>
0320     <span class="keyword">case</span> <span class="string">'PLS'</span>
0321         <span class="keyword">switch</span> exp.info.XNAM
0322             <span class="comment">% For FSEs</span>
0323             <span class="keyword">case</span> <span class="string">'''Field'''</span>
0324                 plot(hcwView.viewer_axes,<span class="keyword">...</span>
0325                      x/10, y.real, <span class="string">'k-'</span>,<span class="keyword">...</span>
0326                      x/10, y.imag, <span class="string">'r-'</span>);
0327                 xlabel(hcwView.viewer_axes,<span class="string">'Magnetic Field / mT'</span>);
0328                 
0329                 <span class="comment">% For FIDs</span>
0330             <span class="keyword">case</span> <span class="string">'''Time'''</span>
0331                 plot(hcwView.viewer_axes,<span class="keyword">...</span>
0332                      x,     y.real, <span class="string">'k-'</span>,<span class="keyword">...</span>
0333                      x,     y.imag, <span class="string">'r-'</span>);
0334                 xlabel(hcwView.viewer_axes,<span class="string">'Time / ns'</span>);
0335                 
0336             <span class="keyword">otherwise</span>
0337                 <span class="keyword">try</span>
0338                     plot(hcwView.viewer_axes,<span class="keyword">...</span>
0339                         x,y.real,<span class="string">'k-'</span> , x,y.imag,<span class="string">'r-'</span>);
0340                 <span class="keyword">end</span>
0341         <span class="keyword">end</span>
0342         
0343         legend(hcwView.viewer_axes,<span class="string">'Real'</span>,<span class="string">'Imaginary'</span>)
0344         
0345        
0346     <span class="comment">% CW EXPERIMENTS</span>
0347     <span class="comment">% ==============</span>
0348     <span class="keyword">case</span> <span class="string">'CW'</span>
0349         
0350         <span class="comment">% Viewing options window - PLOT TYPE</span>
0351         <span class="comment">% ------------------------------------------------------------</span>
0352         
0353         <span class="comment">% If window is open</span>
0354         <span class="keyword">if</span> isfield(Handles,<span class="string">'ViewingOptions'</span>) &amp;&amp; Visible.ViewingOptions == 1
0355             <span class="comment">% Get plot type</span>
0356             <span class="keyword">switch</span> Var.View.Plot_Button
0357                 <span class="keyword">case</span> <span class="string">'Stacked'</span>
0358                     
0359                     <span class="comment">% Plot x (in mT) against y</span>
0360                     plot(hcwView.viewer_axes,<span class="keyword">...</span>
0361                         x,<span class="keyword">...</span>
0362                         y);
0363                     
0364                     
0365                 <span class="keyword">case</span> <span class="string">'Single'</span>
0366                                         
0367                     <span class="comment">% Plot x (in mT) against the y column that corresponds</span>
0368                     <span class="comment">% to the slider position</span>
0369                     <span class="keyword">if</span> isfield(Var.Slider , <span class="string">'Value'</span>) == 0
0370                         Var.Slider.Value = 1;
0371                     <span class="keyword">end</span>
0372                     
0373                     plot(hcwView.viewer_axes,<span class="keyword">...</span>
0374                         x/10,<span class="keyword">...</span>
0375                         y(: , round(Var.Slider.Value)));
0376                     
0377                 
0378                 <span class="keyword">case</span> <span class="string">'Staggered'</span>
0379                     
0380                     <span class="comment">% Get offsets from the Viewing options window</span>
0381                     
0382                     <span class="keyword">switch</span> get(hView.checkbox_yaxis,<span class="string">'Value'</span>)
0383                         <span class="keyword">case</span> 0
0384                             y_offset = 0;
0385                             
0386                         <span class="keyword">case</span> 1
0387                             y_offset = str2num(get(hView.edit_yaxis, <span class="string">'String'</span>));
0388                     <span class="keyword">end</span>
0389                     
0390                     
0391                     <span class="keyword">switch</span> get(hView.checkbox_xaxis,<span class="string">'Value'</span>)
0392                         <span class="keyword">case</span> 0
0393                             x_offset = 0;
0394                             
0395                         <span class="keyword">case</span> 1
0396                             x_offset = str2num(get(hView.edit_xaxis, <span class="string">'String'</span>));
0397                     <span class="keyword">end</span>
0398                     
0399                     <span class="comment">% Plot x (in mT) against the y. After the offset has</span>
0400                     <span class="comment">% been applied</span>
0401                     
0402                     <span class="comment">% Many spectra in a *.YGF file will give a single</span>
0403                     <span class="comment">% column of x data. Whereas several different files</span>
0404                     <span class="comment">% will have many x</span>
0405                     <span class="keyword">switch</span> size(x,2)
0406                         <span class="keyword">case</span> 1
0407                             cla(hcwView.viewer_axes);
0408                             hold(hcwView.viewer_axes,<span class="string">'on'</span>);
0409                             <span class="keyword">for</span> k = 1:c
0410                                 plot(hcwView.viewer_axes,<span class="keyword">...</span>
0411                                     (x(:,1)+(k*x_offset)),(y(:,k)+(y_offset*k)))
0412                             <span class="keyword">end</span>
0413                             hold(hcwView.viewer_axes,<span class="string">'off'</span>);
0414                         <span class="keyword">otherwise</span>
0415                             hold(hcwView.viewer_axes,<span class="string">'on'</span>);
0416                             <span class="keyword">for</span> k = 1:c
0417                                 plot(hcwView.viewer_axes,<span class="keyword">...</span>
0418                                     (x(:,k)+(k*x_offset)),(y(:,k)+(y_offset*k)))
0419                             <span class="keyword">end</span>
0420                             hold(hcwView.viewer_axes,<span class="string">'off'</span>);
0421                     <span class="keyword">end</span>
0422                     
0423             <span class="keyword">end</span>
0424             
0425         <span class="keyword">else</span>
0426             plot(hcwView.viewer_axes,<span class="keyword">...</span>
0427                     x,     y,    <span class="string">'k-'</span>);
0428         <span class="keyword">end</span>
0429         
0430         <span class="keyword">switch</span> get(hView.checkbox_g,<span class="string">'Value'</span>)
0431             <span class="keyword">case</span> 0
0432                 xlabel(hcwView.viewer_axes,<span class="string">'Magnetic Field / mT'</span>);
0433                 set(hcwView.viewer_axes,<span class="string">'XDir'</span>,<span class="string">'normal'</span>);
0434                 
0435             <span class="keyword">case</span> 1
0436                 xlabel(hcwView.viewer_axes,<span class="string">'g'</span>);
0437                 set(hcwView.viewer_axes,<span class="string">'XDir'</span>,<span class="string">'reverse'</span>);
0438         
0439         <span class="keyword">end</span>
0440         
0441 <span class="keyword">end</span>
0442 
0443 <span class="comment">% Figure formatting</span>
0444 ylabel(hcwView.viewer_axes,<span class="string">'Intensity'</span>);
0445 
0446 
0447 <span class="comment">% Viewing options window - AXES HANDLING</span>
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 
0450 <span class="comment">% If viewing window is open then check to see the axes options. But if the</span>
0451 <span class="comment">% window is not open then save computation time and default the axes to</span>
0452 <span class="comment">% tight around the data.</span>
0453 
0454 <span class="keyword">if</span> isfield(Handles,<span class="string">'ViewingOptions'</span>) &amp;&amp; Visible.ViewingOptions == 1
0455     
0456     <span class="comment">% If this is the first time a plot command is called then the Viewing</span>
0457     <span class="comment">% options Axes boxes will be blank ('-'). In which case we need to</span>
0458     <span class="comment">% update them to the current axes such that if the user then selects</span>
0459     <span class="comment">% Manual axes it makes sense.</span>
0460     <span class="keyword">if</span>  strcmp(get(hView.edit_maglow,<span class="string">'String'</span>),<span class="string">'-'</span>) &amp;&amp;  strcmp(get(hView.edit_maghigh,<span class="string">'String'</span>),<span class="string">'-'</span>)
0461         xLim = xlim(hcwView.viewer_axes);
0462         yLim = ylim(hcwView.viewer_axes);
0463         
0464         set(hView.edit_maglow ,<span class="string">'String'</span>,xLim(1));
0465         set(hView.edit_maghigh,<span class="string">'String'</span>,xLim(2));
0466         set(hView.edit_intlow ,<span class="string">'String'</span>,yLim(1));
0467         set(hView.edit_inthigh,<span class="string">'String'</span>,yLim(2));
0468     <span class="keyword">end</span>
0469     
0470     <span class="comment">% Evaluate button and change axes accordingly</span>
0471     <span class="keyword">switch</span> Var.View.Axes_Button
0472         <span class="keyword">case</span> <span class="string">'Automatic'</span>
0473             axis(hcwView.viewer_axes , <span class="string">'tight'</span>);
0474             
0475             xLim = xlim(hcwView.viewer_axes);
0476             yLim = ylim(hcwView.viewer_axes);
0477             
0478             set(hView.edit_maglow ,<span class="string">'String'</span>,num2str(xLim(1),4.3));
0479             set(hView.edit_maghigh,<span class="string">'String'</span>,num2str(xLim(2),4.3));
0480             set(hView.edit_intlow ,<span class="string">'String'</span>,num2str(yLim(1),4.3));
0481             set(hView.edit_inthigh,<span class="string">'String'</span>,num2str(yLim(2),4.3));
0482             
0483         <span class="keyword">case</span> <span class="string">'Manual'</span>
0484             <span class="keyword">try</span>
0485                 axis(hcwView.viewer_axes , <span class="keyword">...</span>
0486                     [ str2num(get(hView.edit_maglow ,<span class="string">'String'</span>)) , <span class="keyword">...</span>
0487                       str2num(get(hView.edit_maghigh,<span class="string">'String'</span>)) , <span class="keyword">...</span>
0488                       str2num(get(hView.edit_intlow ,<span class="string">'String'</span>)) , <span class="keyword">...</span>
0489                       str2num(get(hView.edit_inthigh,<span class="string">'String'</span>)) ])
0490             <span class="keyword">catch</span>
0491                 axis(hcwView.viewer_axes , <span class="string">'tight'</span>);
0492                 disp(<span class="string">'Manual axes have been selected, but not all boxes are filled or contain numbers'</span>)
0493             <span class="keyword">end</span>
0494     <span class="keyword">end</span>
0495     
0496 <span class="keyword">else</span>
0497     axis(hcwView.viewer_axes , <span class="string">'tight'</span>);
0498 
0499 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 25-Oct-2012 18:03:26 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>