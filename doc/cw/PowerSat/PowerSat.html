<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of PowerSat</title>
  <meta name="keywords" content="PowerSat">
  <meta name="description" content="POWERSAT Open, analyse and plot power saturation experiments">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">cw</a> &gt; <a href="index.html">PowerSat</a> &gt; PowerSat.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for cw/PowerSat&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>PowerSat
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>POWERSAT Open, analyse and plot power saturation experiments</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function varargout = PowerSat(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> POWERSAT Open, analyse and plot power saturation experiments
      POWERSAT, is designed as a complete solution for power saturation
      experiments. Taking raw spectra straight from the spectrometer and
      turning them into Power Saturation curves and accessibility
      parameters (Pi values) in seconds.

      POWERSAT, loads Bruker BES3T files either as a single file (actually
      3 files with the extensions .DTA / .DSC / .YGF extensions) or an
      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or
      the older Bruker format still used on EMX machines (.spc/.par). If a
      folder load method is used then each of the oxygen, nitrogen, NiEDDA
      and DPPH experiments data files need to be in a different folders.

      REFERENCES:
      ===========

      This calculations in this program are all derived from:
       Accessibility of Nitroxide Side Chains: Absolute Heisenberg
       Exchange Rates from Power Saturation EPR
       Biophysical Journal, vol 89 (2005) 2103 - 2112.
       DOI: 10.1529/biophysj.105.059063

      Equations for first and second derivative Gaussian and Lorentzian
       functions are taken from:
       http://www.hulinks.co.jp/software/peakfit/functions.html

      RELEASE NOTES:
      ==============

      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the
      fitting of the Gaussian or Lorentzian profiles to raw data as well
      as fitting power saturation curves. This is due to the CFtoolbox
      giving greater control and flexibility to fitting.

      POWERSAT v12.6 and before instead used the freely
      available toolbox EzyFit.
       www.fast.u-psud.fr/ezyfit/

      This method was discontinued as the EzyFit toolbox allows for no
      restriction of coefficient ranges during fitting. This often meant
      that during the fitting of the power saturation curves that a
      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;
      usually in the shape of a diagonal line with a loop in the middle.
      This problem whilst promised to be fixed in an upcoming release of
      Ezyfit (in personal correspondance with the author) has been
      outstanding for over a year.

      If users, do not wish to use the CFtoolbox then it is recommended to
      install a version of POWERSAT prior to v12.7, still available at:
      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download

      Demonstration videos are available on YouTube:
       Basic functionality - http://youtu.be/n8wWRzHoF-8
       Fitting options     - http://youtu.be/DstC7ysrYG0


 Syntax:  PowerSat

 Inputs:
    input1 - n/a

 Outputs:
    output1 - n/a

 Example: 
    see http://morganbye.net/PowerSat
        http://youtu.be/n8wWRzHoF-8
        http://youtu.be/DstC7ysrYG0

 Other m-files required:
    PowerSat.fig
    Curve Fitting Toolbox - fit, fittype, coeffvalues
    BrukerRead

 Subfunctions:         /_private (folder)

 MAT-files required:   none</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function menu_file_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function menu_open_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function menu_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function menu_close_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function menu_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function help_about_Callback(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = PowerSat(varargin)</a>
0002 <span class="comment">% POWERSAT Open, analyse and plot power saturation experiments</span>
0003 <span class="comment">%      POWERSAT, is designed as a complete solution for power saturation</span>
0004 <span class="comment">%      experiments. Taking raw spectra straight from the spectrometer and</span>
0005 <span class="comment">%      turning them into Power Saturation curves and accessibility</span>
0006 <span class="comment">%      parameters (Pi values) in seconds.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%      POWERSAT, loads Bruker BES3T files either as a single file (actually</span>
0009 <span class="comment">%      3 files with the extensions .DTA / .DSC / .YGF extensions) or an</span>
0010 <span class="comment">%      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or</span>
0011 <span class="comment">%      the older Bruker format still used on EMX machines (.spc/.par). If a</span>
0012 <span class="comment">%      folder load method is used then each of the oxygen, nitrogen, NiEDDA</span>
0013 <span class="comment">%      and DPPH experiments data files need to be in a different folders.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%      REFERENCES:</span>
0016 <span class="comment">%      ===========</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%      This calculations in this program are all derived from:</span>
0019 <span class="comment">%       Accessibility of Nitroxide Side Chains: Absolute Heisenberg</span>
0020 <span class="comment">%       Exchange Rates from Power Saturation EPR</span>
0021 <span class="comment">%       Biophysical Journal, vol 89 (2005) 2103 - 2112.</span>
0022 <span class="comment">%       DOI: 10.1529/biophysj.105.059063</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%      Equations for first and second derivative Gaussian and Lorentzian</span>
0025 <span class="comment">%       functions are taken from:</span>
0026 <span class="comment">%       http://www.hulinks.co.jp/software/peakfit/functions.html</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%      RELEASE NOTES:</span>
0029 <span class="comment">%      ==============</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the</span>
0032 <span class="comment">%      fitting of the Gaussian or Lorentzian profiles to raw data as well</span>
0033 <span class="comment">%      as fitting power saturation curves. This is due to the CFtoolbox</span>
0034 <span class="comment">%      giving greater control and flexibility to fitting.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%      POWERSAT v12.6 and before instead used the freely</span>
0037 <span class="comment">%      available toolbox EzyFit.</span>
0038 <span class="comment">%       www.fast.u-psud.fr/ezyfit/</span>
0039 <span class="comment">%</span>
0040 <span class="comment">%      This method was discontinued as the EzyFit toolbox allows for no</span>
0041 <span class="comment">%      restriction of coefficient ranges during fitting. This often meant</span>
0042 <span class="comment">%      that during the fitting of the power saturation curves that a</span>
0043 <span class="comment">%      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;</span>
0044 <span class="comment">%      usually in the shape of a diagonal line with a loop in the middle.</span>
0045 <span class="comment">%      This problem whilst promised to be fixed in an upcoming release of</span>
0046 <span class="comment">%      Ezyfit (in personal correspondance with the author) has been</span>
0047 <span class="comment">%      outstanding for over a year.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">%      If users, do not wish to use the CFtoolbox then it is recommended to</span>
0050 <span class="comment">%      install a version of POWERSAT prior to v12.7, still available at:</span>
0051 <span class="comment">%      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download</span>
0052 <span class="comment">%</span>
0053 <span class="comment">%      Demonstration videos are available on YouTube:</span>
0054 <span class="comment">%       Basic functionality - http://youtu.be/n8wWRzHoF-8</span>
0055 <span class="comment">%       Fitting options     - http://youtu.be/DstC7ysrYG0</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% Syntax:  PowerSat</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% Inputs:</span>
0061 <span class="comment">%    input1 - n/a</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Outputs:</span>
0064 <span class="comment">%    output1 - n/a</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% Example:</span>
0067 <span class="comment">%    see http://morganbye.net/PowerSat</span>
0068 <span class="comment">%        http://youtu.be/n8wWRzHoF-8</span>
0069 <span class="comment">%        http://youtu.be/DstC7ysrYG0</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% Other m-files required:</span>
0072 <span class="comment">%    PowerSat.fig</span>
0073 <span class="comment">%    Curve Fitting Toolbox - fit, fittype, coeffvalues</span>
0074 <span class="comment">%    BrukerRead</span>
0075 <span class="comment">%</span>
0076 <span class="comment">% Subfunctions:         /_private (folder)</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% MAT-files required:   none</span>
0079 <span class="comment">%</span>
0080 <span class="comment">%</span>
0081 
0082 <span class="comment">%                                        _                             _</span>
0083 <span class="comment">%                                       | |                           | |</span>
0084 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0085 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0086 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0087 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0088 <span class="comment">%                       __/ |                   __/ |</span>
0089 <span class="comment">%                      |___/                   |___/</span>
0090 <span class="comment">%</span>
0091 <span class="comment">%</span>
0092 <span class="comment">% M. Bye v13.04</span>
0093 <span class="comment">%</span>
0094 <span class="comment">% Author:       Morgan Bye</span>
0095 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0096 <span class="comment">%               University of East Anglia</span>
0097 <span class="comment">%               NORWICH, UK</span>
0098 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0099 <span class="comment">% Website:      http://www.morganbye.net/PowerSat</span>
0100 <span class="comment">% Mar 2013;     Last revision: 18-March-2013</span>
0101 <span class="comment">%</span>
0102 <span class="comment">% Version history:</span>
0103 <span class="comment">% Mar 13        &gt; When loading a file, check added to see if file has already</span>
0104 <span class="comment">%               been loaded. If so, erases previous file, preventing errors</span>
0105 <span class="comment">%               and allows for better file comparison.</span>
0106 <span class="comment">%               &gt; File &gt; Reset all now clears the old data files and axes</span>
0107 <span class="comment">%               instead of opening a new instance of PowerSat and closing</span>
0108 <span class="comment">%               the old one</span>
0109 <span class="comment">%               &gt; Changed PS_Pi so that Pi is calculated faster and</span>
0110 <span class="comment">%               calculated automatically if N2 and DPPH have been loaded,</span>
0111 <span class="comment">%               it does not wait for all 4 datasets to be loaded.</span>
0112 <span class="comment">%</span>
0113 <span class="comment">% Dec 12        &gt; Multiple fixes for folder loading, and then peak finding</span>
0114 <span class="comment">%                   and processing as multiple files may not necessarily</span>
0115 <span class="comment">%                   have the same x-axes</span>
0116 <span class="comment">%               &gt; Removed progressbar errors, replaced with waitbar</span>
0117 <span class="comment">%               &gt; Better figure saving and exporting</span>
0118 <span class="comment">%               &gt; Removed legacy code to EzyFit and error bar options from</span>
0119 <span class="comment">%                   when error bars were plotted as SDs of the data</span>
0120 <span class="comment">%</span>
0121 <span class="comment">% Aug 12        &gt; New Gaussian and Lorentzian derivative fitting methods</span>
0122 <span class="comment">%</span>
0123 <span class="comment">%               &gt; Change from Gaussian tickbox to a fitting dropdown menu</span>
0124 <span class="comment">%                   for Lorentzian fitting</span>
0125 <span class="comment">%</span>
0126 <span class="comment">% Jun 12        Another big overhaul of the PowerSat function</span>
0127 <span class="comment">%               &gt; New menu system</span>
0128 <span class="comment">%               &gt; Better loading and handling of files</span>
0129 <span class="comment">%               &gt; Bruker .DTA and .spc support</span>
0130 <span class="comment">%               &gt; Support for loading a folder of files, not just a 3D</span>
0131 <span class="comment">%                   Bruker BE3ST file (.DTA/.DSC/.YGF)</span>
0132 <span class="comment">%               &gt; EzyFit toolbox has been replaced with the MATLAB Curve</span>
0133 <span class="comment">%                   Fitting Toolbox for better fitting control</span>
0134 <span class="comment">%               &gt; Peak finding is now done via a Gaussian curve fit to the</span>
0135 <span class="comment">%                   data (this can be toggled in the Dataset Manipulation</span>
0136 <span class="comment">%                   panel - which replaces the digital smoothing function</span>
0137 <span class="comment">%                   used previously)</span>
0138 <span class="comment">%               &gt; Ability to save and later load a session without having</span>
0139 <span class="comment">%               to reload all the spectra files.</span>
0140 <span class="comment">%               &gt; Export the PowerSat curve data to the MATLAB workspace</span>
0141 <span class="comment">%</span>
0142 <span class="comment">% Oct 11        &gt; Massive overhaul of function into a &quot;modular&quot; form.</span>
0143 <span class="comment">%               Giving large speed increase, better maintaince and</span>
0144 <span class="comment">%               documentation.</span>
0145 <span class="comment">%               &gt; Removed ~ (tilde) variables from program, although it</span>
0146 <span class="comment">%               should work in all MATLAB (and does on Linux) it causes</span>
0147 <span class="comment">%               problems for Windows users.</span>
0148 <span class="comment">%               &gt; GUI objects moved, for better visualisation on Windows</span>
0149 <span class="comment">%</span>
0150 <span class="comment">% Sept 11       &gt; Removed need for external files by adding additional</span>
0151 <span class="comment">%               functions to end of file (except BrukerRead)</span>
0152 <span class="comment">%               &gt; Loaded spectra are autozeroed when displayed in Datasets</span>
0153 <span class="comment">%               window</span>
0154 <span class="comment">%               &gt; Datasets scrollbar only appears when individual plots are</span>
0155 <span class="comment">%               displayed</span>
0156 <span class="comment">%               &gt; &quot;Show all plots&quot; tick boxes removed and replaced by a</span>
0157 <span class="comment">%               view dropdown menu</span>
0158 <span class="comment">%               &gt; Plotting code stream lined and now with better error</span>
0159 <span class="comment">%               catching</span>
0160 <span class="comment">%               &gt; Digital smoothing feature of loaded spectra, useful for</span>
0161 <span class="comment">%               noisy spectra, but should be used carefully</span>
0162 <span class="comment">%               &gt; DPPH file load option, allows for &quot;Pi&quot; accessbility</span>
0163 <span class="comment">%               factor to be calculated</span>
0164 <span class="comment">%               &gt; Error bars added to Power Saturation curve data points,</span>
0165 <span class="comment">%               calculated by a standard deviation of the noise.</span>
0166 
0167 <span class="comment">% Last Modified by GUIDE v2.5 06-Aug-2012 15:46:18</span>
0168 
0169 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0170 gui_Singleton = 0;
0171 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0172                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0173                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)">PowerSat_OpeningFcn</a>, <span class="keyword">...</span>
0174                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = PowerSat_OutputFcn(hObject, eventdata, handles)">PowerSat_OutputFcn</a>, <span class="keyword">...</span>
0175                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0176                    <span class="string">'gui_Callback'</span>,   []);
0177 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0178     gui_State.gui_Callback = str2func(varargin{1});
0179 <span class="keyword">end</span>
0180 
0181 <span class="keyword">if</span> nargout
0182     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0183 <span class="keyword">else</span>
0184     gui_mainfcn(gui_State, varargin{:});
0185 <span class="keyword">end</span>
0186 <span class="comment">% End initialization code - DO NOT EDIT</span>
0187 
0188 
0189 <span class="comment">% --- Executes just before PowerSat is made visible.</span>
0190 <a name="_sub1" href="#_subfunctions" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0191 
0192 clear <span class="keyword">global</span> vars
0193 
0194 <span class="comment">% Check fitting program exists</span>
0195 <span class="keyword">if</span> exist(<span class="string">'cftool'</span>) == 0,
0196         warndlg(sprintf(<span class="string">'The Curve Fitting Toolbox could not be found on your system.\n\nWithout it this program will show very little functionality as the P1/2s cannot be calculated and no Gaussian fitting can be used\n\n'</span>),<span class="string">'Curve Fitting Toolbox missing'</span>)
0197  
0198 <span class="keyword">end</span>
0199  
0200 
0201 <span class="comment">% Choose default command line statusbar for PowerSat</span>
0202 handles.statusbar = hObject;
0203 
0204 <span class="comment">% Name the window</span>
0205 set(gcf,<span class="string">'Name'</span>,<span class="string">'PowerSat - v13.04'</span>);
0206 
0207 <span class="comment">% Update handles structure</span>
0208 <span class="comment">% set(hObject,'toolbar','figure');</span>
0209 set(handles.panel_Plot,<span class="string">'SelectionChangeFcn'</span>,@<a href="#_sub3" class="code" title="subfunction panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)">panel_Plot_SelectionChangeFcn</a>);
0210 
0211 axes(handles.plot_load);
0212 xlabel(<span class="string">'Magnetic Field / Gauss'</span>);
0213 ylabel(<span class="string">'Intensity'</span>);
0214 
0215 axes(handles.plot_PS);
0216 xlabel(<span class="string">'\surd Microwave Power / mW^Â½'</span>);
0217 ylabel(<span class="string">'Y'' / arb. units'</span>);
0218 
0219 set(handles.slider1,<span class="string">'Value'</span>,1);
0220 set(handles.slider1,<span class="string">'Min'</span>,1);
0221 set(handles.slider1,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0222 
0223 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0224 
0225 guidata(hObject, handles);
0226 
0227 <span class="comment">% UIWAIT makes PowerSat wait for user response (see UIRESUME)</span>
0228 <span class="comment">% uiwait(handles.figure1);</span>
0229 
0230 
0231 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0232 <a name="_sub2" href="#_subfunctions" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles) </a>
0233 
0234 varargout{1} = handles.statusbar;
0235 
0236 
0237 <span class="comment">%          ===================================================</span>
0238 <span class="comment">%          ===================================================</span>
0239 <span class="comment">%                     Dataset Manipulation Panel</span>
0240 <span class="comment">%          ===================================================</span>
0241 <span class="comment">%          ===================================================</span>
0242 
0243 
0244 <span class="comment">% ===================================================</span>
0245 <span class="comment">% Radio Buttons</span>
0246 <span class="comment">% ===================================================</span>
0247 
0248 <span class="comment">% --- Radio buttons in Plot Selection</span>
0249 <a name="_sub3" href="#_subfunctions" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a>
0250 
0251 handles = guidata(hObject); 
0252 
0253 set(handles.slider1,<span class="string">'Value'</span>,1);
0254 PS_Plot1(handles)
0255 
0256 guidata(hObject, handles);
0257 
0258 <span class="comment">% ===================================================</span>
0259 <span class="comment">% User input (text fields)</span>
0260 <span class="comment">% ===================================================</span>
0261 
0262 <span class="comment">% Oxygen</span>
0263 <span class="comment">% ===================================================</span>
0264 
0265 <a name="_sub4" href="#_subfunctions" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a>
0266 
0267 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)     <span class="comment">% Select Oxy</span>
0268 
0269 input = str2num(get(hObject,<span class="string">'String'</span>));     <span class="comment">% Convert input to number</span>
0270 
0271 <span class="keyword">if</span> (isempty(input))                         <span class="comment">% If empty then catch</span>
0272      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0273 <span class="keyword">else</span>
0274     <span class="keyword">global</span> vars
0275     vars.Oxy.MaxPeak = input;
0276 <span class="keyword">end</span>
0277 
0278 PS_Plot1(handles)                           <span class="comment">% Replot with new values</span>
0279 PS_PlotPS(handles);
0280 
0281 guidata(hObject, handles);
0282 
0283 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0284 <a name="_sub5" href="#_subfunctions" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a>
0285 
0286 
0287 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0288 <span class="comment">%       See ISPC and COMPUTER.</span>
0289 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0290     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0291 <span class="keyword">end</span>
0292 
0293 
0294 
0295 <a name="_sub6" href="#_subfunctions" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a>
0296 
0297 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)
0298 
0299 input = str2num(get(hObject,<span class="string">'String'</span>));
0300 
0301 <span class="keyword">if</span> (isempty(input))
0302      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0303 <span class="keyword">else</span>
0304     <span class="keyword">global</span> vars
0305     vars.Oxy.MinPeak = input;
0306 <span class="keyword">end</span>
0307 
0308 PS_Plot1(handles)
0309 PS_PlotPS(handles);
0310 
0311 guidata(hObject, handles);
0312 
0313 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0314 <a name="_sub7" href="#_subfunctions" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a>
0315 
0316 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0317 <span class="comment">%       See ISPC and COMPUTER.</span>
0318 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0319     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0320 <span class="keyword">end</span>
0321 
0322 
0323 <span class="comment">% Nitrogen</span>
0324 <span class="comment">% ===================================================</span>
0325 
0326 <a name="_sub8" href="#_subfunctions" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a>
0327 
0328 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0329 
0330 input = str2num(get(hObject,<span class="string">'String'</span>));
0331 
0332 <span class="keyword">if</span> (isempty(input))
0333      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0334 <span class="keyword">else</span>
0335     <span class="keyword">global</span> vars
0336     vars.N2.MaxPeak = input;
0337 <span class="keyword">end</span>
0338 
0339 PS_Plot1(handles)
0340 PS_PlotPS(handles);
0341 
0342 guidata(hObject, handles);
0343 
0344 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0345 <a name="_sub9" href="#_subfunctions" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a>
0346 
0347 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0348     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0349 <span class="keyword">end</span>
0350 
0351 
0352 
0353 <a name="_sub10" href="#_subfunctions" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a>
0354 
0355 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0356 
0357 input = str2num(get(hObject,<span class="string">'String'</span>));
0358 
0359 <span class="keyword">if</span> (isempty(input))
0360      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0361 <span class="keyword">else</span>
0362     <span class="keyword">global</span> vars
0363     vars.N2.MinPeak = input;
0364 <span class="keyword">end</span>
0365 
0366 PS_Plot1(handles)
0367 PS_PlotPS(handles);
0368 
0369 guidata(hObject, handles);
0370 
0371 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0372 <a name="_sub11" href="#_subfunctions" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a>
0373 
0374 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0375     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0376 <span class="keyword">end</span>
0377 
0378 
0379 <span class="comment">% NiEDDA</span>
0380 <span class="comment">% ===================================================</span>
0381 
0382 <a name="_sub12" href="#_subfunctions" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a>
0383 
0384 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0385 
0386 input = str2num(get(hObject,<span class="string">'String'</span>));
0387 
0388 <span class="keyword">if</span> (isempty(input))
0389      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0390 <span class="keyword">else</span>
0391     <span class="keyword">global</span> vars
0392     vars.Ni.MaxPeak = input;
0393 <span class="keyword">end</span>
0394 
0395 PS_Plot1(handles)
0396 PS_PlotPS(handles);
0397 
0398 guidata(hObject, handles);
0399 
0400 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0401 <a name="_sub13" href="#_subfunctions" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a>
0402 
0403 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0404     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0405 <span class="keyword">end</span>
0406 
0407 
0408 
0409 <a name="_sub14" href="#_subfunctions" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a>
0410 
0411 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0412 
0413 input = str2num(get(hObject,<span class="string">'String'</span>));
0414 
0415 <span class="keyword">if</span> (isempty(input))
0416      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0417 <span class="keyword">else</span>
0418     <span class="keyword">global</span> vars
0419     vars.Ni.MinPeak = input;
0420 <span class="keyword">end</span>
0421 
0422 PS_Plot1(handles)
0423 PS_PlotPS(handles);
0424 
0425 guidata(hObject, handles);
0426 
0427 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0428 <a name="_sub15" href="#_subfunctions" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a>
0429 
0430 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0431     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0432 <span class="keyword">end</span>
0433 
0434 
0435 
0436 <span class="comment">% DPPH</span>
0437 <span class="comment">% ===================================================</span>
0438 
0439 <a name="_sub16" href="#_subfunctions" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a>
0440 
0441 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0442 
0443 input = str2num(get(hObject,<span class="string">'String'</span>));
0444 
0445 <span class="keyword">if</span> (isempty(input))
0446      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0447 <span class="keyword">else</span>
0448     <span class="keyword">global</span> vars
0449     vars.DPPH.MaxPeak = input;
0450 <span class="keyword">end</span>
0451 
0452 PS_Plot1(handles)
0453 PS_PlotPS(handles);
0454 
0455 guidata(hObject, handles);
0456 
0457 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0458 <a name="_sub17" href="#_subfunctions" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a>
0459 
0460 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0461     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0462 <span class="keyword">end</span>
0463 
0464 
0465 
0466 <a name="_sub18" href="#_subfunctions" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a>
0467 
0468 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0469 
0470 input = str2num(get(hObject,<span class="string">'String'</span>));
0471 
0472 <span class="keyword">if</span> (isempty(input))
0473      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0474 <span class="keyword">else</span>
0475     <span class="keyword">global</span> vars
0476     vars.DPPH.MinPeak = input;
0477 <span class="keyword">end</span>
0478 
0479 PS_Plot1(handles)
0480 PS_PlotPS(handles);
0481 
0482 guidata(hObject, handles);
0483 
0484 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0485 <a name="_sub19" href="#_subfunctions" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a>
0486 
0487 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0488     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0489 <span class="keyword">end</span>
0490 
0491 
0492 
0493 
0494 <span class="comment">%          ===================================================</span>
0495 <span class="comment">%          ===================================================</span>
0496 <span class="comment">%                     Dataset Manipulation Panel</span>
0497 <span class="comment">%          ===================================================</span>
0498 <span class="comment">%          ===================================================</span>
0499 
0500 <span class="comment">% --- Executes on button press in checkbox_autozero.</span>
0501 <a name="_sub20" href="#_subfunctions" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a>
0502 
0503 PS_Plot1(handles);
0504 PS_PlotPS(handles);
0505 
0506 
0507 
0508 <span class="comment">% --- Executes on selection change in dropdown_fitting.</span>
0509 <a name="_sub21" href="#_subfunctions" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a>
0510 
0511 PS_Plot1(handles);
0512 PS_PlotPS(handles);
0513 
0514 
0515 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0516 <a name="_sub22" href="#_subfunctions" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a>
0517 
0518 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0519     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0520 <span class="keyword">end</span>
0521 
0522 
0523 <a name="_sub23" href="#_subfunctions" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a>
0524 
0525 PS_Plot1(handles);
0526 PS_PlotPS(handles);
0527 
0528 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0529 <a name="_sub24" href="#_subfunctions" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a>
0530 
0531 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0532     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0533 <span class="keyword">end</span>
0534 
0535 
0536 
0537 <span class="comment">%          ===================================================</span>
0538 <span class="comment">%          ===================================================</span>
0539 <span class="comment">%                        Viewing options panel</span>
0540 <span class="comment">%          ===================================================</span>
0541 <span class="comment">%          ===================================================</span>
0542 
0543 
0544 <a name="_sub25" href="#_subfunctions" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a>
0545 
0546 PS_Plot1(handles);
0547 
0548 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0549 <a name="_sub26" href="#_subfunctions" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a>
0550 
0551 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0552     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0553 <span class="keyword">end</span>
0554 
0555 
0556 <span class="comment">% --- Executes on selection change in dropdown_view.</span>
0557 <a name="_sub27" href="#_subfunctions" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a>
0558 
0559 PS_Plot1(handles);
0560 
0561 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0562 <a name="_sub28" href="#_subfunctions" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a>
0563 
0564 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0565     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0566 <span class="keyword">end</span>
0567 
0568 
0569 <span class="comment">%          ===================================================</span>
0570 <span class="comment">%          ===================================================</span>
0571 <span class="comment">%                          Spectra Panel</span>
0572 <span class="comment">%          ===================================================</span>
0573 <span class="comment">%          ===================================================</span>
0574 
0575 
0576 <span class="comment">% --- Executes on Slider movement.</span>
0577 <a name="_sub29" href="#_subfunctions" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a>
0578 
0579 PS_Plot1(handles)
0580 
0581 
0582 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0583 <a name="_sub30" href="#_subfunctions" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a>
0584 
0585 <span class="keyword">if</span> isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0586     set(hObject,<span class="string">'BackgroundColor'</span>,[.9 .9 .9]);
0587 <span class="keyword">end</span>
0588 
0589 
0590 
0591 <span class="comment">%          ===================================================</span>
0592 <span class="comment">%          ===================================================</span>
0593 <span class="comment">%                        PS Curves Panel</span>
0594 <span class="comment">%          ===================================================</span>
0595 <span class="comment">%          ===================================================</span>
0596 
0597 
0598 <span class="comment">% No options here.</span>
0599 
0600 
0601 <span class="comment">%          ===================================================</span>
0602 <span class="comment">%          ===================================================</span>
0603 <span class="comment">%                        PS Options Panel</span>
0604 <span class="comment">%          ===================================================</span>
0605 <span class="comment">%          ===================================================</span>
0606 
0607 <span class="comment">% --- Executes on button press in checkbox_PSfits.</span>
0608 <a name="_sub31" href="#_subfunctions" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a>
0609 
0610 PS_PlotPS(handles);
0611 
0612 
0613 <span class="comment">% --- Executes on button press in checkbox_errorbars.</span>
0614 <a name="_sub32" href="#_subfunctions" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a>
0615 
0616 PS_PlotPS(handles);
0617 
0618 
0619 
0620 <span class="comment">%          ===================================================</span>
0621 <span class="comment">%          ===================================================</span>
0622 <span class="comment">%                             PS Data Panel</span>
0623 <span class="comment">%          ===================================================</span>
0624 <span class="comment">%          ===================================================</span>
0625 
0626 <span class="comment">% Oxygen</span>
0627 <span class="comment">% ===================================================</span>
0628 
0629 <a name="_sub33" href="#_subfunctions" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a>
0630 
0631 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0632 <a name="_sub34" href="#_subfunctions" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a>
0633 
0634 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0635     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0636 <span class="keyword">end</span>
0637 
0638 
0639 
0640 <a name="_sub35" href="#_subfunctions" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a>
0641 
0642 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0643 <a name="_sub36" href="#_subfunctions" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a>
0644 
0645 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0646     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0647 <span class="keyword">end</span>
0648 
0649 
0650 <a name="_sub37" href="#_subfunctions" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a>
0651 
0652 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0653 <a name="_sub38" href="#_subfunctions" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a>
0654 
0655 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0656     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0657 <span class="keyword">end</span>
0658 
0659 
0660 
0661 <a name="_sub39" href="#_subfunctions" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a>
0662 
0663 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0664 <a name="_sub40" href="#_subfunctions" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a>
0665 
0666 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0667     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0668 <span class="keyword">end</span>
0669 
0670 
0671 <span class="comment">% Nitrogen</span>
0672 <span class="comment">% ===================================================</span>
0673 
0674 <a name="_sub41" href="#_subfunctions" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a>
0675 
0676 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0677 <a name="_sub42" href="#_subfunctions" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a>
0678 
0679 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0680     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0681 <span class="keyword">end</span>
0682 
0683 
0684 
0685 <a name="_sub43" href="#_subfunctions" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a>
0686 
0687 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0688 <a name="_sub44" href="#_subfunctions" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a>
0689 
0690 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0691     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0692 <span class="keyword">end</span>
0693 
0694 
0695 
0696 <a name="_sub45" href="#_subfunctions" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a>
0697 
0698 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0699 <a name="_sub46" href="#_subfunctions" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a>
0700 
0701 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0702     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0703 <span class="keyword">end</span>
0704 
0705 
0706 
0707 <a name="_sub47" href="#_subfunctions" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a>
0708 
0709 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0710 <a name="_sub48" href="#_subfunctions" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a>
0711 
0712 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0713     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0714 <span class="keyword">end</span>
0715 
0716 
0717 <span class="comment">% NiEDDA</span>
0718 <span class="comment">% ===================================================</span>
0719 
0720 <a name="_sub49" href="#_subfunctions" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a>
0721 
0722 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0723 <a name="_sub50" href="#_subfunctions" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a>
0724 
0725 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0726     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0727 <span class="keyword">end</span>
0728 
0729 
0730 
0731 <a name="_sub51" href="#_subfunctions" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a>
0732 
0733 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0734 <a name="_sub52" href="#_subfunctions" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a>
0735 
0736 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0737     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0738 <span class="keyword">end</span>
0739 
0740 
0741 
0742 <a name="_sub53" href="#_subfunctions" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a>
0743 
0744 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0745 <a name="_sub54" href="#_subfunctions" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a>
0746 
0747 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0748     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0749 <span class="keyword">end</span>
0750 
0751 
0752 
0753 <a name="_sub55" href="#_subfunctions" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a>
0754 
0755 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0756 <a name="_sub56" href="#_subfunctions" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a>
0757 
0758 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0759     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0760 <span class="keyword">end</span>
0761 
0762 
0763 <span class="comment">%          ===================================================</span>
0764 <span class="comment">%          ===================================================</span>
0765 <span class="comment">%                     Accessibility Panel</span>
0766 <span class="comment">%          ===================================================</span>
0767 <span class="comment">%          ===================================================</span>
0768 
0769 
0770 <a name="_sub57" href="#_subfunctions" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a>
0771 
0772 <a name="_sub58" href="#_subfunctions" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a>
0773 
0774 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0775     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0776 <span class="keyword">end</span>
0777 
0778 
0779 
0780 <a name="_sub59" href="#_subfunctions" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a>
0781 
0782 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0783 <a name="_sub60" href="#_subfunctions" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a>
0784 
0785 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0786     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0787 <span class="keyword">end</span>
0788 
0789 
0790 
0791 <a name="_sub61" href="#_subfunctions" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a>
0792 
0793 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0794 <a name="_sub62" href="#_subfunctions" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a>
0795 
0796 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0797     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0798 <span class="keyword">end</span>
0799 
0800 
0801 
0802 <span class="comment">%          ===================================================</span>
0803 <span class="comment">%          ===================================================</span>
0804 <span class="comment">%                                Menu</span>
0805 <span class="comment">%          ===================================================</span>
0806 <span class="comment">%          ===================================================</span>
0807 
0808 
0809 <span class="comment">% File</span>
0810 <span class="comment">% ===================================================</span>
0811 
0812 <span class="comment">% --------------------------------------------------------------------</span>
0813 <a name="_sub63" href="#_subfunctions" class="code">function menu_file_Callback(hObject, eventdata, handles)</a>
0814 
0815 <span class="comment">% --------------------------------------------------------------------</span>
0816 <a name="_sub64" href="#_subfunctions" class="code">function menu_open_Callback(hObject, eventdata, handles)</a>
0817 
0818 <span class="keyword">global</span> vars
0819 
0820 <span class="comment">% GUI get file</span>
0821 [file , directory] = uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="string">'Load PowerSat file'</span>);
0822 address = [directory,file];
0823 
0824 <span class="comment">% Load variable</span>
0825 load(address , <span class="string">'vars'</span>);
0826 
0827 <span class="comment">% Update plots</span>
0828 PS_Plot1(handles);
0829 
0830 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
0831     set(handles.button_DPPHSelect ,<span class="string">'Value'</span>,1)
0832     set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
0833     set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
0834 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Ni'</span>)
0835     set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
0836     set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
0837     set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
0838 <span class="keyword">elseif</span> isfield(vars,<span class="string">'N2'</span>)
0839     set(handles.button_N2Select ,<span class="string">'Value'</span>,1)
0840     set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
0841     set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
0842 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Oxy'</span>)
0843     set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
0844     set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0845     set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0846 <span class="keyword">else</span>
0847     <span class="keyword">return</span>
0848 <span class="keyword">end</span>
0849 
0850 PS_PlotPS(handles);
0851 
0852 
0853 
0854 
0855 <span class="comment">% --------------------------------------------------------------------</span>
0856 <a name="_sub65" href="#_subfunctions" class="code">function menu_save_Callback(hObject, eventdata, handles)</a>
0857 
0858 <span class="keyword">global</span> vars
0859 
0860 [file, pathname] = uiputfile({ <span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0861         <span class="string">'Save PowerSat as'</span>,<span class="string">'default'</span>);
0862     
0863 address = [pathname file];
0864 
0865 save(address,<span class="string">'vars'</span>);
0866 
0867 
0868 <span class="comment">% --------------------------------------------------------------------</span>
0869 <a name="_sub66" href="#_subfunctions" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a>
0870 
0871 
0872 <span class="comment">% OLD METHOD: basically calls a new figure on top of old</span>
0873 
0874 <span class="comment">% closeGUI = handles.figure1;                     % handles.figure1 is the GUI figure</span>
0875 <span class="comment">%</span>
0876 <span class="comment">% guiPosition = get(handles.figure1,'Position');  % get the position of the GUI</span>
0877 <span class="comment">% guiName = get(handles.figure1,'Name');          % get the name of the GUI</span>
0878 <span class="comment">% eval('PowerSat')                                % call the GUI again</span>
0879 <span class="comment">%</span>
0880 <span class="comment">% close(closeGUI);                                % close the old GUI</span>
0881 <span class="comment">% set(gcf,'Position',guiPosition);                % set the position for the new GUI</span>
0882 <span class="comment">%</span>
0883 <span class="comment">% clear global</span>
0884 
0885 <span class="comment">% NEW METHOD: clear variables, reset axes</span>
0886 
0887 close = questdlg(<span class="keyword">...</span>
0888     <span class="string">'Are you sure you want to reset PowerSat? This will clear all unsaved data.'</span>,<span class="keyword">...</span>
0889     <span class="string">'Reset PowerSat?'</span>,<span class="keyword">...</span>
0890     <span class="string">'Yes'</span>,<span class="keyword">...</span>
0891     <span class="string">'No'</span>,<span class="keyword">...</span>
0892     <span class="string">'Yes'</span>);
0893 
0894 <span class="keyword">switch</span> strcmp(close,<span class="string">'Yes'</span>)
0895     <span class="keyword">case</span> 1
0896         
0897         <span class="keyword">global</span> vars
0898         vars.Oxy = [];
0899         vars.N2 = [];
0900         vars.Ni = [];
0901         vars.DPPH = [];
0902         
0903         cla(handles.plot_load);
0904         xlabel(<span class="string">'Magnetic Field / Gauss'</span>);
0905         ylabel(<span class="string">'Intensity'</span>);
0906         
0907         cla(handles.plot_PS);
0908         xlabel(<span class="string">'\surd Microwave Power / mW^Â½'</span>);
0909         ylabel(<span class="string">'Y'' / arb. units'</span>);
0910         
0911         set(handles.edit_OxyHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0912         set(handles.edit_OxyLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0913         set(handles.edit_N2High,<span class="string">'String'</span>,<span class="string">'-'</span>);
0914         set(handles.edit_N2Low,<span class="string">'String'</span>,<span class="string">'-'</span>);
0915         set(handles.edit_NiHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0916         set(handles.edit_NiLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0917         set(handles.edit_DPPHHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0918         set(handles.edit_DPPHLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0919         
0920         set(handles.button_OxySelect ,<span class="string">'Value'</span>,1);
0921         set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0922         set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0923 
0924         set(handles.CFOxyP,<span class="string">'String'</span>,<span class="string">'-'</span>);
0925         set(handles.CFOxyA,<span class="string">'String'</span>,<span class="string">'-'</span>);
0926         set(handles.CFOxyB,<span class="string">'String'</span>,<span class="string">'-'</span>);
0927         set(handles.CFOxyR,<span class="string">'String'</span>,<span class="string">'-'</span>);
0928         set(handles.CFN2P,<span class="string">'String'</span>,<span class="string">'-'</span>);
0929         set(handles.CFN2A,<span class="string">'String'</span>,<span class="string">'-'</span>);
0930         set(handles.CFN2B,<span class="string">'String'</span>,<span class="string">'-'</span>);
0931         set(handles.CFN2R,<span class="string">'String'</span>,<span class="string">'-'</span>);
0932         set(handles.CFNiP,<span class="string">'String'</span>,<span class="string">'-'</span>);
0933         set(handles.CFNiA,<span class="string">'String'</span>,<span class="string">'-'</span>);
0934         set(handles.CFNiB,<span class="string">'String'</span>,<span class="string">'-'</span>);
0935         set(handles.CFNiR,<span class="string">'String'</span>,<span class="string">'-'</span>);
0936 
0937         set(handles.edit_pi_Oxy,<span class="string">'String'</span>,<span class="string">'-'</span>);
0938         set(handles.edit_pi_Ni,<span class="string">'String'</span>,<span class="string">'-'</span>);
0939   
0940     <span class="keyword">case</span> 0
0941         
0942 <span class="keyword">end</span>
0943 
0944 
0945 
0946 
0947 <span class="comment">% --------------------------------------------------------------------</span>
0948 <a name="_sub67" href="#_subfunctions" class="code">function menu_close_Callback(hObject, eventdata, handles)</a>
0949 
0950 figure1_CloseRequestFcn
0951 
0952 
0953 
0954 <span class="comment">% Datasets</span>
0955 <span class="comment">% ===================================================</span>
0956 
0957 <span class="comment">% --------------------------------------------------------------------</span>
0958 <a name="_sub68" href="#_subfunctions" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a>
0959 
0960 
0961 <span class="comment">% --------------------------------------------------------------------</span>
0962 <a name="_sub69" href="#_subfunctions" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a>
0963 
0964 
0965 <span class="comment">% --------------------------------------------------------------------</span>
0966 <a name="_sub70" href="#_subfunctions" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a>
0967 
0968 <span class="keyword">global</span> vars
0969 <span class="comment">% This creates a structure or overwrites an old one</span>
0970 vars.Oxy = [];
0971 
0972 <span class="comment">% Set defaults</span>
0973 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1);
0974 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0975 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0976 
0977 <span class="comment">% Load and plot file</span>
0978 PS_FileLoad(<span class="string">'Oxy'</span>,<span class="string">'file'</span>);
0979 PS_Plot1(handles);
0980 
0981 <span class="comment">% Update data boxes in GUI</span>
0982 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0983 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0984 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0985 
0986 PS_PlotPS(handles);
0987 
0988 guidata(hObject, handles);
0989 
0990 
0991 <span class="comment">% --------------------------------------------------------------------</span>
0992 <a name="_sub71" href="#_subfunctions" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a>
0993 
0994 <span class="keyword">global</span> vars
0995 <span class="comment">% This creates a structure or overwrites an old one</span>
0996 vars.Oxy = [];
0997 
0998 <span class="comment">% Set defaults</span>
0999 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
1000 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1001 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1002 
1003 <span class="comment">% Load and plot file</span>
1004 PS_FileLoad(<span class="string">'Oxy'</span>,<span class="string">'folder'</span>);
1005 PS_Plot1(handles);
1006 
1007 <span class="comment">% Update data boxes in GUI</span>
1008 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1009 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
1010 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
1011 
1012 PS_PlotPS(handles);
1013 
1014 guidata(hObject, handles);
1015 
1016 
1017 <span class="comment">% --------------------------------------------------------------------</span>
1018 <a name="_sub72" href="#_subfunctions" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a>
1019 
1020 
1021 <span class="comment">% --------------------------------------------------------------------</span>
1022 <a name="_sub73" href="#_subfunctions" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a>
1023 
1024 <span class="keyword">global</span> vars
1025 <span class="comment">% This creates a structure or overwrites an old one</span>
1026 vars.N2 = [];
1027 
1028 <span class="comment">% Set defaults</span>
1029 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
1030 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1031 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1032 
1033 <span class="comment">% Load and plot file</span>
1034 PS_FileLoad(<span class="string">'N2'</span>,<span class="string">'file'</span>);
1035 PS_Plot1(handles);
1036 
1037 <span class="comment">% Update data boxes in GUI</span>
1038 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1039 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
1040 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
1041 
1042 PS_PlotPS(handles);
1043 
1044 guidata(hObject, handles);
1045 
1046 <span class="comment">% --------------------------------------------------------------------</span>
1047 <a name="_sub74" href="#_subfunctions" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a>
1048 
1049 <span class="keyword">global</span> vars
1050 <span class="comment">% This creates a structure or overwrites an old one</span>
1051 vars.N2 = [];
1052 
1053 <span class="comment">% Set defaults</span>
1054 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
1055 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1056 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1057 
1058 <span class="comment">% Load and plot file</span>
1059 PS_FileLoad(<span class="string">'N2'</span>,<span class="string">'folder'</span>);
1060 PS_Plot1(handles);
1061 
1062 <span class="comment">% Update data boxes in GUI</span>
1063 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1064 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
1065 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
1066 
1067 PS_PlotPS(handles);
1068 
1069 guidata(hObject, handles);
1070 
1071 <span class="comment">% --------------------------------------------------------------------</span>
1072 <a name="_sub75" href="#_subfunctions" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a>
1073 
1074 <span class="comment">% --------------------------------------------------------------------</span>
1075 <a name="_sub76" href="#_subfunctions" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a>
1076 
1077 <span class="keyword">global</span> vars
1078 <span class="comment">% This creates a structure or overwrites an old one</span>
1079 vars.Ni = [];
1080 
1081 <span class="comment">% Set defaults</span>
1082 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1083 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1084 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1085 
1086 <span class="comment">% Load and plot file</span>
1087 PS_FileLoad(<span class="string">'Ni'</span>,<span class="string">'file'</span>);
1088 PS_Plot1(handles);
1089 
1090 <span class="comment">% Update data boxes in GUI</span>
1091 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1092 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1093 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1094 
1095 PS_PlotPS(handles);
1096 
1097 guidata(hObject, handles);
1098 
1099 <span class="comment">% --------------------------------------------------------------------</span>
1100 <a name="_sub77" href="#_subfunctions" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a>
1101 
1102 <span class="keyword">global</span> vars
1103 <span class="comment">% This creates a structure or overwrites an old one</span>
1104 vars.Ni = [];
1105 
1106 <span class="comment">% Set defaults</span>
1107 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1108 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1109 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1110 
1111 <span class="comment">% Load and plot file</span>
1112 PS_FileLoad(<span class="string">'Ni'</span>,<span class="string">'folder'</span>);
1113 PS_Plot1(handles);
1114 
1115 <span class="comment">% Update data boxes in GUI</span>
1116 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1117 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1118 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1119 
1120 PS_PlotPS(handles);
1121 
1122 guidata(hObject, handles);
1123 
1124 <span class="comment">% --------------------------------------------------------------------</span>
1125 <a name="_sub78" href="#_subfunctions" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a>
1126 
1127 <span class="comment">% --------------------------------------------------------------------</span>
1128 <a name="_sub79" href="#_subfunctions" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a>
1129 
1130 <span class="keyword">global</span> vars
1131 <span class="comment">% This creates a structure or overwrites an old one</span>
1132 vars.DPPH = [];
1133 
1134 <span class="comment">% Set defaults</span>
1135 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1136 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1137 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1138 
1139 <span class="comment">% Load and plot file</span>
1140 PS_FileLoad(<span class="string">'DPPH'</span>,<span class="string">'file'</span>);
1141 PS_Plot1(handles);
1142 
1143 <span class="comment">% Update data boxes in GUI</span>
1144 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1145 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1146 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1147 
1148 PS_PlotPS(handles);
1149 
1150 guidata(hObject, handles);
1151 
1152 
1153 <span class="comment">% --------------------------------------------------------------------</span>
1154 <a name="_sub80" href="#_subfunctions" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a>
1155 
1156 <span class="keyword">global</span> vars
1157 <span class="comment">% This creates a structure or overwrites an old one</span>
1158 vars.DPPH = [];
1159 
1160 <span class="comment">% Set defaults</span>
1161 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1162 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1163 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1164 
1165 <span class="comment">% Load and plot file</span>
1166 PS_FileLoad(<span class="string">'DPPH'</span>,<span class="string">'folder'</span>);
1167 PS_Plot1(handles);
1168 
1169 <span class="comment">% Update data boxes in GUI</span>
1170 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1171 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1172 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1173 
1174 PS_PlotPS(handles);
1175 
1176 guidata(hObject, handles);
1177 
1178 
1179 <span class="comment">% Spectra</span>
1180 <span class="comment">% ===================================================</span>
1181 
1182 <span class="comment">% --------------------------------------------------------------------</span>
1183 <a name="_sub81" href="#_subfunctions" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a>
1184 
1185 
1186 <span class="comment">% --------------------------------------------------------------------</span>
1187 <a name="_sub82" href="#_subfunctions" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a>
1188 
1189 cla(handles.plot_load,<span class="string">'reset'</span>);
1190 guidata(hObject, handles);
1191 
1192 
1193 <span class="comment">% --------------------------------------------------------------------</span>
1194 <a name="_sub83" href="#_subfunctions" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a>
1195 
1196 <span class="keyword">global</span> vars
1197 
1198 <span class="comment">% if get(handles.checkbox_Gauss,'Value')</span>
1199 <span class="comment">%     if isfield(vars,'DPPH')</span>
1200 <span class="comment">%         PS_Plot1_Gaussian(handles,'DPPH')</span>
1201 <span class="comment">%     end</span>
1202 <span class="comment">%     if isfield(vars,'Ni')</span>
1203 <span class="comment">%         PS_Plot1_Gaussian(handles,'Ni')</span>
1204 <span class="comment">%     end</span>
1205 <span class="comment">%     if isfield(vars,'N2')</span>
1206 <span class="comment">%         PS_Plot1_Gaussian(handles,'N2')</span>
1207 <span class="comment">%     end</span>
1208 <span class="comment">%     if isfield(vars,'Oxy')</span>
1209 <span class="comment">%         PS_Plot1_Gaussian(handles,'Oxy')</span>
1210 <span class="comment">%     end</span>
1211 <span class="comment">% end</span>
1212 
1213 PS_Plot1(handles);
1214 PS_PlotPS(handles);
1215 
1216 
1217 <span class="comment">% --------------------------------------------------------------------</span>
1218 <a name="_sub84" href="#_subfunctions" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a>
1219 
1220 PS_DetachPlot(handles.plot_load);
1221 
1222 
1223 <span class="comment">% --------------------------------------------------------------------</span>
1224 <a name="_sub85" href="#_subfunctions" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a>
1225 
1226 PS_SavePlot(handles.plot_load);
1227 
1228 
1229 
1230 <span class="comment">% PowerSat</span>
1231 <span class="comment">% ===================================================</span>
1232 
1233 <span class="comment">% --------------------------------------------------------------------</span>
1234 <a name="_sub86" href="#_subfunctions" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a>
1235 
1236 <span class="comment">% --------------------------------------------------------------------</span>
1237 <a name="_sub87" href="#_subfunctions" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a>
1238 
1239 <span class="keyword">global</span> vars
1240 
1241 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
1242     out.Y           = vars.DPPH.Y;
1243     out.sqrtPower   = vars.DPPH.sqrtPower;
1244     out.FitResults  = vars.DPPH.FitResults;
1245     
1246     assignin(<span class="string">'base'</span>,<span class="string">'DPPH'</span>,out)
1247 <span class="keyword">end</span>
1248 <span class="keyword">if</span> isfield(vars,<span class="string">'Ni'</span>)
1249     out.Y           = vars.Ni.Y;
1250     out.sqrtPower   = vars.Ni.sqrtPower;
1251     out.FitResults  = vars.Ni.FitResults;
1252     
1253     assignin(<span class="string">'base'</span>,<span class="string">'Ni'</span>,out)
1254 <span class="keyword">end</span>
1255 <span class="keyword">if</span> isfield(vars,<span class="string">'N2'</span>)
1256     out.Y           = vars.N2.Y;
1257     out.sqrtPower   = vars.N2.sqrtPower;
1258     out.FitResults  = vars.N2.FitResults;
1259     
1260     assignin(<span class="string">'base'</span>,<span class="string">'N2'</span>,out)
1261 <span class="keyword">end</span>
1262 <span class="keyword">if</span> isfield(vars,<span class="string">'Oxy'</span>)
1263     out.Y           = vars.Oxy.Y;
1264     out.sqrtPower   = vars.Oxy.sqrtPower;
1265     out.FitResults  = vars.Oxy.FitResults;
1266     
1267     assignin(<span class="string">'base'</span>,<span class="string">'Oxy'</span>,out)
1268 <span class="keyword">end</span>
1269 
1270 
1271 
1272 <span class="comment">% --------------------------------------------------------------------</span>
1273 <a name="_sub88" href="#_subfunctions" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a>
1274 
1275 PS_PlotPS(handles);
1276 
1277 
1278 <span class="comment">% --------------------------------------------------------------------</span>
1279 <a name="_sub89" href="#_subfunctions" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a>
1280 
1281 PS_DetachPlot(handles.plot_PS);
1282 
1283 <span class="comment">% --------------------------------------------------------------------</span>
1284 <a name="_sub90" href="#_subfunctions" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a>
1285 
1286 PS_SavePlot(handles.plot_PS);
1287 
1288 
1289 <span class="comment">% --------------------------------------------------------------------</span>
1290 <a name="_sub91" href="#_subfunctions" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a>
1291 
1292 cla(handles.plot_PS,<span class="string">'reset'</span>);
1293 guidata(hObject, handles);
1294 
1295 <span class="comment">% Help</span>
1296 <span class="comment">% ===================================================</span>
1297 
1298 <span class="comment">% --------------------------------------------------------------------</span>
1299 <a name="_sub92" href="#_subfunctions" class="code">function menu_help_Callback(hObject, eventdata, handles)</a>
1300 
1301 
1302 <span class="comment">% --------------------------------------------------------------------</span>
1303 <a name="_sub93" href="#_subfunctions" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a>
1304 
1305 PS_Help_Help;
1306 
1307 
1308 <span class="comment">% --------------------------------------------------------------------</span>
1309 <a name="_sub94" href="#_subfunctions" class="code">function help_about_Callback(hObject, eventdata, handles)</a>
1310 
1311 PS_Help_About;</pre></div>
<hr><address>Generated on Fri 05-Apr-2013 12:00:44 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>