<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of DeerConverter</title>
  <meta name="keywords" content="DeerConverter">
  <meta name="description" content="DEERCONVERTER Takes a DEERAnalysis distance distribution figure and">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">pulsed</a> &gt; DeerConverter.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for pulsed&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>DeerConverter
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>DEERCONVERTER Takes a DEERAnalysis distance distribution figure and</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [x,y] = DeerConverter(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> DEERCONVERTER Takes a DEERAnalysis distance distribution figure and
 outputs the figure into a numerical variables for MATLAB calculations.

 This requires that you save your DeerAnalysis experiment using the 'Save'
 button in the 'Data sets' box on the right hand side of the screen

 Syntax:  [x,y] = DEERCONVERTER()

 Inputs:
    input1 - A file
               A saved file from DeerAnalysis ending in _distr.dat

 Outputs:
    output1 - x
               The distance in nm
    output2 - y
               The intensity

 Example: 
    [x,y] = DEERCONVERTER
    [x,y] = DEERCONVERTER('path/to/file_distr.dat')

 Other m-files required:
                       none

 Subfunctions:         none

 MAT-files required:   none</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [x,y] = DeerConverter(varargin)</a>
0002 
0003 <span class="comment">% DEERCONVERTER Takes a DEERAnalysis distance distribution figure and</span>
0004 <span class="comment">% outputs the figure into a numerical variables for MATLAB calculations.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% This requires that you save your DeerAnalysis experiment using the 'Save'</span>
0007 <span class="comment">% button in the 'Data sets' box on the right hand side of the screen</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Syntax:  [x,y] = DEERCONVERTER()</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% Inputs:</span>
0012 <span class="comment">%    input1 - A file</span>
0013 <span class="comment">%               A saved file from DeerAnalysis ending in _distr.dat</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Outputs:</span>
0016 <span class="comment">%    output1 - x</span>
0017 <span class="comment">%               The distance in nm</span>
0018 <span class="comment">%    output2 - y</span>
0019 <span class="comment">%               The intensity</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Example:</span>
0022 <span class="comment">%    [x,y] = DEERCONVERTER</span>
0023 <span class="comment">%    [x,y] = DEERCONVERTER('path/to/file_distr.dat')</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% Other m-files required:</span>
0026 <span class="comment">%                       none</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% Subfunctions:         none</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% MAT-files required:   none</span>
0031 <span class="comment">%</span>
0032 <span class="comment">%</span>
0033 
0034 <span class="comment">%                                        _                             _</span>
0035 <span class="comment">%                                       | |                           | |</span>
0036 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0037 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0038 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0039 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0040 <span class="comment">%                       __/ |                   __/ |</span>
0041 <span class="comment">%                      |___/                   |___/</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% M. Bye v13.09</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% v13.09 - current</span>
0046 <span class="comment">%               Chemical Physics Department</span>
0047 <span class="comment">%               Weizmann Institute of Science</span>
0048 <span class="comment">%               76100 REHOVOT, Israel</span>
0049 <span class="comment">%</span>
0050 <span class="comment">% v11.06 - v13.08</span>
0051 <span class="comment">%               Henry Wellcome Unit for Biological EPR</span>
0052 <span class="comment">%               University of East Anglia</span>
0053 <span class="comment">%               NORWICH, UK</span>
0054 <span class="comment">%</span>
0055 <span class="comment">% Email:        morgan.bye@weizmann.ac.il</span>
0056 <span class="comment">% Website:      http://morganbye.net/eprtoolbox/</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% Last updated  18-June-2012</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% Version history:</span>
0061 <span class="comment">% Dec 12        &gt; Fix for 0 arguments in error</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Jun 12        &gt; Error handling added if user cancels file loading through</span>
0064 <span class="comment">%                   GUI, so as not to report error to command window</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% Dec 11        &gt; Conversion to function. Allows for single file input and</span>
0067 <span class="comment">%                   gives x and y outputs.</span>
0068 <span class="comment">% May 11        &gt; Initial release</span>
0069 
0070 <span class="comment">%% Inputs</span>
0071 <span class="comment">% =======</span>
0072 <span class="keyword">switch</span> nargin
0073     <span class="keyword">case</span> 0
0074         [name, path] = uigetfile({<span class="string">'*_distr.dat'</span>,<span class="string">'DeerAnalysis Distance Distribution File (*_distr.dat)'</span>},<span class="string">'Load DeerAnalysis file'</span>);
0075         
0076         <span class="comment">% if user cancels command nothing happens</span>
0077         <span class="keyword">if</span> isequal(name,0) <span class="comment">%|| isequal(directory,0)</span>
0078             <span class="keyword">return</span>
0079         <span class="keyword">end</span>
0080         
0081         <span class="comment">% File name/path manipulation</span>
0082         address = [path,name];
0083         
0084     <span class="keyword">case</span> 1
0085         address = varargin{1};
0086         
0087         <span class="keyword">if</span> ~exist(address,<span class="string">'file'</span>)
0088             error(<span class="string">'The file entered was not recognised, please try again'</span>)
0089             <span class="keyword">return</span>
0090         <span class="keyword">end</span>
0091 <span class="keyword">end</span>
0092 
0093 <span class="comment">%% File loading</span>
0094 <span class="comment">% =============</span>
0095 
0096 [dir,name,extension] = fileparts(address);
0097 name = name(1:end-6);
0098         
0099 file_bckg   = [path <span class="string">'/'</span> name <span class="string">'_bckg.dat'</span>];
0100 file_distr  = [path <span class="string">'/'</span> name <span class="string">'_distr.dat'</span>];
0101 file_fit    = [path <span class="string">'/'</span> name <span class="string">'_fit.dat'</span>];
0102 file_Lcurve = [path <span class="string">'/'</span> name <span class="string">'_Lcurve.dat'</span>];
0103 
0104 data_bckg   = importdata(file_bckg);
0105 data_distr  = importdata(file_distr);
0106 data_fit    = importdata(file_fit);
0107 data_Lcurve = importdata(file_Lcurve);
0108 
0109 <span class="comment">%% Data processing</span>
0110 x.raw.time = data_bckg(:,1);
0111 y.raw.real = data_bckg(:,2);
0112 y.raw.fit  = data_bckg(:,3);
0113 <span class="keyword">try</span>
0114     y.bckg.imag = data_bckg(:,4);
0115 <span class="keyword">end</span>
0116 
0117 x.distr.distance    = data_distr(:,1);
0118 y.distr.probability = data_distr(:,2);
0119 
0120 x.fit.time      = data_fit(:,1);
0121 y.fit.intensity = data_fit(:,2);
0122 y.fit.fit       = data_fit(:,3);
0123 
0124 x.Lcurve.p      = data_Lcurve(:,1);
0125 y.Lcurve.n      = data_Lcurve(:,2);
0126 y.Lcurve.RegPar = data_Lcurve(:,3);
0127 
0128 
0129 <span class="comment">%% Figure plotting</span>
0130 <span class="comment">% ================</span>
0131 
0132 hF = figure(<span class="string">'pos'</span>,[0 0 900 300]);
0133         
0134 <span class="comment">% Plot raw data</span>
0135 h1 = subplot(2,2,1);
0136 plot(x.raw.time,y.raw.real);
0137 
0138 h2 = subplot(2,2,2);
0139 plot(x.fit.time,y.fit.intensity,x.fit.time,y.fit.fit,<span class="string">'r'</span>)
0140 
0141 h3 = subplot(2,2,3);
0142 plot(x.Lcurve.p,y.Lcurve.n,<span class="string">'bo'</span>)
0143 
0144 h4 = subplot(2,2,4);
0145 plot(x.distr.distance,y.distr.probability);
0146 
0147 xlabel(h1,<span class="string">'Time / \mus'</span>);
0148 xlabel(h2,<span class="string">'Time / \mus'</span>);
0149 xlabel(h3,<span class="string">'\it{log(\rho)}'</span>);
0150 xlabel(h4,<span class="string">'r / nm'</span>);
0151 
0152 ylabel(h1,<span class="string">'Normalized Intensity / arb. unit'</span>);
0153 ylabel(h2,<span class="string">'Normalized Intensity / arb. unit'</span>);
0154 ylabel(h3,<span class="string">'\it{log(\eta)}'</span>);
0155 ylabel(h4,<span class="string">'\it{p(r)}'</span>);
0156 
0157 axis(h1,<span class="string">'tight'</span>);
0158 axis(h2,<span class="string">'tight'</span>);
0159 axis(h3,<span class="string">'tight'</span>);
0160 axis(h4,<span class="string">'tight'</span>);
0161 
0162 title(h1,<span class="string">'4-pulse PELDOR experiment'</span>,<span class="string">'FontSize'</span>,12);
0163 title(h2,<span class="string">'Background subtracted PELDOR trace'</span>,<span class="string">'FontSize'</span>,12);
0164 title(h3,<span class="string">'L-curve analysis from Tikhonov regularisation'</span>,<span class="string">'FontSize'</span>,12);
0165 title(h4,<span class="string">'Distance distribution'</span>,<span class="string">'FontSize'</span>,12);
0166 
0167 set(h4,<span class="string">'YTick'</span>,[]);
0168 
0169 set(hF,<span class="string">'color'</span>, <span class="string">'white'</span>);
0170 
0171 set(hF,<span class="string">'PaperUnits'</span>,<span class="string">'centimeters'</span>);
0172 set(hF,<span class="string">'PaperSize'</span>,[30 25]);
0173 set(hF,<span class="string">'PaperPosition'</span>, [0 0 30 25]);
0174 
0175 print(gcf, <span class="string">'-dpdf'</span>,  [path <span class="string">'/'</span> name <span class="string">'-DC.pdf'</span>]);
0176 
0177 close(hF);</pre></div>
<hr><address>Generated on Sun 07-Sep-2014 15:05:40 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>