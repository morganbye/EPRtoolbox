<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of PowerSat</title>
  <meta name="keywords" content="PowerSat">
  <meta name="description" content="POWERSAT Open, analyse and plot power saturation experiments">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">EPRtoolbox</a> &gt; <a href="../index.html">cw</a> &gt; <a href="index.html">PowerSat</a> &gt; PowerSat.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for EPRtoolbox/cw/PowerSat&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>PowerSat
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>POWERSAT Open, analyse and plot power saturation experiments</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function varargout = PowerSat(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> POWERSAT Open, analyse and plot power saturation experiments
      POWERSAT, is designed as a complete solution for power saturation
      experiments. Taking raw spectra straight from the spectrometer and
      turning them into Power Saturation curves and accessibility
      parameters (Pi values) in seconds.

      POWERSAT, loads Bruker BES3T files either as a single file (actually
      3 files with the extensions .DTA / .DSC / .YGF extensions) or an
      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or
      the older Bruker format still used on EMX machines (.spc/.par). If a
      folder load method is used then each of the oxygen, nitrogen, NiEDDA
      and DPPH experiments data files need to be in a different folders.

      REFERENCES:
      ===========

      This calculations in this program are all derived from:
       Accessibility of Nitroxide Side Chains: Absolute Heisenberg
       Exchange Rates from Power Saturation EPR
       Biophysical Journal, vol 89 (2005) 2103 - 2112.
       DOI: 10.1529/biophysj.105.059063

      Equations for first and second derivative Gaussian and Lorentzian
       functions are taken from:
       http://www.hulinks.co.jp/software/peakfit/functions.html

      RELEASE NOTES:
      ==============

      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the
      fitting of the Gaussian or Lorentzian profiles to raw data as well
      as fitting power saturation curves. This is due to the CFtoolbox
      giving greater control and flexibility to fitting.

      POWERSAT v12.6 and before instead used the freely
      available toolbox EzyFit.
       www.fast.u-psud.fr/ezyfit/

      This method was discontinued as the EzyFit toolbox allows for no
      restriction of coefficient ranges during fitting. This often meant
      that during the fitting of the power saturation curves that a
      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;
      usually in the shape of a diagonal line with a loop in the middle.
      This problem whilst promised to be fixed in an upcoming release of
      Ezyfit (in personal correspondance with the author) has been
      outstanding for over a year.

      If users, do not wish to use the CFtoolbox then it is recommended to
      install a version of POWERSAT prior to v12.7, still available at:
      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download

      Demonstration videos are available on YouTube:
       Basic functionality - http://youtu.be/n8wWRzHoF-8
       Fitting options     - http://youtu.be/DstC7ysrYG0


 Syntax:  PowerSat

 Inputs:
    input1 - n/a

 Outputs:
    output1 - n/a

 Example: 
    see http://morganbye.net/PowerSat
        http://youtu.be/n8wWRzHoF-8
        http://youtu.be/DstC7ysrYG0

 Other m-files required:
    PowerSat.fig
    Curve Fitting Toolbox - fit, fittype, coeffvalues
    BrukerRead

 Subfunctions:         /_private (folder)

 MAT-files required:   none</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_DetachPlot.html" class="code" title="function PS_DetachPlot(axesObject)">PS_DetachPlot</a>	PS_DETACHPLOT Export a plot from within the GUI</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_ExportToOrigin.html" class="code" title="function PS_ExportToOrigin(handles)">PS_ExportToOrigin</a>	PS_EXPORTTOORIGIN Export the power saturation spectra to an Origin</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>	PS_FileLoad Load power saturation experiments</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Help_About.html" class="code" title="function PS_Help_About">PS_Help_About</a>	PS_Help</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Help_Help.html" class="code" title="function PS_Help_Help">PS_Help_Help</a>	PS_Help</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>	PS_PLOT1 Plot the raw power saturation spectra</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>	PS_PLOTPS Plot the power saturation curves</li><li><a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_SavePlot.html" class="code" title="function PS_SavePlot(axesObject)">PS_SavePlot</a>	PS_SAVEPLOT Export a plot from within the GUI</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function menu_file_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function menu_open_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function menu_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function menu_close_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function menu_PS_Origin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function menu_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function help_about_Callback(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = PowerSat(varargin)</a>
0002 <span class="comment">% POWERSAT Open, analyse and plot power saturation experiments</span>
0003 <span class="comment">%      POWERSAT, is designed as a complete solution for power saturation</span>
0004 <span class="comment">%      experiments. Taking raw spectra straight from the spectrometer and</span>
0005 <span class="comment">%      turning them into Power Saturation curves and accessibility</span>
0006 <span class="comment">%      parameters (Pi values) in seconds.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%      POWERSAT, loads Bruker BES3T files either as a single file (actually</span>
0009 <span class="comment">%      3 files with the extensions .DTA / .DSC / .YGF extensions) or an</span>
0010 <span class="comment">%      entire folder of files (with the Bruker BES3T format (.DTA/.DSC) or</span>
0011 <span class="comment">%      the older Bruker format still used on EMX machines (.spc/.par). If a</span>
0012 <span class="comment">%      folder load method is used then each of the oxygen, nitrogen, NiEDDA</span>
0013 <span class="comment">%      and DPPH experiments data files need to be in a different folders.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%      REFERENCES:</span>
0016 <span class="comment">%      ===========</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%      This calculations in this program are all derived from:</span>
0019 <span class="comment">%       Accessibility of Nitroxide Side Chains: Absolute Heisenberg</span>
0020 <span class="comment">%       Exchange Rates from Power Saturation EPR</span>
0021 <span class="comment">%       Biophysical Journal, vol 89 (2005) 2103 - 2112.</span>
0022 <span class="comment">%       DOI: 10.1529/biophysj.105.059063</span>
0023 <span class="comment">%</span>
0024 <span class="comment">%      Equations for first and second derivative Gaussian and Lorentzian</span>
0025 <span class="comment">%       functions are taken from:</span>
0026 <span class="comment">%       http://www.hulinks.co.jp/software/peakfit/functions.html</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%      RELEASE NOTES:</span>
0029 <span class="comment">%      ==============</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%      Since POWERSAT v12.7 uses MATLAB's Curve Fitting toolbox for the</span>
0032 <span class="comment">%      fitting of the Gaussian or Lorentzian profiles to raw data as well</span>
0033 <span class="comment">%      as fitting power saturation curves. This is due to the CFtoolbox</span>
0034 <span class="comment">%      giving greater control and flexibility to fitting.</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%      POWERSAT v12.6 and before instead used the freely</span>
0037 <span class="comment">%      available toolbox EzyFit.</span>
0038 <span class="comment">%       www.fast.u-psud.fr/ezyfit/</span>
0039 <span class="comment">%</span>
0040 <span class="comment">%      This method was discontinued as the EzyFit toolbox allows for no</span>
0041 <span class="comment">%      restriction of coefficient ranges during fitting. This often meant</span>
0042 <span class="comment">%      that during the fitting of the power saturation curves that a</span>
0043 <span class="comment">%      local minima for &quot;a&quot; was found below zero, giving an incorrect fit;</span>
0044 <span class="comment">%      usually in the shape of a diagonal line with a loop in the middle.</span>
0045 <span class="comment">%      This problem whilst promised to be fixed in an upcoming release of</span>
0046 <span class="comment">%      Ezyfit (in personal correspondance with the author) has been</span>
0047 <span class="comment">%      outstanding for over a year.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">%      If users, do not wish to use the CFtoolbox then it is recommended to</span>
0050 <span class="comment">%      install a version of POWERSAT prior to v12.7, still available at:</span>
0051 <span class="comment">%      http://sourceforge.net/projects/eprtoolbox/files/PowerSat/PowerSat_v11.11.zip/download</span>
0052 <span class="comment">%</span>
0053 <span class="comment">%      Demonstration videos are available on YouTube:</span>
0054 <span class="comment">%       Basic functionality - http://youtu.be/n8wWRzHoF-8</span>
0055 <span class="comment">%       Fitting options     - http://youtu.be/DstC7ysrYG0</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% Syntax:  PowerSat</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% Inputs:</span>
0061 <span class="comment">%    input1 - n/a</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% Outputs:</span>
0064 <span class="comment">%    output1 - n/a</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% Example:</span>
0067 <span class="comment">%    see http://morganbye.net/PowerSat</span>
0068 <span class="comment">%        http://youtu.be/n8wWRzHoF-8</span>
0069 <span class="comment">%        http://youtu.be/DstC7ysrYG0</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% Other m-files required:</span>
0072 <span class="comment">%    PowerSat.fig</span>
0073 <span class="comment">%    Curve Fitting Toolbox - fit, fittype, coeffvalues</span>
0074 <span class="comment">%    BrukerRead</span>
0075 <span class="comment">%</span>
0076 <span class="comment">% Subfunctions:         /_private (folder)</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% MAT-files required:   none</span>
0079 <span class="comment">%</span>
0080 <span class="comment">%</span>
0081 
0082 <span class="comment">%                                        _                             _</span>
0083 <span class="comment">%                                       | |                           | |</span>
0084 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0085 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0086 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0087 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0088 <span class="comment">%                       __/ |                   __/ |</span>
0089 <span class="comment">%                      |___/                   |___/</span>
0090 <span class="comment">%</span>
0091 <span class="comment">%</span>
0092 <span class="comment">% M. Bye v13.08</span>
0093 <span class="comment">%</span>
0094 <span class="comment">% Author:       Morgan Bye</span>
0095 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0096 <span class="comment">%               University of East Anglia</span>
0097 <span class="comment">%               NORWICH, UK</span>
0098 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0099 <span class="comment">% Website:      http://www.morganbye.net/PowerSat</span>
0100 <span class="comment">% Aug 2013;     Last revision: 05-August-2013</span>
0101 <span class="comment">%</span>
0102 <span class="comment">% Version history:</span>
0103 <span class="comment">% Aug 13        &gt; Added web URL to title bar</span>
0104 <span class="comment">%               &gt; Help option opens web browser to PowerSat page</span>
0105 <span class="comment">%</span>
0106 <span class="comment">% Jul 13        Added an &quot;Export to Origin&quot; option in the PowerSat Curves</span>
0107 <span class="comment">%                   menu. This will export the current power saturation</span>
0108 <span class="comment">%                   curves into an Origin friendly file that includes the</span>
0109 <span class="comment">%                   data points, error bars and fit lines.</span>
0110 <span class="comment">%</span>
0111 <span class="comment">%</span>
0112 <span class="comment">% Mar 13        &gt; When loading a file, check added to see if file has already</span>
0113 <span class="comment">%               been loaded. If so, erases previous file, preventing errors</span>
0114 <span class="comment">%               and allows for better file comparison.</span>
0115 <span class="comment">%               &gt; File &gt; Reset all now clears the old data files and axes</span>
0116 <span class="comment">%               instead of opening a new instance of PowerSat and closing</span>
0117 <span class="comment">%               the old one</span>
0118 <span class="comment">%               &gt; Changed PS_Pi so that Pi is calculated faster and</span>
0119 <span class="comment">%               calculated automatically if N2 and DPPH have been loaded,</span>
0120 <span class="comment">%               it does not wait for all 4 datasets to be loaded.</span>
0121 <span class="comment">%</span>
0122 <span class="comment">% Dec 12        &gt; Multiple fixes for folder loading, and then peak finding</span>
0123 <span class="comment">%                   and processing as multiple files may not necessarily</span>
0124 <span class="comment">%                   have the same x-axes</span>
0125 <span class="comment">%               &gt; Removed progressbar errors, replaced with waitbar</span>
0126 <span class="comment">%               &gt; Better figure saving and exporting</span>
0127 <span class="comment">%               &gt; Removed legacy code to EzyFit and error bar options from</span>
0128 <span class="comment">%                   when error bars were plotted as SDs of the data</span>
0129 <span class="comment">%</span>
0130 <span class="comment">% Aug 12        &gt; New Gaussian and Lorentzian derivative fitting methods</span>
0131 <span class="comment">%</span>
0132 <span class="comment">%               &gt; Change from Gaussian tickbox to a fitting dropdown menu</span>
0133 <span class="comment">%                   for Lorentzian fitting</span>
0134 <span class="comment">%</span>
0135 <span class="comment">% Jun 12        Another big overhaul of the PowerSat function</span>
0136 <span class="comment">%               &gt; New menu system</span>
0137 <span class="comment">%               &gt; Better loading and handling of files</span>
0138 <span class="comment">%               &gt; Bruker .DTA and .spc support</span>
0139 <span class="comment">%               &gt; Support for loading a folder of files, not just a 3D</span>
0140 <span class="comment">%                   Bruker BE3ST file (.DTA/.DSC/.YGF)</span>
0141 <span class="comment">%               &gt; EzyFit toolbox has been replaced with the MATLAB Curve</span>
0142 <span class="comment">%                   Fitting Toolbox for better fitting control</span>
0143 <span class="comment">%               &gt; Peak finding is now done via a Gaussian curve fit to the</span>
0144 <span class="comment">%                   data (this can be toggled in the Dataset Manipulation</span>
0145 <span class="comment">%                   panel - which replaces the digital smoothing function</span>
0146 <span class="comment">%                   used previously)</span>
0147 <span class="comment">%               &gt; Ability to save and later load a session without having</span>
0148 <span class="comment">%               to reload all the spectra files.</span>
0149 <span class="comment">%               &gt; Export the PowerSat curve data to the MATLAB workspace</span>
0150 <span class="comment">%</span>
0151 <span class="comment">% Oct 11        &gt; Massive overhaul of function into a &quot;modular&quot; form.</span>
0152 <span class="comment">%               Giving large speed increase, better maintaince and</span>
0153 <span class="comment">%               documentation.</span>
0154 <span class="comment">%               &gt; Removed ~ (tilde) variables from program, although it</span>
0155 <span class="comment">%               should work in all MATLAB (and does on Linux) it causes</span>
0156 <span class="comment">%               problems for Windows users.</span>
0157 <span class="comment">%               &gt; GUI objects moved, for better visualisation on Windows</span>
0158 <span class="comment">%</span>
0159 <span class="comment">% Sept 11       &gt; Removed need for external files by adding additional</span>
0160 <span class="comment">%               functions to end of file (except BrukerRead)</span>
0161 <span class="comment">%               &gt; Loaded spectra are autozeroed when displayed in Datasets</span>
0162 <span class="comment">%               window</span>
0163 <span class="comment">%               &gt; Datasets scrollbar only appears when individual plots are</span>
0164 <span class="comment">%               displayed</span>
0165 <span class="comment">%               &gt; &quot;Show all plots&quot; tick boxes removed and replaced by a</span>
0166 <span class="comment">%               view dropdown menu</span>
0167 <span class="comment">%               &gt; Plotting code stream lined and now with better error</span>
0168 <span class="comment">%               catching</span>
0169 <span class="comment">%               &gt; Digital smoothing feature of loaded spectra, useful for</span>
0170 <span class="comment">%               noisy spectra, but should be used carefully</span>
0171 <span class="comment">%               &gt; DPPH file load option, allows for &quot;Pi&quot; accessbility</span>
0172 <span class="comment">%               factor to be calculated</span>
0173 <span class="comment">%               &gt; Error bars added to Power Saturation curve data points,</span>
0174 <span class="comment">%               calculated by a standard deviation of the noise.</span>
0175 
0176 <span class="comment">% Last Modified by GUIDE v2.5 17-Jul-2013 16:39:01</span>
0177 
0178 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0179 gui_Singleton = 0;
0180 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0181                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0182                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)">PowerSat_OpeningFcn</a>, <span class="keyword">...</span>
0183                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = PowerSat_OutputFcn(hObject, eventdata, handles)">PowerSat_OutputFcn</a>, <span class="keyword">...</span>
0184                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0185                    <span class="string">'gui_Callback'</span>,   []);
0186 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0187     gui_State.gui_Callback = str2func(varargin{1});
0188 <span class="keyword">end</span>
0189 
0190 <span class="keyword">if</span> nargout
0191     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0192 <span class="keyword">else</span>
0193     gui_mainfcn(gui_State, varargin{:});
0194 <span class="keyword">end</span>
0195 <span class="comment">% End initialization code - DO NOT EDIT</span>
0196 
0197 
0198 <span class="comment">% --- Executes just before PowerSat is made visible.</span>
0199 <a name="_sub1" href="#_subfunctions" class="code">function PowerSat_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0200 
0201 clear <span class="keyword">global</span> vars
0202 
0203 <span class="comment">% Check fitting program exists</span>
0204 <span class="keyword">if</span> exist(<span class="string">'cftool'</span>) == 0,
0205         warndlg(sprintf(<span class="string">'The Curve Fitting Toolbox could not be found on your system.\n\nWithout it this program will show very little functionality as the P1/2s cannot be calculated and no Gaussian fitting can be used\n\n'</span>),<span class="string">'Curve Fitting Toolbox missing'</span>)
0206  
0207 <span class="keyword">end</span>
0208  
0209 
0210 <span class="comment">% Choose default command line statusbar for PowerSat</span>
0211 handles.statusbar = hObject;
0212 
0213 <span class="comment">% Name the window</span>
0214 set(gcf,<span class="string">'Name'</span>,<span class="string">'PowerSat - v13.08 - morganbye.net/PowerSat'</span>);
0215 
0216 <span class="comment">% Update handles structure</span>
0217 <span class="comment">% set(hObject,'toolbar','figure');</span>
0218 set(handles.panel_Plot,<span class="string">'SelectionChangeFcn'</span>,@<a href="#_sub3" class="code" title="subfunction panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)">panel_Plot_SelectionChangeFcn</a>);
0219 
0220 axes(handles.plot_load);
0221 xlabel(<span class="string">'Magnetic Field / Gauss'</span>);
0222 ylabel(<span class="string">'Intensity'</span>);
0223 
0224 axes(handles.plot_PS);
0225 xlabel(<span class="string">'\surd Microwave Power / mW^Â½'</span>);
0226 ylabel(<span class="string">'Y'' / arb. units'</span>);
0227 
0228 set(handles.slider1,<span class="string">'Value'</span>,1);
0229 set(handles.slider1,<span class="string">'Min'</span>,1);
0230 set(handles.slider1,<span class="string">'Visible'</span>,<span class="string">'off'</span>);
0231 
0232 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0233 
0234 guidata(hObject, handles);
0235 
0236 <span class="comment">% UIWAIT makes PowerSat wait for user response (see UIRESUME)</span>
0237 <span class="comment">% uiwait(handles.figure1);</span>
0238 
0239 
0240 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0241 <a name="_sub2" href="#_subfunctions" class="code">function varargout = PowerSat_OutputFcn(hObject, eventdata, handles) </a>
0242 
0243 varargout{1} = handles.statusbar;
0244 
0245 
0246 <span class="comment">%          ===================================================</span>
0247 <span class="comment">%          ===================================================</span>
0248 <span class="comment">%                     Dataset Manipulation Panel</span>
0249 <span class="comment">%          ===================================================</span>
0250 <span class="comment">%          ===================================================</span>
0251 
0252 
0253 <span class="comment">% ===================================================</span>
0254 <span class="comment">% Radio Buttons</span>
0255 <span class="comment">% ===================================================</span>
0256 
0257 <span class="comment">% --- Radio buttons in Plot Selection</span>
0258 <a name="_sub3" href="#_subfunctions" class="code">function panel_Plot_SelectionChangeFcn(hObject, eventdata, handles)</a>
0259 
0260 handles = guidata(hObject); 
0261 
0262 set(handles.slider1,<span class="string">'Value'</span>,1);
0263 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0264 
0265 guidata(hObject, handles);
0266 
0267 <span class="comment">% ===================================================</span>
0268 <span class="comment">% User input (text fields)</span>
0269 <span class="comment">% ===================================================</span>
0270 
0271 <span class="comment">% Oxygen</span>
0272 <span class="comment">% ===================================================</span>
0273 
0274 <a name="_sub4" href="#_subfunctions" class="code">function edit_OxyHigh_Callback(hObject, eventdata, handles)</a>
0275 
0276 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)     <span class="comment">% Select Oxy</span>
0277 
0278 input = str2num(get(hObject,<span class="string">'String'</span>));     <span class="comment">% Convert input to number</span>
0279 
0280 <span class="keyword">if</span> (isempty(input))                         <span class="comment">% If empty then catch</span>
0281      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0282 <span class="keyword">else</span>
0283     <span class="keyword">global</span> vars
0284     vars.Oxy.MaxPeak = input;
0285 <span class="keyword">end</span>
0286 
0287 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)                           <span class="comment">% Replot with new values</span>
0288 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0289 
0290 guidata(hObject, handles);
0291 
0292 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0293 <a name="_sub5" href="#_subfunctions" class="code">function edit_OxyHigh_CreateFcn(hObject, eventdata, handles)</a>
0294 
0295 
0296 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0297 <span class="comment">%       See ISPC and COMPUTER.</span>
0298 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0299     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0300 <span class="keyword">end</span>
0301 
0302 
0303 
0304 <a name="_sub6" href="#_subfunctions" class="code">function edit_OxyLow_Callback(hObject, eventdata, handles)</a>
0305 
0306 set(handles.button_OxySelect,<span class="string">'Value'</span>,1)
0307 
0308 input = str2num(get(hObject,<span class="string">'String'</span>));
0309 
0310 <span class="keyword">if</span> (isempty(input))
0311      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0312 <span class="keyword">else</span>
0313     <span class="keyword">global</span> vars
0314     vars.Oxy.MinPeak = input;
0315 <span class="keyword">end</span>
0316 
0317 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0318 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0319 
0320 guidata(hObject, handles);
0321 
0322 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0323 <a name="_sub7" href="#_subfunctions" class="code">function edit_OxyLow_CreateFcn(hObject, eventdata, handles)</a>
0324 
0325 <span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
0326 <span class="comment">%       See ISPC and COMPUTER.</span>
0327 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0328     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0329 <span class="keyword">end</span>
0330 
0331 
0332 <span class="comment">% Nitrogen</span>
0333 <span class="comment">% ===================================================</span>
0334 
0335 <a name="_sub8" href="#_subfunctions" class="code">function edit_N2High_Callback(hObject, eventdata, handles)</a>
0336 
0337 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0338 
0339 input = str2num(get(hObject,<span class="string">'String'</span>));
0340 
0341 <span class="keyword">if</span> (isempty(input))
0342      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0343 <span class="keyword">else</span>
0344     <span class="keyword">global</span> vars
0345     vars.N2.MaxPeak = input;
0346 <span class="keyword">end</span>
0347 
0348 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0349 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0350 
0351 guidata(hObject, handles);
0352 
0353 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0354 <a name="_sub9" href="#_subfunctions" class="code">function edit_N2High_CreateFcn(hObject, eventdata, handles)</a>
0355 
0356 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0357     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0358 <span class="keyword">end</span>
0359 
0360 
0361 
0362 <a name="_sub10" href="#_subfunctions" class="code">function edit_N2Low_Callback(hObject, eventdata, handles)</a>
0363 
0364 set(handles.button_N2Select,<span class="string">'Value'</span>,1)
0365 
0366 input = str2num(get(hObject,<span class="string">'String'</span>));
0367 
0368 <span class="keyword">if</span> (isempty(input))
0369      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0370 <span class="keyword">else</span>
0371     <span class="keyword">global</span> vars
0372     vars.N2.MinPeak = input;
0373 <span class="keyword">end</span>
0374 
0375 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0376 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0377 
0378 guidata(hObject, handles);
0379 
0380 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0381 <a name="_sub11" href="#_subfunctions" class="code">function edit_N2Low_CreateFcn(hObject, eventdata, handles)</a>
0382 
0383 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0384     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0385 <span class="keyword">end</span>
0386 
0387 
0388 <span class="comment">% NiEDDA</span>
0389 <span class="comment">% ===================================================</span>
0390 
0391 <a name="_sub12" href="#_subfunctions" class="code">function edit_NiHigh_Callback(hObject, eventdata, handles)</a>
0392 
0393 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0394 
0395 input = str2num(get(hObject,<span class="string">'String'</span>));
0396 
0397 <span class="keyword">if</span> (isempty(input))
0398      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0399 <span class="keyword">else</span>
0400     <span class="keyword">global</span> vars
0401     vars.Ni.MaxPeak = input;
0402 <span class="keyword">end</span>
0403 
0404 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0405 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0406 
0407 guidata(hObject, handles);
0408 
0409 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0410 <a name="_sub13" href="#_subfunctions" class="code">function edit_NiHigh_CreateFcn(hObject, eventdata, handles)</a>
0411 
0412 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0413     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0414 <span class="keyword">end</span>
0415 
0416 
0417 
0418 <a name="_sub14" href="#_subfunctions" class="code">function edit_NiLow_Callback(hObject, eventdata, handles)</a>
0419 
0420 set(handles.button_NiSelect,<span class="string">'Value'</span>,1)
0421 
0422 input = str2num(get(hObject,<span class="string">'String'</span>));
0423 
0424 <span class="keyword">if</span> (isempty(input))
0425      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0426 <span class="keyword">else</span>
0427     <span class="keyword">global</span> vars
0428     vars.Ni.MinPeak = input;
0429 <span class="keyword">end</span>
0430 
0431 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0432 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0433 
0434 guidata(hObject, handles);
0435 
0436 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0437 <a name="_sub15" href="#_subfunctions" class="code">function edit_NiLow_CreateFcn(hObject, eventdata, handles)</a>
0438 
0439 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0440     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0441 <span class="keyword">end</span>
0442 
0443 
0444 
0445 <span class="comment">% DPPH</span>
0446 <span class="comment">% ===================================================</span>
0447 
0448 <a name="_sub16" href="#_subfunctions" class="code">function edit_DPPHHigh_Callback(hObject, eventdata, handles)</a>
0449 
0450 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0451 
0452 input = str2num(get(hObject,<span class="string">'String'</span>));
0453 
0454 <span class="keyword">if</span> (isempty(input))
0455      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0456 <span class="keyword">else</span>
0457     <span class="keyword">global</span> vars
0458     vars.DPPH.MaxPeak = input;
0459 <span class="keyword">end</span>
0460 
0461 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0462 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0463 
0464 guidata(hObject, handles);
0465 
0466 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0467 <a name="_sub17" href="#_subfunctions" class="code">function edit_DPPHHigh_CreateFcn(hObject, eventdata, handles)</a>
0468 
0469 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0470     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0471 <span class="keyword">end</span>
0472 
0473 
0474 
0475 <a name="_sub18" href="#_subfunctions" class="code">function edit_DPPHLow_Callback(hObject, eventdata, handles)</a>
0476 
0477 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
0478 
0479 input = str2num(get(hObject,<span class="string">'String'</span>));
0480 
0481 <span class="keyword">if</span> (isempty(input))
0482      set(hObject,<span class="string">'String'</span>,<span class="string">'-'</span>)
0483 <span class="keyword">else</span>
0484     <span class="keyword">global</span> vars
0485     vars.DPPH.MinPeak = input;
0486 <span class="keyword">end</span>
0487 
0488 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0489 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0490 
0491 guidata(hObject, handles);
0492 
0493 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0494 <a name="_sub19" href="#_subfunctions" class="code">function edit_DPPHLow_CreateFcn(hObject, eventdata, handles)</a>
0495 
0496 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0497     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0498 <span class="keyword">end</span>
0499 
0500 
0501 
0502 
0503 <span class="comment">%          ===================================================</span>
0504 <span class="comment">%          ===================================================</span>
0505 <span class="comment">%                     Dataset Manipulation Panel</span>
0506 <span class="comment">%          ===================================================</span>
0507 <span class="comment">%          ===================================================</span>
0508 
0509 <span class="comment">% --- Executes on button press in checkbox_autozero.</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function checkbox_autozero_Callback(hObject, eventdata, handles)</a>
0511 
0512 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0513 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0514 
0515 
0516 
0517 <span class="comment">% --- Executes on selection change in dropdown_fitting.</span>
0518 <a name="_sub21" href="#_subfunctions" class="code">function dropdown_fitting_Callback(hObject, eventdata, handles)</a>
0519 
0520 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0521 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0522 
0523 
0524 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0525 <a name="_sub22" href="#_subfunctions" class="code">function dropdown_fitting_CreateFcn(hObject, eventdata, handles)</a>
0526 
0527 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0528     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0529 <span class="keyword">end</span>
0530 
0531 
0532 <a name="_sub23" href="#_subfunctions" class="code">function edit_fittingWindow_Callback(hObject, eventdata, handles)</a>
0533 
0534 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0535 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0536 
0537 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0538 <a name="_sub24" href="#_subfunctions" class="code">function edit_fittingWindow_CreateFcn(hObject, eventdata, handles)</a>
0539 
0540 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0541     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0542 <span class="keyword">end</span>
0543 
0544 
0545 
0546 <span class="comment">%          ===================================================</span>
0547 <span class="comment">%          ===================================================</span>
0548 <span class="comment">%                        Viewing options panel</span>
0549 <span class="comment">%          ===================================================</span>
0550 <span class="comment">%          ===================================================</span>
0551 
0552 
0553 <a name="_sub25" href="#_subfunctions" class="code">function edit_mWpower_Callback(hObject, eventdata, handles)</a>
0554 
0555 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0556 
0557 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0558 <a name="_sub26" href="#_subfunctions" class="code">function edit_mWpower_CreateFcn(hObject, eventdata, handles)</a>
0559 
0560 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0561     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0562 <span class="keyword">end</span>
0563 
0564 
0565 <span class="comment">% --- Executes on selection change in dropdown_view.</span>
0566 <a name="_sub27" href="#_subfunctions" class="code">function dropdown_view_Callback(hObject, eventdata, handles)</a>
0567 
0568 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0569 
0570 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0571 <a name="_sub28" href="#_subfunctions" class="code">function dropdown_view_CreateFcn(hObject, eventdata, handles)</a>
0572 
0573 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0574     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0575 <span class="keyword">end</span>
0576 
0577 
0578 <span class="comment">%          ===================================================</span>
0579 <span class="comment">%          ===================================================</span>
0580 <span class="comment">%                          Spectra Panel</span>
0581 <span class="comment">%          ===================================================</span>
0582 <span class="comment">%          ===================================================</span>
0583 
0584 
0585 <span class="comment">% --- Executes on Slider movement.</span>
0586 <a name="_sub29" href="#_subfunctions" class="code">function [handles] = slider1_Callback(hObject, eventdata, handles)</a>
0587 
0588 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles)
0589 
0590 
0591 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0592 <a name="_sub30" href="#_subfunctions" class="code">function slider1_CreateFcn(hObject, eventdata, handles)</a>
0593 
0594 <span class="keyword">if</span> isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0595     set(hObject,<span class="string">'BackgroundColor'</span>,[.9 .9 .9]);
0596 <span class="keyword">end</span>
0597 
0598 
0599 
0600 <span class="comment">%          ===================================================</span>
0601 <span class="comment">%          ===================================================</span>
0602 <span class="comment">%                        PS Curves Panel</span>
0603 <span class="comment">%          ===================================================</span>
0604 <span class="comment">%          ===================================================</span>
0605 
0606 
0607 <span class="comment">% No options here.</span>
0608 
0609 
0610 <span class="comment">%          ===================================================</span>
0611 <span class="comment">%          ===================================================</span>
0612 <span class="comment">%                        PS Options Panel</span>
0613 <span class="comment">%          ===================================================</span>
0614 <span class="comment">%          ===================================================</span>
0615 
0616 <span class="comment">% --- Executes on button press in checkbox_PSfits.</span>
0617 <a name="_sub31" href="#_subfunctions" class="code">function checkbox_PSfits_Callback(hObject, eventdata, handles)</a>
0618 
0619 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0620 
0621 
0622 <span class="comment">% --- Executes on button press in checkbox_errorbars.</span>
0623 <a name="_sub32" href="#_subfunctions" class="code">function checkbox_errorbars_Callback(hObject, eventdata, handles)</a>
0624 
0625 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0626 
0627 
0628 
0629 <span class="comment">%          ===================================================</span>
0630 <span class="comment">%          ===================================================</span>
0631 <span class="comment">%                             PS Data Panel</span>
0632 <span class="comment">%          ===================================================</span>
0633 <span class="comment">%          ===================================================</span>
0634 
0635 <span class="comment">% Oxygen</span>
0636 <span class="comment">% ===================================================</span>
0637 
0638 <a name="_sub33" href="#_subfunctions" class="code">function CFOxyP_Callback(hObject, eventdata, handles)</a>
0639 
0640 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0641 <a name="_sub34" href="#_subfunctions" class="code">function CFOxyP_CreateFcn(hObject, eventdata, handles)</a>
0642 
0643 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0644     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0645 <span class="keyword">end</span>
0646 
0647 
0648 
0649 <a name="_sub35" href="#_subfunctions" class="code">function CFOxyPM_Callback(hObject, eventdata, handles)</a>
0650 
0651 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0652 <a name="_sub36" href="#_subfunctions" class="code">function CFOxyPM_CreateFcn(hObject, eventdata, handles)</a>
0653 
0654 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0655     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0656 <span class="keyword">end</span>
0657 
0658 
0659 <a name="_sub37" href="#_subfunctions" class="code">function CFOxyA_Callback(hObject, eventdata, handles)</a>
0660 
0661 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0662 <a name="_sub38" href="#_subfunctions" class="code">function CFOxyA_CreateFcn(hObject, eventdata, handles)</a>
0663 
0664 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0665     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0666 <span class="keyword">end</span>
0667 
0668 
0669 
0670 <a name="_sub39" href="#_subfunctions" class="code">function CFOxyB_Callback(hObject, eventdata, handles)</a>
0671 
0672 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0673 <a name="_sub40" href="#_subfunctions" class="code">function CFOxyB_CreateFcn(hObject, eventdata, handles)</a>
0674 
0675 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0676     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0677 <span class="keyword">end</span>
0678 
0679 
0680 <span class="comment">% Nitrogen</span>
0681 <span class="comment">% ===================================================</span>
0682 
0683 <a name="_sub41" href="#_subfunctions" class="code">function CFN2P_Callback(hObject, eventdata, handles)</a>
0684 
0685 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0686 <a name="_sub42" href="#_subfunctions" class="code">function CFN2P_CreateFcn(hObject, eventdata, handles)</a>
0687 
0688 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0689     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0690 <span class="keyword">end</span>
0691 
0692 
0693 
0694 <a name="_sub43" href="#_subfunctions" class="code">function CFN2PM_Callback(hObject, eventdata, handles)</a>
0695 
0696 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0697 <a name="_sub44" href="#_subfunctions" class="code">function CFN2PM_CreateFcn(hObject, eventdata, handles)</a>
0698 
0699 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0700     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0701 <span class="keyword">end</span>
0702 
0703 
0704 
0705 <a name="_sub45" href="#_subfunctions" class="code">function CFN2A_Callback(hObject, eventdata, handles)</a>
0706 
0707 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0708 <a name="_sub46" href="#_subfunctions" class="code">function CFN2A_CreateFcn(hObject, eventdata, handles)</a>
0709 
0710 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0711     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0712 <span class="keyword">end</span>
0713 
0714 
0715 
0716 <a name="_sub47" href="#_subfunctions" class="code">function CFN2B_Callback(hObject, eventdata, handles)</a>
0717 
0718 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0719 <a name="_sub48" href="#_subfunctions" class="code">function CFN2B_CreateFcn(hObject, eventdata, handles)</a>
0720 
0721 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0722     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0723 <span class="keyword">end</span>
0724 
0725 
0726 <span class="comment">% NiEDDA</span>
0727 <span class="comment">% ===================================================</span>
0728 
0729 <a name="_sub49" href="#_subfunctions" class="code">function CFNiP_Callback(hObject, eventdata, handles)</a>
0730 
0731 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0732 <a name="_sub50" href="#_subfunctions" class="code">function CFNiP_CreateFcn(hObject, eventdata, handles)</a>
0733 
0734 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0735     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0736 <span class="keyword">end</span>
0737 
0738 
0739 
0740 <a name="_sub51" href="#_subfunctions" class="code">function CFNiPM_Callback(hObject, eventdata, handles)</a>
0741 
0742 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0743 <a name="_sub52" href="#_subfunctions" class="code">function CFNiPM_CreateFcn(hObject, eventdata, handles)</a>
0744 
0745 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0746     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0747 <span class="keyword">end</span>
0748 
0749 
0750 
0751 <a name="_sub53" href="#_subfunctions" class="code">function CFNiA_Callback(hObject, eventdata, handles)</a>
0752 
0753 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0754 <a name="_sub54" href="#_subfunctions" class="code">function CFNiA_CreateFcn(hObject, eventdata, handles)</a>
0755 
0756 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0757     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0758 <span class="keyword">end</span>
0759 
0760 
0761 
0762 <a name="_sub55" href="#_subfunctions" class="code">function CFNiB_Callback(hObject, eventdata, handles)</a>
0763 
0764 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0765 <a name="_sub56" href="#_subfunctions" class="code">function CFNiB_CreateFcn(hObject, eventdata, handles)</a>
0766 
0767 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0768     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0769 <span class="keyword">end</span>
0770 
0771 
0772 <span class="comment">%          ===================================================</span>
0773 <span class="comment">%          ===================================================</span>
0774 <span class="comment">%                     Accessibility Panel</span>
0775 <span class="comment">%          ===================================================</span>
0776 <span class="comment">%          ===================================================</span>
0777 
0778 
0779 <a name="_sub57" href="#_subfunctions" class="code">function edit_pi_Oxy_Callback(hObject, eventdata, handles)</a>
0780 
0781 <a name="_sub58" href="#_subfunctions" class="code">function edit_pi_Oxy_CreateFcn(hObject, eventdata, handles)</a>
0782 
0783 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0784     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0785 <span class="keyword">end</span>
0786 
0787 
0788 
0789 <a name="_sub59" href="#_subfunctions" class="code">function edit_pi_N2_Callback(hObject, eventdata, handles)</a>
0790 
0791 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0792 <a name="_sub60" href="#_subfunctions" class="code">function edit_pi_N2_CreateFcn(hObject, eventdata, handles)</a>
0793 
0794 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0795     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0796 <span class="keyword">end</span>
0797 
0798 
0799 
0800 <a name="_sub61" href="#_subfunctions" class="code">function edit_pi_Ni_Callback(hObject, eventdata, handles)</a>
0801 
0802 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0803 <a name="_sub62" href="#_subfunctions" class="code">function edit_pi_Ni_CreateFcn(hObject, eventdata, handles)</a>
0804 
0805 <span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0806     set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
0807 <span class="keyword">end</span>
0808 
0809 
0810 
0811 <span class="comment">%          ===================================================</span>
0812 <span class="comment">%          ===================================================</span>
0813 <span class="comment">%                                Menu</span>
0814 <span class="comment">%          ===================================================</span>
0815 <span class="comment">%          ===================================================</span>
0816 
0817 
0818 <span class="comment">% File</span>
0819 <span class="comment">% ===================================================</span>
0820 
0821 <span class="comment">% --------------------------------------------------------------------</span>
0822 <a name="_sub63" href="#_subfunctions" class="code">function menu_file_Callback(hObject, eventdata, handles)</a>
0823 
0824 <span class="comment">% --------------------------------------------------------------------</span>
0825 <a name="_sub64" href="#_subfunctions" class="code">function menu_open_Callback(hObject, eventdata, handles)</a>
0826 
0827 <span class="keyword">global</span> vars
0828 
0829 <span class="comment">% GUI get file</span>
0830 [file , directory] = uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="string">'Load PowerSat file'</span>);
0831 address = [directory,file];
0832 
0833 <span class="comment">% Load variable</span>
0834 load(address , <span class="string">'vars'</span>);
0835 
0836 <span class="comment">% Update plots</span>
0837 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0838 
0839 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
0840     set(handles.button_DPPHSelect ,<span class="string">'Value'</span>,1)
0841     set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
0842     set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
0843 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Ni'</span>)
0844     set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
0845     set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
0846     set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
0847 <span class="keyword">elseif</span> isfield(vars,<span class="string">'N2'</span>)
0848     set(handles.button_N2Select ,<span class="string">'Value'</span>,1)
0849     set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
0850     set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
0851 <span class="keyword">elseif</span> isfield(vars,<span class="string">'Oxy'</span>)
0852     set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
0853     set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0854     set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0855 <span class="keyword">else</span>
0856     <span class="keyword">return</span>
0857 <span class="keyword">end</span>
0858 
0859 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0860 
0861 
0862 
0863 
0864 <span class="comment">% --------------------------------------------------------------------</span>
0865 <a name="_sub65" href="#_subfunctions" class="code">function menu_save_Callback(hObject, eventdata, handles)</a>
0866 
0867 <span class="keyword">global</span> vars
0868 
0869 [file, pathname] = uiputfile({ <span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0870         <span class="string">'Save PowerSat as'</span>,<span class="string">'default'</span>);
0871     
0872 address = [pathname file];
0873 
0874 save(address,<span class="string">'vars'</span>);
0875 
0876 
0877 <span class="comment">% --------------------------------------------------------------------</span>
0878 <a name="_sub66" href="#_subfunctions" class="code">function menu_reset_Callback(hObject, eventdata, handles)</a>
0879 
0880 
0881 <span class="comment">% OLD METHOD: basically calls a new figure on top of old</span>
0882 
0883 <span class="comment">% closeGUI = handles.figure1;                     % handles.figure1 is the GUI figure</span>
0884 <span class="comment">%</span>
0885 <span class="comment">% guiPosition = get(handles.figure1,'Position');  % get the position of the GUI</span>
0886 <span class="comment">% guiName = get(handles.figure1,'Name');          % get the name of the GUI</span>
0887 <span class="comment">% eval('PowerSat')                                % call the GUI again</span>
0888 <span class="comment">%</span>
0889 <span class="comment">% close(closeGUI);                                % close the old GUI</span>
0890 <span class="comment">% set(gcf,'Position',guiPosition);                % set the position for the new GUI</span>
0891 <span class="comment">%</span>
0892 <span class="comment">% clear global</span>
0893 
0894 <span class="comment">% NEW METHOD: clear variables, reset axes</span>
0895 
0896 close = questdlg(<span class="keyword">...</span>
0897     <span class="string">'Are you sure you want to reset PowerSat? This will clear all unsaved data.'</span>,<span class="keyword">...</span>
0898     <span class="string">'Reset PowerSat?'</span>,<span class="keyword">...</span>
0899     <span class="string">'Yes'</span>,<span class="keyword">...</span>
0900     <span class="string">'No'</span>,<span class="keyword">...</span>
0901     <span class="string">'Yes'</span>);
0902 
0903 <span class="keyword">switch</span> strcmp(close,<span class="string">'Yes'</span>)
0904     <span class="keyword">case</span> 1
0905         
0906         <span class="keyword">global</span> vars
0907         vars.Oxy = [];
0908         vars.N2 = [];
0909         vars.Ni = [];
0910         vars.DPPH = [];
0911         
0912         cla(handles.plot_load);
0913         xlabel(<span class="string">'Magnetic Field / Gauss'</span>);
0914         ylabel(<span class="string">'Intensity'</span>);
0915         
0916         cla(handles.plot_PS);
0917         xlabel(<span class="string">'\surd Microwave Power / mW^Â½'</span>);
0918         ylabel(<span class="string">'Y'' / arb. units'</span>);
0919         
0920         set(handles.edit_OxyHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0921         set(handles.edit_OxyLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0922         set(handles.edit_N2High,<span class="string">'String'</span>,<span class="string">'-'</span>);
0923         set(handles.edit_N2Low,<span class="string">'String'</span>,<span class="string">'-'</span>);
0924         set(handles.edit_NiHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0925         set(handles.edit_NiLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0926         set(handles.edit_DPPHHigh,<span class="string">'String'</span>,<span class="string">'-'</span>);
0927         set(handles.edit_DPPHLow,<span class="string">'String'</span>,<span class="string">'-'</span>);
0928         
0929         set(handles.button_OxySelect ,<span class="string">'Value'</span>,1);
0930         set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0931         set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0932 
0933         set(handles.CFOxyP,<span class="string">'String'</span>,<span class="string">'-'</span>);
0934         set(handles.CFOxyA,<span class="string">'String'</span>,<span class="string">'-'</span>);
0935         set(handles.CFOxyB,<span class="string">'String'</span>,<span class="string">'-'</span>);
0936         set(handles.CFOxyR,<span class="string">'String'</span>,<span class="string">'-'</span>);
0937         set(handles.CFN2P,<span class="string">'String'</span>,<span class="string">'-'</span>);
0938         set(handles.CFN2A,<span class="string">'String'</span>,<span class="string">'-'</span>);
0939         set(handles.CFN2B,<span class="string">'String'</span>,<span class="string">'-'</span>);
0940         set(handles.CFN2R,<span class="string">'String'</span>,<span class="string">'-'</span>);
0941         set(handles.CFNiP,<span class="string">'String'</span>,<span class="string">'-'</span>);
0942         set(handles.CFNiA,<span class="string">'String'</span>,<span class="string">'-'</span>);
0943         set(handles.CFNiB,<span class="string">'String'</span>,<span class="string">'-'</span>);
0944         set(handles.CFNiR,<span class="string">'String'</span>,<span class="string">'-'</span>);
0945 
0946         set(handles.edit_pi_Oxy,<span class="string">'String'</span>,<span class="string">'-'</span>);
0947         set(handles.edit_pi_Ni,<span class="string">'String'</span>,<span class="string">'-'</span>);
0948   
0949     <span class="keyword">case</span> 0
0950         
0951 <span class="keyword">end</span>
0952 
0953 
0954 
0955 
0956 <span class="comment">% --------------------------------------------------------------------</span>
0957 <a name="_sub67" href="#_subfunctions" class="code">function menu_close_Callback(hObject, eventdata, handles)</a>
0958 
0959 figure1_CloseRequestFcn
0960 
0961 
0962 
0963 <span class="comment">% Datasets</span>
0964 <span class="comment">% ===================================================</span>
0965 
0966 <span class="comment">% --------------------------------------------------------------------</span>
0967 <a name="_sub68" href="#_subfunctions" class="code">function menu_DS_Callback(hObject, eventdata, handles)</a>
0968 
0969 
0970 <span class="comment">% --------------------------------------------------------------------</span>
0971 <a name="_sub69" href="#_subfunctions" class="code">function menu_DS_oxy_Callback(hObject, eventdata, handles)</a>
0972 
0973 
0974 <span class="comment">% --------------------------------------------------------------------</span>
0975 <a name="_sub70" href="#_subfunctions" class="code">function menu_DS_oxy1_Callback(hObject, eventdata, handles)</a>
0976 
0977 <span class="keyword">global</span> vars
0978 <span class="comment">% This creates a structure or overwrites an old one</span>
0979 vars.Oxy = [];
0980 
0981 <span class="comment">% Set defaults</span>
0982 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1);
0983 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
0984 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
0985 
0986 <span class="comment">% Load and plot file</span>
0987 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'Oxy'</span>,<span class="string">'file'</span>);
0988 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
0989 
0990 <span class="comment">% Update data boxes in GUI</span>
0991 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
0992 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
0993 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
0994 
0995 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
0996 
0997 guidata(hObject, handles);
0998 
0999 
1000 <span class="comment">% --------------------------------------------------------------------</span>
1001 <a name="_sub71" href="#_subfunctions" class="code">function menu_DS_oxy2_Callback(hObject, eventdata, handles)</a>
1002 
1003 <span class="keyword">global</span> vars
1004 <span class="comment">% This creates a structure or overwrites an old one</span>
1005 vars.Oxy = [];
1006 
1007 <span class="comment">% Set defaults</span>
1008 set(handles.button_OxySelect ,<span class="string">'Value'</span>,1)
1009 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1010 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1011 
1012 <span class="comment">% Load and plot file</span>
1013 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'Oxy'</span>,<span class="string">'folder'</span>);
1014 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1015 
1016 <span class="comment">% Update data boxes in GUI</span>
1017 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1018 set(handles.edit_OxyHigh,<span class="string">'String'</span>,vars.Oxy.MaxPeak);
1019 set(handles.edit_OxyLow ,<span class="string">'String'</span>,vars.Oxy.MinPeak);
1020 
1021 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1022 
1023 guidata(hObject, handles);
1024 
1025 
1026 <span class="comment">% --------------------------------------------------------------------</span>
1027 <a name="_sub72" href="#_subfunctions" class="code">function menu_DS_N2_Callback(hObject, eventdata, handles)</a>
1028 
1029 
1030 <span class="comment">% --------------------------------------------------------------------</span>
1031 <a name="_sub73" href="#_subfunctions" class="code">function menu_DS_N21_Callback(hObject, eventdata, handles)</a>
1032 
1033 <span class="keyword">global</span> vars
1034 <span class="comment">% This creates a structure or overwrites an old one</span>
1035 vars.N2 = [];
1036 
1037 <span class="comment">% Set defaults</span>
1038 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
1039 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1040 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1041 
1042 <span class="comment">% Load and plot file</span>
1043 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'N2'</span>,<span class="string">'file'</span>);
1044 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1045 
1046 <span class="comment">% Update data boxes in GUI</span>
1047 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1048 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
1049 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
1050 
1051 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1052 
1053 guidata(hObject, handles);
1054 
1055 <span class="comment">% --------------------------------------------------------------------</span>
1056 <a name="_sub74" href="#_subfunctions" class="code">function menu_DS_N22_Callback(hObject, eventdata, handles)</a>
1057 
1058 <span class="keyword">global</span> vars
1059 <span class="comment">% This creates a structure or overwrites an old one</span>
1060 vars.N2 = [];
1061 
1062 <span class="comment">% Set defaults</span>
1063 set(handles.button_N2Select  ,<span class="string">'Value'</span>,1)
1064 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1065 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1066 
1067 <span class="comment">% Load and plot file</span>
1068 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'N2'</span>,<span class="string">'folder'</span>);
1069 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1070 
1071 <span class="comment">% Update data boxes in GUI</span>
1072 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1073 set(handles.edit_N2High,<span class="string">'String'</span>,vars.N2.MaxPeak);
1074 set(handles.edit_N2Low ,<span class="string">'String'</span>,vars.N2.MinPeak);
1075 
1076 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1077 
1078 guidata(hObject, handles);
1079 
1080 <span class="comment">% --------------------------------------------------------------------</span>
1081 <a name="_sub75" href="#_subfunctions" class="code">function menu_DS_Ni_Callback(hObject, eventdata, handles)</a>
1082 
1083 <span class="comment">% --------------------------------------------------------------------</span>
1084 <a name="_sub76" href="#_subfunctions" class="code">function menu_DS_Ni1_Callback(hObject, eventdata, handles)</a>
1085 
1086 <span class="keyword">global</span> vars
1087 <span class="comment">% This creates a structure or overwrites an old one</span>
1088 vars.Ni = [];
1089 
1090 <span class="comment">% Set defaults</span>
1091 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1092 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1093 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1094 
1095 <span class="comment">% Load and plot file</span>
1096 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'Ni'</span>,<span class="string">'file'</span>);
1097 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1098 
1099 <span class="comment">% Update data boxes in GUI</span>
1100 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1101 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1102 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1103 
1104 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1105 
1106 guidata(hObject, handles);
1107 
1108 <span class="comment">% --------------------------------------------------------------------</span>
1109 <a name="_sub77" href="#_subfunctions" class="code">function menu_DS_Ni2_Callback(hObject, eventdata, handles)</a>
1110 
1111 <span class="keyword">global</span> vars
1112 <span class="comment">% This creates a structure or overwrites an old one</span>
1113 vars.Ni = [];
1114 
1115 <span class="comment">% Set defaults</span>
1116 set(handles.button_NiSelect ,<span class="string">'Value'</span>,1)
1117 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1118 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1119 
1120 <span class="comment">% Load and plot file</span>
1121 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'Ni'</span>,<span class="string">'folder'</span>);
1122 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1123 
1124 <span class="comment">% Update data boxes in GUI</span>
1125 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1126 set(handles.edit_NiHigh,<span class="string">'String'</span>,vars.Ni.MaxPeak);
1127 set(handles.edit_NiLow ,<span class="string">'String'</span>,vars.Ni.MinPeak);
1128 
1129 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1130 
1131 guidata(hObject, handles);
1132 
1133 <span class="comment">% --------------------------------------------------------------------</span>
1134 <a name="_sub78" href="#_subfunctions" class="code">function menu_DS_DPPH_Callback(hObject, eventdata, handles)</a>
1135 
1136 <span class="comment">% --------------------------------------------------------------------</span>
1137 <a name="_sub79" href="#_subfunctions" class="code">function menu_DS_DPPH1_Callback(hObject, eventdata, handles)</a>
1138 
1139 <span class="keyword">global</span> vars
1140 <span class="comment">% This creates a structure or overwrites an old one</span>
1141 vars.DPPH = [];
1142 
1143 <span class="comment">% Set defaults</span>
1144 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1145 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1146 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1147 
1148 <span class="comment">% Load and plot file</span>
1149 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'DPPH'</span>,<span class="string">'file'</span>);
1150 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1151 
1152 <span class="comment">% Update data boxes in GUI</span>
1153 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1154 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1155 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1156 
1157 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1158 
1159 guidata(hObject, handles);
1160 
1161 
1162 <span class="comment">% --------------------------------------------------------------------</span>
1163 <a name="_sub80" href="#_subfunctions" class="code">function menu_DS_DPPH2_Callback(hObject, eventdata, handles)</a>
1164 
1165 <span class="keyword">global</span> vars
1166 <span class="comment">% This creates a structure or overwrites an old one</span>
1167 vars.DPPH = [];
1168 
1169 <span class="comment">% Set defaults</span>
1170 set(handles.button_DPPHSelect,<span class="string">'Value'</span>,1)
1171 set(handles.checkbox_autozero,<span class="string">'Value'</span>,1);
1172 set(handles.dropdown_view    ,<span class="string">'Value'</span>,1);
1173 
1174 <span class="comment">% Load and plot file</span>
1175 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_FileLoad.html" class="code" title="function PS_FileLoad(exp,file)">PS_FileLoad</a>(<span class="string">'DPPH'</span>,<span class="string">'folder'</span>);
1176 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1177 
1178 <span class="comment">% Update data boxes in GUI</span>
1179 set(handles.edit_mWpower,<span class="string">'String'</span>,<span class="string">'All'</span>);
1180 set(handles.edit_DPPHHigh,<span class="string">'String'</span>,vars.DPPH.MaxPeak);
1181 set(handles.edit_DPPHLow ,<span class="string">'String'</span>,vars.DPPH.MinPeak);
1182 
1183 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1184 
1185 guidata(hObject, handles);
1186 
1187 
1188 <span class="comment">% Spectra</span>
1189 <span class="comment">% ===================================================</span>
1190 
1191 <span class="comment">% --------------------------------------------------------------------</span>
1192 <a name="_sub81" href="#_subfunctions" class="code">function menu_spectra_Callback(hObject, eventdata, handles)</a>
1193 
1194 
1195 <span class="comment">% --------------------------------------------------------------------</span>
1196 <a name="_sub82" href="#_subfunctions" class="code">function menu_spec_clear_Callback(hObject, eventdata, handles)</a>
1197 
1198 cla(handles.plot_load,<span class="string">'reset'</span>);
1199 guidata(hObject, handles);
1200 
1201 
1202 <span class="comment">% --------------------------------------------------------------------</span>
1203 <a name="_sub83" href="#_subfunctions" class="code">function menu_spec_replot_Callback(hObject, eventdata, handles)</a>
1204 
1205 <span class="keyword">global</span> vars
1206 
1207 <span class="comment">% if get(handles.checkbox_Gauss,'Value')</span>
1208 <span class="comment">%     if isfield(vars,'DPPH')</span>
1209 <span class="comment">%         PS_Plot1_Gaussian(handles,'DPPH')</span>
1210 <span class="comment">%     end</span>
1211 <span class="comment">%     if isfield(vars,'Ni')</span>
1212 <span class="comment">%         PS_Plot1_Gaussian(handles,'Ni')</span>
1213 <span class="comment">%     end</span>
1214 <span class="comment">%     if isfield(vars,'N2')</span>
1215 <span class="comment">%         PS_Plot1_Gaussian(handles,'N2')</span>
1216 <span class="comment">%     end</span>
1217 <span class="comment">%     if isfield(vars,'Oxy')</span>
1218 <span class="comment">%         PS_Plot1_Gaussian(handles,'Oxy')</span>
1219 <span class="comment">%     end</span>
1220 <span class="comment">% end</span>
1221 
1222 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Plot1.html" class="code" title="function PS_Plot1(handles)">PS_Plot1</a>(handles);
1223 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1224 
1225 
1226 <span class="comment">% --------------------------------------------------------------------</span>
1227 <a name="_sub84" href="#_subfunctions" class="code">function menu_spec_detach_Callback(hObject, eventdata, handles)</a>
1228 
1229 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_DetachPlot.html" class="code" title="function PS_DetachPlot(axesObject)">PS_DetachPlot</a>(handles.plot_load);
1230 
1231 
1232 <span class="comment">% --------------------------------------------------------------------</span>
1233 <a name="_sub85" href="#_subfunctions" class="code">function menu_spec_save_Callback(hObject, eventdata, handles)</a>
1234 
1235 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_SavePlot.html" class="code" title="function PS_SavePlot(axesObject)">PS_SavePlot</a>(handles.plot_load);
1236 
1237 
1238 
1239 <span class="comment">% PowerSat</span>
1240 <span class="comment">% ===================================================</span>
1241 
1242 <span class="comment">% --------------------------------------------------------------------</span>
1243 <a name="_sub86" href="#_subfunctions" class="code">function menu_PS_Callback(hObject, eventdata, handles)</a>
1244 
1245 <span class="comment">% --------------------------------------------------------------------</span>
1246 <a name="_sub87" href="#_subfunctions" class="code">function menu_PS_export_Callback(hObject, eventdata, handles)</a>
1247 
1248 <span class="keyword">global</span> vars
1249 
1250 <span class="keyword">if</span> isfield(vars,<span class="string">'DPPH'</span>)
1251     out.Y           = vars.DPPH.Y;
1252     out.sqrtPower   = vars.DPPH.sqrtPower;
1253     out.FitResults  = vars.DPPH.FitResults;
1254     
1255     assignin(<span class="string">'base'</span>,<span class="string">'DPPH'</span>,out)
1256 <span class="keyword">end</span>
1257 <span class="keyword">if</span> isfield(vars,<span class="string">'Ni'</span>)
1258     out.Y           = vars.Ni.Y;
1259     out.sqrtPower   = vars.Ni.sqrtPower;
1260     out.FitResults  = vars.Ni.FitResults;
1261     
1262     assignin(<span class="string">'base'</span>,<span class="string">'Ni'</span>,out)
1263 <span class="keyword">end</span>
1264 <span class="keyword">if</span> isfield(vars,<span class="string">'N2'</span>)
1265     out.Y           = vars.N2.Y;
1266     out.sqrtPower   = vars.N2.sqrtPower;
1267     out.FitResults  = vars.N2.FitResults;
1268     
1269     assignin(<span class="string">'base'</span>,<span class="string">'N2'</span>,out)
1270 <span class="keyword">end</span>
1271 <span class="keyword">if</span> isfield(vars,<span class="string">'Oxy'</span>)
1272     out.Y           = vars.Oxy.Y;
1273     out.sqrtPower   = vars.Oxy.sqrtPower;
1274     out.FitResults  = vars.Oxy.FitResults;
1275     
1276     assignin(<span class="string">'base'</span>,<span class="string">'Oxy'</span>,out)
1277 <span class="keyword">end</span>
1278 
1279 
1280 <span class="comment">% --------------------------------------------------------------------</span>
1281 <a name="_sub88" href="#_subfunctions" class="code">function menu_PS_Origin_Callback(hObject, eventdata, handles)</a>
1282 
1283 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_ExportToOrigin.html" class="code" title="function PS_ExportToOrigin(handles)">PS_ExportToOrigin</a>(handles);
1284 
1285 
1286 <span class="comment">% --------------------------------------------------------------------</span>
1287 <a name="_sub89" href="#_subfunctions" class="code">function menu_PS_replot_Callback(hObject, eventdata, handles)</a>
1288 
1289 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_PlotPS.html" class="code" title="function PS_PlotPS(handles)">PS_PlotPS</a>(handles);
1290 
1291 
1292 <span class="comment">% --------------------------------------------------------------------</span>
1293 <a name="_sub90" href="#_subfunctions" class="code">function menu_PS_detach_Callback(hObject, eventdata, handles)</a>
1294 
1295 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_DetachPlot.html" class="code" title="function PS_DetachPlot(axesObject)">PS_DetachPlot</a>(handles.plot_PS);
1296 
1297 <span class="comment">% --------------------------------------------------------------------</span>
1298 <a name="_sub91" href="#_subfunctions" class="code">function menu_PS_save_Callback(hObject, eventdata, handles)</a>
1299 
1300 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_SavePlot.html" class="code" title="function PS_SavePlot(axesObject)">PS_SavePlot</a>(handles.plot_PS);
1301 
1302 
1303 <span class="comment">% --------------------------------------------------------------------</span>
1304 <a name="_sub92" href="#_subfunctions" class="code">function menu_PS_clear_Callback(hObject, eventdata, handles)</a>
1305 
1306 cla(handles.plot_PS,<span class="string">'reset'</span>);
1307 guidata(hObject, handles);
1308 
1309 <span class="comment">% Help</span>
1310 <span class="comment">% ===================================================</span>
1311 
1312 <span class="comment">% --------------------------------------------------------------------</span>
1313 <a name="_sub93" href="#_subfunctions" class="code">function menu_help_Callback(hObject, eventdata, handles)</a>
1314 
1315 
1316 <span class="comment">% --------------------------------------------------------------------</span>
1317 <a name="_sub94" href="#_subfunctions" class="code">function menu_help_help_Callback(hObject, eventdata, handles)</a>
1318 
1319 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Help_Help.html" class="code" title="function PS_Help_Help">PS_Help_Help</a>;
1320 
1321 
1322 <span class="comment">% --------------------------------------------------------------------</span>
1323 <a name="_sub95" href="#_subfunctions" class="code">function help_about_Callback(hObject, eventdata, handles)</a>
1324 
1325 <a href="../../../EPRtoolbox/cw/PowerSat/_private/PS_Help_About.html" class="code" title="function PS_Help_About">PS_Help_About</a>;
1326</pre></div>
<hr><address>Generated on Sun 07-Sep-2014 15:11:40 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>