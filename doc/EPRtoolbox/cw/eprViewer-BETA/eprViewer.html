<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of eprViewer</title>
  <meta name="keywords" content="eprViewer">
  <meta name="description" content="CWVIEWER Open, analyse and plot cw-EPR experiments.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">EPRtoolbox</a> &gt; <a href="../index.html">cw</a> &gt; <a href="index.html">eprViewer-BETA</a> &gt; eprViewer.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for EPRtoolbox/cw/eprViewer-BETA&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>eprViewer
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>CWVIEWER Open, analyse and plot cw-EPR experiments.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function varargout = eprViewer(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> CWVIEWER Open, analyse and plot cw-EPR experiments.
      CWVIEWER, is designed as a complete solution for viewing standard 
      cwEPR experiments, quickly and simply.

       CWVIEWER provides basic data manipulation tools to quickly
       tidy up spectra. Spectra can then be exported as:
           &gt; Bruker files (*.DTA / *.DSC)
           &gt; Comma seperated value files (*.csv files)
               for ease of use with spreadsheet programs such as MS
               Excel/OpenOffice Calc and graphing programs such as
               Origin/Qtiplot)
           &gt; Image files (*.png / *.eps / *jpg)

      CWVIEWER, provides support for:
           &gt; Bruker BE3ST files (.DTA / .DSC)
                   - .YGF when accessory files are in the same folder)
           &gt; Older Bruker files (.spc / .par)
           &gt; FSC2 files                        - LIMITED FUNCTIONALITY
           &gt; Jeol files (*.ESR)                - UNTESTED

   A demonstration video is available on YouTube
       http://youtu.be/SNjlbl-3ZsU

 Syntax:  cwViewer

 Inputs:
    input1     - n/a

 Outputs:
    output1    - n/a

 Example: 
    see http://morganbye.net/eprtoolbox/cwviewer
        http://youtu.be/SNjlbl-3ZsU

 Other m-files required:   BrukerRead
                           BrukerWrite
                           JeolRead
                           Fsc2Read

 Subfunctions:             cv_plot
                           file_details
                           viewing_options
                           data_man

 MAT-files required:       none

 To-do list:               &gt; Full support of Jeol and Fsc2 files
                           &gt; Tidy up image export
                           &gt; DEER traces show up but real and imaginary
                           channels need to be on seperate Y-axes
                           &gt; Export feature for multi-dimension datasets
                           needs to be written


 See also: CWNORM CWPLOT CWZERO PEAKFINDER</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../EPRtoolbox/cw/cwViewer/cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>	CV_PLOT Plotting function for cwViewer</li><li><a href="../../../EPRtoolbox/cw/cwViewer/easyfitting.html" class="code" title="function varargout = easyfitting(varargin)">easyfitting</a>	EASYFITTING The send to EasySpin window for cwViewer</li><li><a href="../../../EPRtoolbox/cw/cwViewer/file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>	FILE_DETAILS The file details window for cwViewer</li><li><a href="../../../EPRtoolbox/cw/cwViewer/viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>	VIEWING_OPTIONS The Viewing Options window for cwViewer</li><li><a href="../../../EPRtoolbox/cw/eprViewer-BETA/_private/ev_plot.html" class="code" title="function ev_plot(varargin)">ev_plot</a>	CV_PLOT Plotting function for cwViewer</li><li><a href="ev_data_man.html" class="code" title="function varargout = ev_data_man(varargin)">ev_data_man</a>	FILE_DETAILS The data manipulation window for cwViewer</li><li><a href="ev_file_details.html" class="code" title="function varargout = ev_file_details(varargin)">ev_file_details</a>	FILE_DETAILS The file details window for cwViewer</li><li><a href="ev_viewing_options.html" class="code" title="function varargout = ev_viewing_options(varargin)">ev_viewing_options</a>	VIEWING_OPTIONS The Viewing Options window for cwViewer</li><li><a href="../../../EPRtoolbox/misc/BrukerRead.html" class="code" title="function varargout = BrukerRead(varargin)">BrukerRead</a>	BRUKERREAD Open Bruker BE3ST files (.DTA / .DSC or  .spc / .par) into the</li><li><a href="../../../EPRtoolbox/misc/BrukerWrite.html" class="code" title="function BrukerWrite(varargin)">BrukerWrite</a>	BRUKERWRITE save x and y MATLAB variables out to Bruker BES3T files (.DTA</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = cwViewer_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function viewer_blank</a></li><li><a href="#_sub4" class="code">function text_weblink_ButtonDownFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function slider_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function slider_CreateFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menu_File_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menu_File_Open_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menu_File_Bruker_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menu_File_Bruker_folder_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menu_File_Jeol_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menu_File_Fsc2_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menu_File_Save_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menu_File_Export_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menu_File_Export_Dataset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menu_File_Export_toWorkspace_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menu_File_Export_Image_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menu_File_Exit_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menu_Window_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menu_Window_File_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menu_Window_View_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menu_Window_DataMan_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menu_Window_EasyFitting_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menu_help_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menu_help_about_Callback(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = eprViewer(varargin)</a>
0002 
0003 <span class="comment">% CWVIEWER Open, analyse and plot cw-EPR experiments.</span>
0004 <span class="comment">%      CWVIEWER, is designed as a complete solution for viewing standard</span>
0005 <span class="comment">%      cwEPR experiments, quickly and simply.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%       CWVIEWER provides basic data manipulation tools to quickly</span>
0008 <span class="comment">%       tidy up spectra. Spectra can then be exported as:</span>
0009 <span class="comment">%           &gt; Bruker files (*.DTA / *.DSC)</span>
0010 <span class="comment">%           &gt; Comma seperated value files (*.csv files)</span>
0011 <span class="comment">%               for ease of use with spreadsheet programs such as MS</span>
0012 <span class="comment">%               Excel/OpenOffice Calc and graphing programs such as</span>
0013 <span class="comment">%               Origin/Qtiplot)</span>
0014 <span class="comment">%           &gt; Image files (*.png / *.eps / *jpg)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%      CWVIEWER, provides support for:</span>
0017 <span class="comment">%           &gt; Bruker BE3ST files (.DTA / .DSC)</span>
0018 <span class="comment">%                   - .YGF when accessory files are in the same folder)</span>
0019 <span class="comment">%           &gt; Older Bruker files (.spc / .par)</span>
0020 <span class="comment">%           &gt; FSC2 files                        - LIMITED FUNCTIONALITY</span>
0021 <span class="comment">%           &gt; Jeol files (*.ESR)                - UNTESTED</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   A demonstration video is available on YouTube</span>
0024 <span class="comment">%       http://youtu.be/SNjlbl-3ZsU</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Syntax:  cwViewer</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% Inputs:</span>
0029 <span class="comment">%    input1     - n/a</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% Outputs:</span>
0032 <span class="comment">%    output1    - n/a</span>
0033 <span class="comment">%</span>
0034 <span class="comment">% Example:</span>
0035 <span class="comment">%    see http://morganbye.net/eprtoolbox/cwviewer</span>
0036 <span class="comment">%        http://youtu.be/SNjlbl-3ZsU</span>
0037 <span class="comment">%</span>
0038 <span class="comment">% Other m-files required:   BrukerRead</span>
0039 <span class="comment">%                           BrukerWrite</span>
0040 <span class="comment">%                           JeolRead</span>
0041 <span class="comment">%                           Fsc2Read</span>
0042 <span class="comment">%</span>
0043 <span class="comment">% Subfunctions:             cv_plot</span>
0044 <span class="comment">%                           file_details</span>
0045 <span class="comment">%                           viewing_options</span>
0046 <span class="comment">%                           data_man</span>
0047 <span class="comment">%</span>
0048 <span class="comment">% MAT-files required:       none</span>
0049 <span class="comment">%</span>
0050 <span class="comment">% To-do list:               &gt; Full support of Jeol and Fsc2 files</span>
0051 <span class="comment">%                           &gt; Tidy up image export</span>
0052 <span class="comment">%                           &gt; DEER traces show up but real and imaginary</span>
0053 <span class="comment">%                           channels need to be on seperate Y-axes</span>
0054 <span class="comment">%                           &gt; Export feature for multi-dimension datasets</span>
0055 <span class="comment">%                           needs to be written</span>
0056 <span class="comment">%</span>
0057 <span class="comment">%</span>
0058 <span class="comment">% See also: CWNORM CWPLOT CWZERO PEAKFINDER</span>
0059 
0060 <span class="comment">%                           oooooo     oooo   o8o</span>
0061 <span class="comment">%                            `888.     .8'    `&quot;'</span>
0062 <span class="comment">%  .ooooo.  oooo oooo    ooo   `888.   .8'   oooo   .ooooo.  oooo oooo    ooo  .ooooo.  oooo d8b</span>
0063 <span class="comment">% d88' `&quot;Y8  `88. `88.  .8'     `888. .8'    `888  d88' `88b  `88. `88.  .8'  d88' `88b `888&quot;&quot;8P</span>
0064 <span class="comment">% 888         `88..]88..8'       `888.8'      888  888ooo888   `88..]88..8'   888ooo888  888</span>
0065 <span class="comment">% 888   .o8    `888'`888'         `888'       888  888    .o    `888'`888'    888    .o  888</span>
0066 <span class="comment">% `Y8bod8P'     `8'  `8'           `8'       o888o `Y8bod8P'     `8'  `8'     `Y8bod8P' d888b</span>
0067 <span class="comment">%</span>
0068 
0069 <span class="comment">%                                        _                             _</span>
0070 <span class="comment">%                                       | |                           | |</span>
0071 <span class="comment">%  _ __ ___   ___  _ __ __ _  __ _ _ __ | |__  _   _  ___   _ __   ___| |_</span>
0072 <span class="comment">% | '_ ` _ \ / _ \| '__/ _` |/ _` | '_ \| '_ \| | | |/ _ \ | '_ \ / _ \ __|</span>
0073 <span class="comment">% | | | | | | (_) | | | (_| | (_| | | | | |_) | |_| |  __/_| | | |  __/ |_</span>
0074 <span class="comment">% |_| |_| |_|\___/|_|  \__, |\__,_|_| |_|_.__/ \__, |\___(_)_| |_|\___|\__|</span>
0075 <span class="comment">%                       __/ |                   __/ |</span>
0076 <span class="comment">%                      |___/                   |___/</span>
0077 <span class="comment">%</span>
0078 <span class="comment">%</span>
0079 <span class="comment">% M. Bye v13.04</span>
0080 <span class="comment">%</span>
0081 <span class="comment">% Author:       Morgan Bye</span>
0082 <span class="comment">% Work address: Henry Wellcome Unit for Biological EPR</span>
0083 <span class="comment">%               University of East Anglia</span>
0084 <span class="comment">%               NORWICH, UK</span>
0085 <span class="comment">% Email:        morgan.bye@uea.ac.uk</span>
0086 <span class="comment">% Website:      http://www.morganbye.net/eprtoolbox/cwviewer</span>
0087 <span class="comment">% Mar 2013;     Last revision: 21-March-2013</span>
0088 <span class="comment">%</span>
0089 <span class="comment">% Approximate coding time of file:</span>
0090 <span class="comment">%               21 hours</span>
0091 <span class="comment">%</span>
0092 <span class="comment">%</span>
0093 <span class="comment">% Version history:</span>
0094 <span class="comment">% Mar 13        &gt; Error message for folder loading an empty folder</span>
0095 <span class="comment">%               &gt; Web link adjusted to system background colour.</span>
0096 <span class="comment">%               &gt; Clicking on the web link opens system default browser to</span>
0097 <span class="comment">%                   the cwViewer homepage.</span>
0098 <span class="comment">%               &gt; Improved image export so that figures are no longer</span>
0099 <span class="comment">%                  cropped removing the top half of the spectra.</span>
0100 <span class="comment">%</span>
0101 <span class="comment">% Jan 13        Switches introduced for Windows users, as Windows using a</span>
0102 <span class="comment">%               different pixel position referencing system for</span>
0103 <span class="comment">%               window/figure placement. This caused some windows to be</span>
0104 <span class="comment">%               opened above the actual screen.</span>
0105 <span class="comment">%</span>
0106 <span class="comment">% Jul 12        &gt; Export of datasets to the MATLAB workspace not just to a</span>
0107 <span class="comment">%                   file. Useful for EasySpin. File &gt; Export &gt; to Workspace</span>
0108 <span class="comment">%</span>
0109 <span class="comment">% Jun 12        &gt; Savitzky-Golay smoothing implemented</span>
0110 <span class="comment">%               &gt; Update of export dataset to include g-values</span>
0111 <span class="comment">%               &gt; Adding of &quot;Noise&quot; to Data manipulation</span>
0112 <span class="comment">%               &gt; g-value x-axis scale now available in Viewing options</span>
0113 <span class="comment">%</span>
0114 <span class="comment">% May 12        Initial release (open beta)</span>
0115 <span class="comment">%</span>
0116 <span class="comment">% Feb 12        First alpha</span>
0117 
0118 <span class="comment">% Last Modified by GUIDE v2.5 22-Mar-2013 13:41:14</span>
0119 
0120 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0121 gui_Singleton = 1;
0122 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0123                    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0124                    <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)">cwViewer_OpeningFcn</a>, <span class="keyword">...</span>
0125                    <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = cwViewer_OutputFcn(hObject, eventdata, handles)">cwViewer_OutputFcn</a>, <span class="keyword">...</span>
0126                    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0127                    <span class="string">'gui_Callback'</span>,   []);
0128 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0129     gui_State.gui_Callback = str2func(varargin{1});
0130 <span class="keyword">end</span>
0131 
0132 <span class="keyword">if</span> nargout
0133     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0134 <span class="keyword">else</span>
0135     warning off all
0136     gui_mainfcn(gui_State, varargin{:});
0137     warning on all
0138 <span class="keyword">end</span>
0139 <span class="comment">% End initialization code - DO NOT EDIT</span>
0140 
0141 
0142 <span class="comment">% --- Executes just before viewer is made visible.</span>
0143 <a name="_sub1" href="#_subfunctions" class="code">function cwViewer_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0144 <span class="comment">% This function has no output args, see OutputFcn.</span>
0145 <span class="comment">% hObject    handle to figure</span>
0146 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0147 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0148 <span class="comment">% varargin   command line arguments to viewer (see VARARGIN)</span>
0149 
0150 <span class="comment">% Choose default command line output for viewer</span>
0151 handles.output = hObject;
0152 
0153 <span class="comment">% Update handles structure</span>
0154 guidata(hObject, handles);
0155 
0156 <span class="comment">% Name the window</span>
0157 set(gcf,<span class="string">'Name'</span>,<span class="string">'eprViewer - v13.04'</span>);
0158 
0159 <span class="comment">%Hand.cwViewer = handles;</span>
0160 
0161 <span class="comment">% Setup the global variables</span>
0162 setappdata(0, <span class="string">'cwview'</span>, gcf);
0163 
0164 cwview = getappdata(0, <span class="string">'cwview'</span>);
0165 
0166 <span class="comment">% Setup slider</span>
0167 Var.Slider.Min      = 1;
0168 Var.Slider.Max      = 1;
0169 Var.Slider.Value    = 1;
0170 Var.Slider.Visible  = <span class="string">'off'</span>;
0171 
0172 set(handles.slider , <span class="string">'Min'</span>    , Var.Slider.Min);
0173 set(handles.slider , <span class="string">'Max'</span>    , Var.Slider.Max);
0174 set(handles.slider , <span class="string">'Value'</span>  , Var.Slider.Value);
0175 set(handles.slider , <span class="string">'Visible'</span>, Var.Slider.Visible);
0176 
0177 <span class="comment">% Setup web link</span>
0178 set(handles.text_weblink  , <span class="string">'BackgroundColor'</span> , get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>));
0179 
0180 setappdata(cwview, <span class="string">'Var'</span> , Var);
0181 setappdata(cwview,<span class="string">'hcwView'</span>,handles);
0182 
0183 
0184 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0185 <a name="_sub2" href="#_subfunctions" class="code">function varargout = cwViewer_OutputFcn(hObject, eventdata, handles) </a>
0186 
0187 varargout{1} = handles.output;
0188 
0189 cwview = getappdata(0, <span class="string">'cwview'</span>);
0190 set(gcf, <span class="string">'Units'</span> , <span class="string">'pixels'</span>);
0191 
0192 viewer_size =  get(gcf,<span class="string">'OuterPosition'</span>);
0193 screen      =  get(0,<span class="string">'ScreenSize'</span>);
0194 
0195 <span class="comment">% Switch needed for Windows machines not conforming to normal standard</span>
0196 
0197 <span class="keyword">switch</span> computer
0198     <span class="keyword">case</span> <span class="string">'PCWIN'</span>
0199         set(cwview, <span class="string">'OuterPosition'</span>, [325, <span class="keyword">...</span>
0200             (screen(4) - viewer_size(4) - 5) , <span class="keyword">...</span>
0201             (viewer_size(3)),<span class="keyword">...</span>
0202             (viewer_size(4))]);       
0203     <span class="keyword">case</span> <span class="string">'PCWIN64'</span>
0204         set(cwview, <span class="string">'OuterPosition'</span>, [325, <span class="keyword">...</span>
0205             (screen(4) - viewer_size(4) - 5) , <span class="keyword">...</span>
0206             (viewer_size(3)),<span class="keyword">...</span>
0207             (viewer_size(4))]);
0208     <span class="keyword">otherwise</span>
0209         set(cwview, <span class="string">'OuterPosition'</span>, [325, <span class="keyword">...</span>
0210             (screen(4) - 5) , <span class="keyword">...</span>
0211             (viewer_size(3)),<span class="keyword">...</span>
0212             (viewer_size(4))]);
0213 <span class="keyword">end</span>
0214 
0215 setappdata(cwview,<span class="string">'screen'</span>,screen);
0216 setappdata(cwview,<span class="string">'size_viewer'</span>,viewer_size);
0217 setappdata(cwview,<span class="string">'logo'</span>, 1);
0218 setappdata(cwview,<span class="string">'data'</span>, <span class="string">''</span>);
0219 
0220 <a href="#_sub3" class="code" title="subfunction viewer_blank">viewer_blank</a>
0221 
0222 <span class="comment">% Call startup windows</span>
0223 <span class="comment">% ====================</span>
0224 
0225 <span class="comment">% Get handle of cwViewer and save it</span>
0226 Win = allchild(0);
0227 WindowHandles.cwViewer = Win(1);
0228 WindowVisible.cwViewer = 1;
0229 
0230 <span class="comment">% Open file details</span>
0231 wFile = <a href="ev_file_details.html" class="code" title="function varargout = ev_file_details(varargin)">ev_file_details</a>;
0232 Win = allchild(0);
0233 WindowHandles.FileDetails = Win(1);
0234 WindowVisible.FileDetails = 1;
0235 
0236 <span class="comment">% Open viewing options</span>
0237 wView = <a href="ev_viewing_options.html" class="code" title="function varargout = ev_viewing_options(varargin)">ev_viewing_options</a>;
0238 Win = allchild(0);
0239 WindowHandles.ViewingOptions = Win(1);
0240 WindowVisible.ViewingOptions = 1;
0241 
0242 <span class="comment">% Open data manipulation</span>
0243 wDataMan = <a href="ev_data_man.html" class="code" title="function varargout = ev_data_man(varargin)">ev_data_man</a>;
0244 Win = allchild(0);
0245 WindowHandles.DataMan = Win(1);
0246 WindowVisible.DataMan = 1;
0247 
0248 <span class="comment">% Write open windows to cwview</span>
0249 setappdata(cwview,<span class="string">'wFile'</span>  ,wFile);
0250 setappdata(cwview,<span class="string">'wView'</span>  ,wView);
0251 setappdata(cwview,<span class="string">'wMan'</span>   ,wDataMan );
0252 setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0253 setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0254 
0255 
0256 
0257 <a name="_sub3" href="#_subfunctions" class="code">function viewer_blank</a>
0258 
0259 cwview = getappdata(0, <span class="string">'cwview'</span>);
0260 
0261 <span class="keyword">if</span> getappdata(cwview,<span class="string">'logo'</span>) == 1;
0262     set(gcf,<span class="string">'Color'</span>,[0.702 0.702 0.702]);
0263 
0264     <span class="comment">% Insert logos</span>
0265     logo_mb = which(<span class="string">'mb_net.jpg'</span>);
0266     logo_mb = imread(logo_mb);
0267 
0268     image(logo_mb);
0269     axis off
0270     axis image
0271 <span class="keyword">end</span>
0272 
0273 
0274 <span class="comment">% --- If Enable == 'on', executes on mouse press in 5 pixel border.</span>
0275 <span class="comment">% --- Otherwise, executes on mouse press in 5 pixel border or over text_weblink.</span>
0276 <a name="_sub4" href="#_subfunctions" class="code">function text_weblink_ButtonDownFcn(hObject, eventdata, handles)</a>
0277 
0278 web(<span class="string">'http://morganbye.net/eprtoolbox/cwviewer'</span>,<span class="string">'-browser'</span>)
0279 
0280 
0281 <span class="comment">%  .d8888b.  888 d8b      888</span>
0282 <span class="comment">% d88P  Y88b 888 Y8P      888</span>
0283 <span class="comment">% Y88b.      888          888</span>
0284 <span class="comment">%  &quot;Y888b.   888 888  .d88888  .d88b.  888d888</span>
0285 <span class="comment">%     &quot;Y88b. 888 888 d88&quot; 888 d8P  Y8b 888P&quot;</span>
0286 <span class="comment">%       &quot;888 888 888 888  888 88888888 888</span>
0287 <span class="comment">% Y88b  d88P 888 888 Y88b 888 Y8b.     888</span>
0288 <span class="comment">%  &quot;Y8888P&quot;  888 888  &quot;Y88888  &quot;Y8888  888</span>
0289 <span class="comment">% ============================================</span>
0290 
0291 <span class="comment">% --- Executes on slider movement.</span>
0292 <a name="_sub5" href="#_subfunctions" class="code">function slider_Callback(hObject, eventdata, handles)</a>
0293 
0294 cwview = getappdata(0,<span class="string">'cwview'</span>);
0295 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0296 
0297 Var.Slider.Value = get(hObject,<span class="string">'Value'</span>);
0298 setappdata(cwview, <span class="string">'Var'</span> , Var);
0299 
0300 <a href="../../../EPRtoolbox/cw/cwViewer/cv_plot.html" class="code" title="function cv_plot(varargin)">cv_plot</a>;
0301 
0302 <span class="comment">% --- Executes during object creation, after setting all properties.</span>
0303 <a name="_sub6" href="#_subfunctions" class="code">function slider_CreateFcn(hObject, eventdata, handles)</a>
0304 <span class="comment">% hObject    handle to slider (see GCBO)</span>
0305 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0306 <span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>
0307 
0308 <span class="comment">% Hint: slider controls usually have a light gray background.</span>
0309 <span class="keyword">if</span> isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
0310     set(hObject,<span class="string">'BackgroundColor'</span>,[.9 .9 .9]);
0311 <span class="keyword">end</span>
0312 
0313 
0314 
0315 
0316 
0317 <span class="comment">%  .d8888b.  888                   d8b</span>
0318 <span class="comment">% d88P  Y88b 888                   Y8P</span>
0319 <span class="comment">% 888    888 888</span>
0320 <span class="comment">% 888        888  .d88b.  .d8888b  888 88888b.   .d88b.</span>
0321 <span class="comment">% 888        888 d88&quot;&quot;88b 88K      888 888 &quot;88b d88P&quot;88b</span>
0322 <span class="comment">% 888    888 888 888  888 &quot;Y8888b. 888 888  888 888  888</span>
0323 <span class="comment">% Y88b  d88P 888 Y88..88P      X88 888 888  888 Y88b 888</span>
0324 <span class="comment">%  &quot;Y8888P&quot;  888  &quot;Y88P&quot;   88888P' 888 888  888  &quot;Y88888</span>
0325 <span class="comment">%                                                    888</span>
0326 <span class="comment">%                                               Y8b d88P</span>
0327 <span class="comment">%                                                &quot;Y88P&quot;</span>
0328 <span class="comment">% ======================================================</span>
0329 
0330 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0331 <a name="_sub7" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0332 
0333 cwview = getappdata(0, <span class="string">'cwview'</span>);
0334 
0335 prompt = questdlg(<span class="string">'Are you sure you want to quit?'</span>,<span class="string">'Exit cwViewer'</span>,<span class="keyword">...</span>
0336         <span class="string">'Yes'</span>,<span class="string">'No'</span>,<span class="string">'Yes'</span>);
0337 
0338 <span class="keyword">switch</span> prompt
0339         <span class="keyword">case</span> <span class="string">'Yes'</span>
0340             
0341             Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0342             Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0343             
0344             <span class="keyword">if</span> isfield(Handles,<span class="string">'cwViewer'</span>) 
0345                 delete(Handles.cwViewer);
0346             <span class="keyword">end</span>
0347             
0348             <span class="keyword">if</span> isfield(Handles,<span class="string">'FileDetails'</span>) &amp;&amp; Visible.FileDetails == 1
0349                 delete(Handles.FileDetails);
0350             <span class="keyword">end</span>
0351             
0352             <span class="keyword">if</span> isfield(Handles,<span class="string">'ViewingOptions'</span>) &amp;&amp; Visible.ViewingOptions == 1
0353                 delete(Handles.ViewingOptions);
0354             <span class="keyword">end</span>
0355             
0356             <span class="keyword">if</span> isfield(Handles,<span class="string">'DataMan'</span>) &amp;&amp; Visible.ViewingOptions == 1
0357                 delete(Handles.DataMan);
0358             <span class="keyword">end</span>
0359                         
0360         <span class="keyword">case</span> <span class="string">'No'</span>
0361             
0362             <span class="keyword">return</span>
0363             
0364 <span class="keyword">end</span>
0365 
0366 <span class="comment">% =========================================================================</span>
0367 <span class="comment">% 888b     d888                                 888888b.</span>
0368 <span class="comment">% 8888b   d8888                                 888  &quot;88b</span>
0369 <span class="comment">% 88888b.d88888                                 888  .88P</span>
0370 <span class="comment">% 888Y88888P888  .d88b.  88888b.  888  888      8888888K.   8888b.  888d888</span>
0371 <span class="comment">% 888 Y888P 888 d8P  Y8b 888 &quot;88b 888  888      888  &quot;Y88b     &quot;88b 888P&quot;</span>
0372 <span class="comment">% 888  Y8P  888 88888888 888  888 888  888      888    888 .d888888 888</span>
0373 <span class="comment">% 888   &quot;   888 Y8b.     888  888 Y88b 888      888   d88P 888  888 888</span>
0374 <span class="comment">% 888       888  &quot;Y8888  888  888  &quot;Y88888      8888888P&quot;  &quot;Y888888 888</span>
0375 <span class="comment">% =========================================================================</span>
0376 
0377 <span class="comment">% ===================================================</span>
0378 <span class="comment">% File</span>
0379 <span class="comment">% ===================================================</span>
0380 
0381 <span class="comment">% --------------------------------------------------------------------</span>
0382 <a name="_sub8" href="#_subfunctions" class="code">function menu_File_Callback(hObject, eventdata, handles)</a>
0383 <span class="comment">% hObject    handle to menu_File (see GCBO)</span>
0384 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0385 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0386 
0387 
0388 <span class="comment">% --------------------------------------------------------------------</span>
0389 <a name="_sub9" href="#_subfunctions" class="code">function menu_File_Open_Callback(hObject, eventdata, handles)</a>
0390 <span class="comment">% hObject    handle to menu_File_Open (see GCBO)</span>
0391 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0392 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0393 
0394 cwview = getappdata(0,<span class="string">'cwview'</span>);
0395 data   = getappdata(cwview,<span class="string">'data'</span>);
0396 hFile  = getappdata(cwview,<span class="string">'hFile'</span>);
0397 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0398 
0399 <span class="comment">% GUI get file</span>
0400 [file , directory] = uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="string">'Load cwViewer file'</span>);
0401 address = [directory,file];
0402 
0403 <span class="comment">% Load variable</span>
0404 load(address , <span class="string">'data'</span> , <span class="string">'Var'</span>)
0405 
0406 <span class="comment">% Store variable into cwview</span>
0407 setappdata(cwview,<span class="string">'data'</span> ,data);
0408 setappdata(cwview,<span class="string">'Var'</span>  ,Var);
0409 
0410 fileNum =length(fieldnames(data));
0411 
0412 <span class="comment">% Update the display</span>
0413 info  = data.([<span class="string">'File'</span>  num2str(fileNum)]).info;
0414 
0415 <span class="comment">% Set File(s) list</span>
0416 set(hFile.listbox_files,<span class="string">'String'</span>, Var.files);
0417 <span class="comment">% Set File(s) list so that last entry is selected as active</span>
0418 set(hFile.listbox_files,<span class="string">'Value'</span>, fileNum);
0419 <span class="comment">% Other File details boxes</span>
0420 set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0421 set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0422 set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0423 
0424 <span class="comment">% Update the axes.</span>
0425 <a href="../../../EPRtoolbox/cw/eprViewer-BETA/_private/ev_plot.html" class="code" title="function ev_plot(varargin)">ev_plot</a>;
0426 
0427 <span class="comment">% 8888888                                         888</span>
0428 <span class="comment">%   888                                           888</span>
0429 <span class="comment">%   888                                           888</span>
0430 <span class="comment">%   888   88888b.d88b.  88888b.   .d88b.  888d888 888888</span>
0431 <span class="comment">%   888   888 &quot;888 &quot;88b 888 &quot;88b d88&quot;&quot;88b 888P&quot;   888</span>
0432 <span class="comment">%   888   888  888  888 888  888 888  888 888     888</span>
0433 <span class="comment">%   888   888  888  888 888 d88P Y88..88P 888     Y88b.</span>
0434 <span class="comment">% 8888888 888  888  888 88888P&quot;   &quot;Y88P&quot;  888      &quot;Y888</span>
0435 <span class="comment">% ===================== 888 ============================</span>
0436 <span class="comment">%                       888</span>
0437 <span class="comment">%                       888</span>
0438 
0439 <span class="comment">% --------------------------------------------------------------------</span>
0440 <a name="_sub10" href="#_subfunctions" class="code">function menu_File_Bruker_Callback(hObject, eventdata, handles)</a>
0441 <span class="comment">% hObject    handle to menu_File_Bruker (see GCBO)</span>
0442 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0443 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0444 
0445 cwview = getappdata(0,<span class="string">'cwview'</span>);
0446 data   = getappdata(cwview,<span class="string">'data'</span>);
0447 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0448 
0449 <span class="comment">% Set file number for file</span>
0450 <span class="keyword">try</span>
0451     fileNum = size(fieldnames(data),1) +1;
0452 <span class="keyword">catch</span>
0453     fileNum = 1;
0454 <span class="keyword">end</span>
0455 
0456 <span class="comment">% Load the file</span>
0457 [x , y , info] = <a href="../../../EPRtoolbox/misc/BrukerRead.html" class="code" title="function varargout = BrukerRead(varargin)">BrukerRead</a>;
0458 
0459 <span class="comment">% Move the file to data structure</span>
0460 data.([<span class="string">'File'</span> mat2str(fileNum)]).x = x;
0461 data.([<span class="string">'File'</span> mat2str(fileNum)]).y = y;
0462 data.([<span class="string">'File'</span> mat2str(fileNum)]).info = info;
0463 
0464 <span class="comment">% Update data</span>
0465 setappdata(cwview,<span class="string">'data'</span>,data);
0466 
0467 <span class="comment">% Update file details</span>
0468 hFile = getappdata(cwview,<span class="string">'hFile'</span>);
0469 
0470 <span class="comment">% Get string in File Details window listbox</span>
0471 files = get(hFile.listbox_files,<span class="string">'String'</span>);
0472 
0473 <span class="comment">% See if files have been listed previously</span>
0474 <span class="keyword">if</span> strcmp(files , <span class="string">'-- No file loaded --'</span>)
0475     files = [<span class="string">'1: '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0476     files = sscanf(files,<span class="string">'%c'</span>,30);      <span class="comment">% Cuts down to 25 characters</span>
0477     files = sprintf(<span class="string">'%-30s'</span>,files);     <span class="comment">% Makes up to 25 characters</span>
0478     
0479     <span class="comment">% Change focus of listbox to the new file</span>
0480     set(hFile.listbox_files,<span class="string">'Value'</span>, 1)
0481 
0482 <span class="comment">% If previous file then get string, add new string title to a new line</span>
0483 <span class="keyword">else</span>
0484     Num = mat2str(fileNum);
0485     next_line = [Num , <span class="string">': '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0486     next_formated = sscanf(next_line,<span class="string">'%c'</span>,30);
0487     next_formated = sprintf(<span class="string">'%-30s'</span>,next_formated);
0488     files = [files ; next_formated];
0489     
0490     <span class="comment">% Change focus of listbox to the new file</span>
0491     set(hFile.listbox_files,<span class="string">'Value'</span>, str2num(Num));
0492 
0493 <span class="keyword">end</span>
0494        
0495 <span class="comment">% Write out new string to File Details listbox</span>
0496 set(hFile.listbox_files,<span class="string">'String'</span>,files)
0497 Var.files = files;
0498 setappdata(cwview,<span class="string">'Var'</span>,Var);
0499 
0500 <span class="comment">% Set other details in the File Details window</span>
0501 set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0502 set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0503 set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0504 
0505 <span class="comment">% Test to see if it is a 3D experiment &amp; adjust slider variables if needed</span>
0506 c = size(y,2);
0507 
0508 <span class="keyword">switch</span> c
0509     <span class="keyword">case</span> 1
0510         Var.Slider.Min      = 1;
0511         Var.Slider.Max      = 2;
0512         Var.Slider.Value    = 1;
0513         Var.Slider.Visible  = <span class="string">'off'</span>;
0514     
0515         setappdata(cwview, <span class="string">'Var'</span> , Var);
0516         
0517     <span class="keyword">otherwise</span>
0518         Var.Slider.Min      = 1;
0519         Var.Slider.Max      = c;
0520         Var.Slider.Value    = 1;
0521         Var.Slider.Visible  = <span class="string">'off'</span>;
0522         
0523         setappdata(cwview, <span class="string">'Var'</span> , Var);
0524         
0525         set(handles.slider , <span class="string">'Min'</span>    , Var.Slider.Min);
0526         set(handles.slider , <span class="string">'Max'</span>    , Var.Slider.Max);
0527         set(handles.slider , <span class="string">'Value'</span>  , Var.Slider.Value);
0528         set(handles.slider , <span class="string">'Visible'</span>, Var.Slider.Visible);
0529         
0530         setappdata(cwview,<span class="string">'hcwView'</span>,handles);
0531 <span class="keyword">end</span>
0532 
0533 <span class="comment">% Plot the new graph</span>
0534 <a href="../../../EPRtoolbox/cw/eprViewer-BETA/_private/ev_plot.html" class="code" title="function ev_plot(varargin)">ev_plot</a>;
0535 
0536 
0537 <span class="comment">% --------------------------------------------------------------------</span>
0538 <a name="_sub11" href="#_subfunctions" class="code">function menu_File_Bruker_folder_Callback(hObject, eventdata, handles)</a>
0539 <span class="comment">% hObject    handle to menu_File_Bruker_folder (see GCBO)</span>
0540 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0541 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0542 
0543 cwview = getappdata(0,<span class="string">'cwview'</span>);
0544 data   = getappdata(cwview,<span class="string">'data'</span>);
0545 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0546 
0547 <span class="comment">% Find all the spectra</span>
0548 folder = uigetdir;
0549 dtaFiles = dir([folder <span class="string">'/*.DTA'</span>]);
0550 
0551 <span class="comment">% Puts all x data into a x array (each column next experiment, ie 1024x16)</span>
0552 
0553 <span class="keyword">if</span> numel(dtaFiles) ~= 0
0554     <span class="keyword">for</span> k=1:numel(dtaFiles)
0555                 
0556         <span class="comment">% Set file number for file</span>
0557         <span class="keyword">try</span>
0558             fileNum = size(fieldnames(data),1) +1;
0559         <span class="keyword">catch</span>
0560             fileNum = 1;
0561         <span class="keyword">end</span>
0562         
0563         <span class="comment">% Load the file</span>
0564         [x , y , info] = <a href="../../../EPRtoolbox/misc/BrukerRead.html" class="code" title="function varargout = BrukerRead(varargin)">BrukerRead</a>([folder <span class="string">'/'</span> dtaFiles(k).name]);
0565         
0566         <span class="comment">% Move the file to data structure</span>
0567         data.([<span class="string">'File'</span> mat2str(fileNum)]).x = x;
0568         data.([<span class="string">'File'</span> mat2str(fileNum)]).y = y;
0569         data.([<span class="string">'File'</span> mat2str(fileNum)]).info = info;
0570         
0571         <span class="comment">% Update data</span>
0572         setappdata(cwview,<span class="string">'data'</span>,data);
0573         
0574         <span class="comment">% Get string in File Details window listbox</span>
0575         hFile = getappdata(cwview,<span class="string">'hFile'</span>);
0576         files = get(hFile.listbox_files,<span class="string">'String'</span>);
0577         
0578         <span class="comment">% See if files have been listed previously</span>
0579         <span class="keyword">if</span> strcmp(files , <span class="string">'-- No file loaded --'</span>)
0580             files = [<span class="string">'1: '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0581             files = sscanf(files,<span class="string">'%c'</span>,30);      <span class="comment">% Cuts down to 25 characters</span>
0582             files = sprintf(<span class="string">'%-30s'</span>,files);     <span class="comment">% Makes up to 25 characters</span>
0583             
0584             <span class="comment">% Write out new string to File Details listbox</span>
0585             set(hFile.listbox_files,<span class="string">'String'</span>,files)
0586             
0587             <span class="comment">% If previous file then get string, add new string title to a new line</span>
0588         <span class="keyword">else</span>
0589             Num = mat2str(fileNum);
0590             next_line = [Num , <span class="string">': '</span> , regexprep(info.TITL , <span class="string">''''</span>,<span class="string">''</span>)];
0591             next_formated = sscanf(next_line,<span class="string">'%c'</span>,30);
0592             next_formated = sprintf(<span class="string">'%-30s'</span>,next_formated);
0593             files = [files ; next_formated];
0594             
0595             <span class="comment">% Write out new string to File Details listbox</span>
0596             set(hFile.listbox_files,<span class="string">'String'</span>,files)
0597             
0598         <span class="keyword">end</span>
0599     <span class="keyword">end</span>
0600     
0601     Var.files = files;
0602     setappdata(cwview,<span class="string">'Var'</span>,Var);
0603     
0604     <span class="comment">% Change focus of listbox to the new file</span>
0605     set(hFile.listbox_files,<span class="string">'Value'</span>, size(get(hFile.listbox_files,<span class="string">'String'</span>),1));
0606     
0607     <span class="comment">% Set other details in the File Details window</span>
0608     set(hFile.edit_freq,    <span class="string">'String'</span>, num2str(info.MWFQ/1e9));
0609     set(hFile.edit_scans,   <span class="string">'String'</span>, num2str(info.AVGS));
0610     set(hFile.edit_mw,      <span class="string">'String'</span>, num2str(info.MWPW*1e3));
0611     
0612     
0613     
0614     <span class="comment">% Save variables to main workspace</span>
0615     setappdata(cwview,<span class="string">'hFile'</span>,hFile);
0616     
0617     <a href="../../../EPRtoolbox/cw/eprViewer-BETA/_private/ev_plot.html" class="code" title="function ev_plot(varargin)">ev_plot</a>;
0618     
0619 <span class="keyword">else</span>
0620     warndlg(<span class="string">'No files could be found in that folder'</span>,<span class="string">'Load folder error'</span>);
0621 <span class="keyword">end</span>
0622 
0623 
0624 
0625 <span class="comment">% --------------------------------------------------------------------</span>
0626 <a name="_sub12" href="#_subfunctions" class="code">function menu_File_Jeol_Callback(hObject, eventdata, handles)</a>
0627 <span class="comment">% hObject    handle to menu_File_Jeol (see GCBO)</span>
0628 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0629 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0630 
0631 warndlg(<span class="string">'Unfortunately this feature has not yet been implemented, but will be included in the next version release'</span>,<span class="string">'Placeholder'</span>);
0632 
0633 
0634 <span class="comment">% --------------------------------------------------------------------</span>
0635 <a name="_sub13" href="#_subfunctions" class="code">function menu_File_Fsc2_Callback(hObject, eventdata, handles)</a>
0636 <span class="comment">% hObject    handle to menu_File_Fsc2 (see GCBO)</span>
0637 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0638 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0639 
0640 warndlg(<span class="string">'Unfortunately this feature has not yet been implemented, but will be included in the next version release'</span>,<span class="string">'Placeholder'</span>);
0641 
0642 
0643 <span class="comment">% --------------------------------------------------------------------</span>
0644 <a name="_sub14" href="#_subfunctions" class="code">function menu_File_Save_Callback(hObject, eventdata, handles)</a>
0645 <span class="comment">% hObject    handle to menu_File_Save (see GCBO)</span>
0646 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0647 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0648 
0649 cwview = getappdata(0,<span class="string">'cwview'</span>);
0650 data   = getappdata(cwview,<span class="string">'data'</span>);
0651 Var    = getappdata(cwview,<span class="string">'Var'</span>);
0652 
0653 [file, pathname] = uiputfile({ <span class="string">'*.mat'</span>,<span class="string">'MATLAB structure (*.mat)'</span>},<span class="keyword">...</span><span class="comment"> </span>
0654         <span class="string">'Save file as'</span>,<span class="string">'default'</span>);
0655     
0656 address = [pathname file];
0657 
0658 save(address,<span class="string">'data'</span>,<span class="string">'Var'</span>);
0659 
0660 <span class="comment">% 8888888888                                    888</span>
0661 <span class="comment">% 888                                           888</span>
0662 <span class="comment">% 888                                           888</span>
0663 <span class="comment">% 8888888    888  888 88888b.   .d88b.  888d888 888888</span>
0664 <span class="comment">% 888        `Y8bd8P' 888 &quot;88b d88&quot;&quot;88b 888P&quot;   888</span>
0665 <span class="comment">% 888          X88K   888  888 888  888 888     888</span>
0666 <span class="comment">% 888        .d8&quot;&quot;8b. 888 d88P Y88..88P 888     Y88b.</span>
0667 <span class="comment">% 8888888888 888  888 88888P&quot;   &quot;Y88P&quot;  888      &quot;Y888</span>
0668 <span class="comment">% =================== 888 ============================</span>
0669 <span class="comment">%                     888</span>
0670 <span class="comment">%                     888</span>
0671 
0672 <span class="comment">% --------------------------------------------------------------------</span>
0673 <a name="_sub15" href="#_subfunctions" class="code">function menu_File_Export_Callback(hObject, eventdata, handles)</a>
0674 <span class="comment">% hObject    handle to menu_File_Export (see GCBO)</span>
0675 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0676 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0677 
0678 <span class="comment">% --------------------------------------------------------------------</span>
0679 <a name="_sub16" href="#_subfunctions" class="code">function menu_File_Export_Dataset_Callback(hObject, eventdata, handles)</a>
0680 <span class="comment">% hObject    handle to menu_File_Export_Dataset (see GCBO)</span>
0681 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0682 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0683 
0684 [out_name, out_path] = uiputfile( <span class="keyword">...</span>
0685     {<span class="string">'*.csv'</span>,<span class="string">'Comma Seperated Value (*.csv)'</span>;
0686     <span class="string">'*.DTA'</span> ,<span class="string">'Bruker BES3T (*.DTA/*.DSC)'</span>;<span class="keyword">...</span>
0687     <span class="string">'*.*'</span>,  <span class="string">'All Files (*.*)'</span>},<span class="keyword">...</span>
0688     <span class="string">'Save output as...'</span>);
0689 
0690 <span class="comment">% If user cancels then no error message is returned to command window</span>
0691 <span class="keyword">if</span> isequal(out_name,0)
0692     <span class="keyword">return</span>
0693 <span class="keyword">end</span>
0694 
0695 <span class="comment">% Merge file parts into a proper address</span>
0696 out_add = fullfile(out_path,out_name);
0697 
0698 <span class="comment">% Load variables necessary to write out data</span>
0699 cwview = getappdata(0,<span class="string">'cwview'</span>);
0700 data    = getappdata(cwview,<span class="string">'data'</span>);
0701 hFile   = getappdata(cwview,<span class="string">'hFile'</span>);
0702 
0703 <span class="comment">% Find which file is currently selected and query it</span>
0704 <span class="keyword">try</span>
0705     fSelection  = get(hFile.listbox_files,<span class="string">'Value'</span>);
0706 <span class="keyword">catch</span>
0707     errordlg(<span class="string">'No file has been selected in the File Details window'</span>,<span class="string">'Export...'</span>);
0708 <span class="keyword">end</span>
0709 
0710 exp         = data.([<span class="string">'File'</span> mat2str(fSelection)]);
0711 size_x      = size(exp.x,2);
0712 size_y      = size(exp.y,2);
0713 mwFreq      = exp.info.MWFQ;
0714 
0715 <span class="comment">% Create file and then create the header lines</span>
0716 file = fopen(out_add,<span class="string">'w'</span>);
0717 
0718 header = [<span class="keyword">...</span>
0719 <span class="string">'#                             __     ___                                   '</span>;<span class="keyword">...</span>
0720 <span class="string">'#                _____      __\ \   / (_) _____      _____ _ ___           '</span>;<span class="keyword">...</span>
0721 <span class="string">'#               / __\ \ /\ / / \ \ / /| |/ _ \ \ /\ / / _ \ ''__|           '</span>;<span class="keyword">...</span>
0722 <span class="string">'#              | (__ \ V  V /   \ V / | |  __/\ V  V /  __/ |              '</span>;<span class="keyword">...</span>
0723 <span class="string">'#               \___| \_/\_/     \_/  |_|\___| \_/\_/ \___|_|              '</span>;<span class="keyword">...</span>
0724 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0725 <span class="string">'#  Part of the EPR toolbox:                           developed at         '</span>;<span class="keyword">...</span>
0726 <span class="string">'#  morganbye.net/eprtoolbox                    University of East Anglia   '</span>;<span class="keyword">...</span>
0727 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0728 <span class="string">'# This file has been created by eprViewer - v13.04 at:                     '</span>];
0729 
0730 header = [header ; sprintf(<span class="string">'%-75s'</span>, [<span class="string">'# '</span> datestr(now, <span class="string">'dd mmmm yyyy - HH:MM'</span>)])];
0731 
0732 
0733 <span class="comment">% Get the selected extension so that the switch can be invoked</span>
0734 [~,~,ext] = fileparts(out_add);
0735 
0736 <span class="keyword">switch</span> ext
0737     <span class="keyword">case</span> <span class="string">'.csv'</span>
0738         
0739         <span class="comment">% Single X, Single Y</span>
0740         <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0741             
0742             header = [header ; [<span class="keyword">...</span>
0743                 <span class="string">'#                                                                          '</span>;<span class="keyword">...</span>
0744                 <span class="string">'# This file contains 3 columns: Magnetic field, g-value and intensity      '</span>;<span class="keyword">...</span>
0745                 <span class="string">'#                                                                          '</span>]];
0746             
0747             <span class="comment">% Print header</span>
0748             <span class="keyword">for</span> k = 1:size(header,1)
0749                 fprintf(file,<span class="string">'%-75s\n'</span>,header(k,:));
0750             <span class="keyword">end</span>
0751             
0752             <span class="comment">% Calculate g</span>
0753             <span class="keyword">for</span> k = 1:numel(exp.x)
0754                 g(k,:) = ((6.626068e-34 * mwFreq) / (9.27e-24 * (exp.x(k) /10000) ));
0755             <span class="keyword">end</span>
0756             
0757             <span class="comment">% Write out data</span>
0758             out = [exp.x_view g exp.y_view];
0759             dlmwrite(out_add, out, <span class="string">'-append'</span>,<span class="string">'delimiter'</span>, <span class="string">','</span>,<span class="string">'precision'</span>, <span class="string">'%.13f'</span>);
0760             
0761             <span class="comment">% Close file and free memory</span>
0762             fclose(file);
0763         
0764         <span class="comment">% Many X, Single Y</span>
0765         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y == 1
0766             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0767             
0768         <span class="comment">% Single X, Many Y</span>
0769         <span class="keyword">elseif</span> size_x == 1 &amp;&amp; size_y ~= 1
0770             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0771 
0772                 
0773         <span class="comment">% Many X, Many Y</span>
0774         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y ~= 1
0775             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0776             
0777         <span class="keyword">end</span>
0778         
0779     <span class="keyword">case</span> <span class="string">'.DTA'</span>
0780         
0781         <span class="comment">% Check that we have the function to write out in Bruker format</span>
0782         <span class="keyword">if</span> exist(<span class="string">'BrukerWrite'</span>,<span class="string">'file'</span>) ~=2
0783             errordlg(sprintf(<span class="string">'To save files in the Bruker file format requires the script BrukerWrite.m be on the active path.\n\nIt is available freely as part of the EPR Toolbox at morganbye.net/eprtoolbox'</span>),<span class="string">'Export...Bruker Format'</span>);
0784         <span class="keyword">end</span>
0785         
0786         <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0787             <a href="../../../EPRtoolbox/misc/BrukerWrite.html" class="code" title="function BrukerWrite(varargin)">BrukerWrite</a>(exp.x_view,exp.y_view,out_add);
0788         
0789         <span class="comment">% Many X, Single Y</span>
0790         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y == 1
0791             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0792             
0793         <span class="comment">% Single X, Many Y</span>
0794         <span class="keyword">elseif</span> size_x == 1 &amp;&amp; size_y ~= 1
0795             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0796                 
0797         <span class="comment">% Many X, Many Y</span>
0798         <span class="keyword">elseif</span> size_x ~= 1 &amp;&amp; size_y ~= 1
0799             errordlg(<span class="string">'Sorry, but the export feature for multi-dimension datasets is yet to be written. Please check for a new version of cwViewer'</span>)
0800             
0801         <span class="keyword">end</span>
0802         
0803     <span class="keyword">otherwise</span>
0804         <span class="keyword">try</span>
0805             <span class="keyword">if</span> size_x == 1 &amp;&amp; size_y == 1
0806                 out = [exp.x exp.y];
0807                 dlmwrite(out_add, out, <span class="string">'delimiter'</span>, <span class="string">','</span>,<span class="string">'precision'</span>, <span class="string">'%.13f'</span>);
0808             <span class="keyword">end</span>
0809         <span class="keyword">catch</span>
0810             errordlg(<span class="string">'You''re selected file format could not be recognized'</span>,<span class="string">'Export...'</span>);
0811         <span class="keyword">end</span>
0812         
0813 <span class="keyword">end</span>
0814 
0815 
0816 <span class="comment">% --------------------------------------------------------------------</span>
0817 <a name="_sub17" href="#_subfunctions" class="code">function menu_File_Export_toWorkspace_Callback(hObject, eventdata, handles)</a>
0818 <span class="comment">% hObject    handle to menu_File_Export_toWorkspace (see GCBO)</span>
0819 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0820 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0821 
0822 <span class="comment">% Load variables necessary to write out data</span>
0823 cwview  = getappdata(0,<span class="string">'cwview'</span>);
0824 data    = getappdata(cwview,<span class="string">'data'</span>);
0825 hFile   = getappdata(cwview,<span class="string">'hFile'</span>);
0826 hView   = getappdata(cwview,<span class="string">'hView'</span>);
0827 
0828 <span class="comment">% Find which file is currently selected and query it</span>
0829 <span class="keyword">try</span>
0830     fSelection  = get(hFile.listbox_files,<span class="string">'Value'</span>);
0831 <span class="keyword">catch</span>
0832     errordlg(<span class="string">'No file has been selected in the File Details window'</span>,<span class="string">'Export...'</span>);
0833 <span class="keyword">end</span>
0834 
0835 exp = data.([<span class="string">'File'</span> mat2str(fSelection)]);
0836 
0837 <span class="comment">% Prompt user for variables names</span>
0838 prompt  = {<span class="string">'Enter variable name for x-axis:'</span>, <span class="string">'Enter variable name for y-axis:'</span>};
0839 title   = <span class="string">'Export dataset to MATLAB Workspace - eprViewer v13.04'</span>;
0840 lines   = 1;
0841 default = {<span class="string">'x'</span>, <span class="string">'y'</span>};
0842 answer  = inputdlg(prompt, title, lines, default);
0843 
0844 <span class="comment">% Write variables to base workspace</span>
0845 assignin(<span class="string">'base'</span>, answer{1} , exp.x_view);
0846 assignin(<span class="string">'base'</span>, answer{2} , exp.y_view);
0847         
0848 
0849 
0850 <span class="comment">% --------------------------------------------------------------------</span>
0851 <a name="_sub18" href="#_subfunctions" class="code">function menu_File_Export_Image_Callback(hObject, eventdata, handles)</a>
0852 <span class="comment">% hObject    handle to menu_File_Export_Image (see GCBO)</span>
0853 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0854 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0855 
0856 cwview = getappdata(0,<span class="string">'cwview'</span>);
0857 hcwView = getappdata(cwview,<span class="string">'hcwView'</span>);
0858 
0859 <span class="comment">% stores savepath for the phase plot</span>
0860 [filename, pathname] = uiputfile({ <span class="string">'*.eps'</span>,<span class="string">'Encapsulated Postscript (*.eps)'</span>;<span class="keyword">...</span>
0861         <span class="string">'*.png'</span>,<span class="string">'Portable Network Graphic (*.png)'</span>;<span class="keyword">...</span>
0862         <span class="string">'*.bmp'</span>,<span class="string">'Bitmap (*.bmp)'</span>; <span class="string">'*.fig'</span>,<span class="string">'Figure (*.fig)'</span>}, <span class="keyword">...</span><span class="comment"> </span>
0863         <span class="string">'Save picture as'</span>,<span class="string">'default'</span>);
0864 
0865 <span class="comment">% if user cancels save command, nothing happens</span>
0866 <span class="keyword">if</span> isequal(filename,0) || isequal(pathname,0)
0867     <span class="keyword">return</span>
0868 <span class="keyword">end</span>
0869 <span class="comment">% create a new figure</span>
0870 newFig = figure;
0871 
0872 <span class="comment">% get the units and position of the axes object</span>
0873 axes_units = get(hcwView.viewer_axes,<span class="string">'Units'</span>);
0874 axes_pos   = get(hcwView.viewer_axes,<span class="string">'Position'</span>);
0875 
0876 <span class="comment">% copies axesObject onto new figure</span>
0877 axesObject = copyobj(hcwView.viewer_axes,newFig);
0878 
0879 <span class="comment">% realign the axes object on the new figure</span>
0880 set(axesObject,<span class="string">'Units'</span>,axes_units);
0881 set(axesObject,<span class="string">'Position'</span>,[15 5 axes_pos(3) axes_pos(4)]);
0882 
0883 <span class="comment">% adjusts the new figure accordingly</span>
0884 set(newFig,<span class="string">'Units'</span>,axes_units);
0885 set(newFig,<span class="string">'Position'</span>,[15 5 axes_pos(3)+30 axes_pos(4)+10]);
0886 
0887 <span class="comment">% adjust the &quot;paper&quot; positioning to avoid Matlab cropping the top of the</span>
0888 <span class="comment">% figure off</span>
0889 set(newFig,<span class="string">'PaperPositionMode'</span>,<span class="string">'auto'</span>);
0890 
0891 <span class="comment">% saves the plot</span>
0892 saveas(newFig,[pathname filename]) 
0893 
0894 <span class="comment">% closes the figure</span>
0895 close(newFig)
0896 
0897 <span class="comment">% --------------------------------------------------------------------</span>
0898 <a name="_sub19" href="#_subfunctions" class="code">function menu_File_Exit_Callback(hObject, eventdata, handles)</a>
0899 <span class="comment">% hObject    handle to menu_File_Exit (see GCBO)</span>
0900 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0901 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0902 
0903 <a href="#_sub7" class="code" title="subfunction figure1_CloseRequestFcn(hObject, eventdata, handles)">figure1_CloseRequestFcn</a>
0904 
0905 
0906 <span class="comment">% 888       888 d8b               888</span>
0907 <span class="comment">% 888   o   888 Y8P               888</span>
0908 <span class="comment">% 888  d8b  888                   888</span>
0909 <span class="comment">% 888 d888b 888 888 88888b.   .d88888  .d88b.  888  888  888 .d8888b</span>
0910 <span class="comment">% 888d88888b888 888 888 &quot;88b d88&quot; 888 d88&quot;&quot;88b 888  888  888 88K</span>
0911 <span class="comment">% 88888P Y88888 888 888  888 888  888 888  888 888  888  888 &quot;Y8888b.</span>
0912 <span class="comment">% 8888P   Y8888 888 888  888 Y88b 888 Y88..88P Y88b 888 d88P      X88</span>
0913 <span class="comment">% 888P     Y888 888 888  888  &quot;Y88888  &quot;Y88P&quot;   &quot;Y8888888P&quot;   88888P'</span>
0914 
0915 <span class="comment">% --------------------------------------------------------------------</span>
0916 <a name="_sub20" href="#_subfunctions" class="code">function menu_Window_Callback(hObject, eventdata, handles)</a>
0917 <span class="comment">% hObject    handle to menu_Window (see GCBO)</span>
0918 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0919 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0920 
0921 <span class="comment">% --------------------------------------------------------------------</span>
0922 <a name="_sub21" href="#_subfunctions" class="code">function menu_Window_File_Callback(hObject, eventdata, handles)</a>
0923 <span class="comment">% hObject    handle to menu_Window_File (see GCBO)</span>
0924 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0925 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0926 
0927 
0928 cwview = getappdata(0,<span class="string">'cwview'</span>);
0929 
0930 h = getappdata(cwview,<span class="string">'handles'</span>);
0931 
0932 <span class="comment">% Get state of menu</span>
0933 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span>)
0934     
0935     <span class="comment">% If window is not open, open it</span>
0936     <span class="keyword">case</span> <span class="string">'off'</span>
0937         
0938         wFile = <a href="../../../EPRtoolbox/cw/cwViewer/file_details.html" class="code" title="function varargout = file_details(varargin)">file_details</a>;
0939         Win = allchild(0);
0940         WindowHandles.FileDetails = Win(1);
0941         WindowVisible.FileDetails = 1;
0942         
0943         setappdata(cwview,<span class="string">'wFile'</span>  ,wFile);
0944         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0945         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0946         
0947         set(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
0948         
0949     <span class="comment">% If window is open, close it</span>
0950     <span class="keyword">case</span> <span class="string">'on'</span>
0951         <span class="comment">% Close winow</span>
0952         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0953         delete(Handles.FileDetails);
0954         
0955         <span class="comment">% Change visibility status</span>
0956         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
0957         Visible.ViewingOptions = 0;
0958         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
0959         
0960         <span class="comment">% Change menu status</span>
0961         h = getappdata(cwview,<span class="string">'handles'</span>);
0962         set(h.cwViewer.menu_Window_File, <span class="string">'Checked'</span> , <span class="string">'off'</span>);             
0963 <span class="keyword">end</span>
0964 
0965 
0966 <span class="comment">% --------------------------------------------------------------------</span>
0967 <a name="_sub22" href="#_subfunctions" class="code">function menu_Window_View_Callback(hObject, eventdata, handles)</a>
0968 <span class="comment">% hObject    handle to menu_Window_View (see GCBO)</span>
0969 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0970 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0971 
0972 cwview = getappdata(0,<span class="string">'cwview'</span>);
0973 
0974 h = getappdata(cwview,<span class="string">'handles'</span>);
0975 
0976 <span class="comment">% Get state of menu</span>
0977 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span>)
0978     
0979     <span class="comment">% If window is not open, open it</span>
0980     <span class="keyword">case</span> <span class="string">'off'</span>
0981         
0982         wView = <a href="../../../EPRtoolbox/cw/cwViewer/viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>;
0983         Win = allchild(0);
0984         WindowHandles.ViewingOptions = Win(1);
0985         WindowVisible.ViewingOptions = 1;
0986         
0987         setappdata(cwview,<span class="string">'wView'</span>  ,wView);
0988         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
0989         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
0990         
0991         set(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
0992         
0993     <span class="comment">% If window is open, close it</span>
0994     <span class="keyword">case</span> <span class="string">'on'</span>
0995         <span class="comment">% Close winow</span>
0996         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
0997         delete(Handles.ViewingOptions);
0998         
0999         <span class="comment">% Change visibility status</span>
1000         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
1001         Visible.ViewingOptions = 0;
1002         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
1003         
1004         <span class="comment">% Change menu status</span>
1005         h = getappdata(cwview,<span class="string">'handles'</span>);
1006         set(h.cwViewer.menu_Window_View, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
1007               
1008 <span class="keyword">end</span>
1009 
1010 
1011 <span class="comment">% --------------------------------------------------------------------</span>
1012 <a name="_sub23" href="#_subfunctions" class="code">function menu_Window_DataMan_Callback(hObject, eventdata, handles)</a>
1013 <span class="comment">% hObject    handle to menu_Window_DataMan (see GCBO)</span>
1014 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1015 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1016 
1017 cwview = getappdata(0,<span class="string">'cwview'</span>);
1018 
1019 h = getappdata(cwview,<span class="string">'handles'</span>);
1020 
1021 <span class="comment">% Get state of menu</span>
1022 <span class="keyword">switch</span> get(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span>)
1023     
1024     <span class="comment">% If window is not open, open it</span>
1025     <span class="keyword">case</span> <span class="string">'off'</span>
1026         
1027         wView = <a href="../../../EPRtoolbox/cw/cwViewer/viewing_options.html" class="code" title="function varargout = viewing_options(varargin)">viewing_options</a>;
1028         Win = allchild(0);
1029         WindowHandles.DataMan = Win(1);
1030         WindowVisible.DataMan = 1;
1031         
1032         setappdata(cwview,<span class="string">'wMan'</span>  ,wDataMan);
1033         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
1034         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
1035         
1036         set(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
1037         
1038     <span class="comment">% If window is open, close it</span>
1039     <span class="keyword">case</span> <span class="string">'on'</span>
1040         <span class="comment">% Close winow</span>
1041         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
1042         delete(Handles.DataMan);
1043         
1044         <span class="comment">% Change visibility status</span>
1045         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
1046         Visible.DataMan = 0;
1047         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
1048         
1049         <span class="comment">% Change menu status</span>
1050         h = getappdata(cwview,<span class="string">'handles'</span>);
1051         set(h.cwViewer.menu_Window_DataMan, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
1052               
1053 <span class="keyword">end</span>
1054 
1055 <span class="comment">% --------------------------------------------------------------------</span>
1056 <a name="_sub24" href="#_subfunctions" class="code">function menu_Window_EasyFitting_Callback(hObject, eventdata, handles)</a>
1057 <span class="comment">% hObject    handle to menu_Window_EasyFitting (see GCBO)</span>
1058 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1059 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1060 
1061 cwview = getappdata(0,<span class="string">'cwview'</span>);
1062 
1063 h = getappdata(cwview,<span class="string">'handles'</span>);
1064 
1065 <span class="comment">% Get state of menu</span>
1066 <span class="keyword">switch</span> get(handles.menu_Window_EasyFitting, <span class="string">'Checked'</span>)
1067     
1068     <span class="comment">% If window is not open, open it</span>
1069     <span class="keyword">case</span> <span class="string">'off'</span>
1070         
1071         wEzF = <a href="../../../EPRtoolbox/cw/cwViewer/easyfitting.html" class="code" title="function varargout = easyfitting(varargin)">easyfitting</a>;
1072         Win = allchild(0);
1073         WindowHandles.EasyFitting = Win(1);
1074         WindowVisible.EasyFitting = 1;
1075         
1076         setappdata(cwview,<span class="string">'wEzF'</span>  ,wEzF);
1077         setappdata(cwview,<span class="string">'WindowHandles'</span>,WindowHandles);
1078         setappdata(cwview,<span class="string">'WindowVisible'</span>,WindowVisible);
1079         
1080         set(handles.menu_Window_EasyFitting, <span class="string">'Checked'</span> , <span class="string">'on'</span>);
1081         
1082     <span class="comment">% If window is open, close it</span>
1083     <span class="keyword">case</span> <span class="string">'on'</span>
1084         <span class="comment">% Close winow</span>
1085         Handles = getappdata(cwview,<span class="string">'WindowHandles'</span>);
1086         delete(Handles.EasyFitting);
1087         
1088         <span class="comment">% Change visibility status</span>
1089         Visible = getappdata(cwview,<span class="string">'WindowVisible'</span>);
1090         Visible.EasyFitting = 0;
1091         setappdata(cwview,<span class="string">'WindowVisible'</span>,Visible);
1092         
1093         <span class="comment">% Change menu status</span>
1094         h = getappdata(cwview,<span class="string">'handles'</span>);
1095         set(h.cwViewer.menu_Window_EasyFitting, <span class="string">'Checked'</span> , <span class="string">'off'</span>);
1096               
1097 <span class="keyword">end</span>
1098 
1099 
1100 <span class="comment">% --------------------------------------------------------------------</span>
1101 <a name="_sub25" href="#_subfunctions" class="code">function menu_help_Callback(hObject, eventdata, handles)</a>
1102 <span class="comment">% hObject    handle to menu_help (see GCBO)</span>
1103 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1104 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1105 
1106 
1107 <span class="comment">% --------------------------------------------------------------------</span>
1108 <a name="_sub26" href="#_subfunctions" class="code">function menu_help_about_Callback(hObject, eventdata, handles)</a>
1109 <span class="comment">% hObject    handle to menu_help_about (see GCBO)</span>
1110 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
1111 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
1112 
1113 l1 = sprintf(<span class="string">'cwViewer is part of the EPR Toolbox and has been developed by Morgan Bye as a side project whilst at the University of East Anglia. It is constantly in development and as such should be considered beta software\n\nThis software is distributed under a Creative Commons, non-commerical, share a-like license.\n\nPlease report any bugs, errors or requests to morgan.bye@uea.ac.uk\n\nMore information can be found at morganbye.net/eprtoolbox\n\nLatest releases can also be found at sourceforge.net/projects/eprtoolbox\n\nLinks have been placed in the Command Window for your convenience\n\n'</span>);
1114 
1115 Links = sprintf(<span class="string">'\n&lt;a href=&quot;http://morganbye.net/eprtoolbox&quot;&gt;morganbye.net/eprtoolbox&lt;/a&gt;\n&lt;a href=&quot;http://sourceforge.net/projects/eprtoolbox&quot;&gt;sourceforge.net/projects/eprtoolbox&lt;/a&gt;\n\n'</span>)
1116 
1117 msgbox(l1,<span class="string">'eprViewer - v13.04'</span>);</pre></div>
<hr><address>Generated on Sun 07-Sep-2014 15:11:40 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>